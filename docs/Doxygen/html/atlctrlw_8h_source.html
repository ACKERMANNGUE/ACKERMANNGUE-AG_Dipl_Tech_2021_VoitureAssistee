<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Code source du projet Voiture Assistée: C:/Users/BDCC/source/repos/ACKERMANNGUE-AG_Dipl_Tech_2021_VoitureAssistee/code/Toolbox/Lidar/rplidar_sdk-release-v1.12.0/sdk/app/frame_grabber/ref/wtl/atlctrlw.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_voiture_flatdesign_sensors_range.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Code source du projet Voiture Assistée
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="dir_39fdf193b48ad7c009c0e89f006099f9.html">Toolbox</a></li><li class="navelem"><a class="el" href="dir_df92b0cbf864a645db19a4bd513a467e.html">Lidar</a></li><li class="navelem"><a class="el" href="dir_974c6f74985cc2423e595bceb97fb521.html">rplidar_sdk-release-v1.12.0</a></li><li class="navelem"><a class="el" href="dir_94dad9365c673e0594c85637f1da7fdc.html">sdk</a></li><li class="navelem"><a class="el" href="dir_93eb4bb2002ed75dba4da8aa83c591b1.html">app</a></li><li class="navelem"><a class="el" href="dir_f883d07f0b7eae357f54af7fe73ad601.html">frame_grabber</a></li><li class="navelem"><a class="el" href="dir_50efb723926b81f82f63da481c090b90.html">ref</a></li><li class="navelem"><a class="el" href="dir_df399dbc50f76ff0593639e652f9a24c.html">wtl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">atlctrlw.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="atlctrlw_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Windows Template Library - WTL version 8.1</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Copyright (C) Microsoft Corporation. All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// This file is a part of the Windows Template Library.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// The use and distribution terms for this software are covered by the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Common Public License 1.0 (http://opensource.org/licenses/cpl1.0.php)</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// which can be found in the file CPL.TXT at the root of this distribution.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// By using this software in any fashion, you are agreeing to be bound by</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// the terms of this license. You must not remove this notice, or</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// any other, from this software.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#ifndef __ATLCTRLW_H__</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#define __ATLCTRLW_H__</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#ifdef _WIN32_WCE</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">    #error atlctrlw.h is not supported on Windows CE</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifndef __ATLAPP_H__</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">    #error atlctrlw.h requires atlapp.h to be included first</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifndef __ATLCTRLS_H__</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">    #error atlctrlw.h requires atlctrls.h to be included first</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#if (_WIN32_IE &lt; 0x0400)</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">    #error atlctrlw.h requires _WIN32_IE &gt;= 0x0400</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// Define _WTL_CMDBAR_VISTA_MENUS as 0 to exclude Vista menus support</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#if !defined(_WTL_CMDBAR_VISTA_MENUS) &amp;&amp; (WINVER &gt;= 0x0500) &amp;&amp; (_WIN32_WINNT &gt;= 0x0501) &amp;&amp; (_WIN32_IE &gt;= 0x0501)</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">  #define _WTL_CMDBAR_VISTA_MENUS 1</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">  #if !((_WIN32_WINNT &gt;= 0x0501) &amp;&amp; (_WIN32_IE &gt;= 0x0501))</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">    #error _WTL_CMDBAR_VISTA_MENUS requires (_WIN32_WINNT &gt;= 0x0501) &amp;&amp; (_WIN32_IE &gt;= 0x0501)</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// Classes in this file:</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// CCommandBarCtrlImpl&lt;T, TBase, TWinTraits&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// CCommandBarCtrl</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// CMDICommandBarCtrlImpl&lt;T, TBase, TWinTraits&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// CMDICommandBarCtrl</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_w_t_l.html">WTL</a></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">// Command Bars</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// Window Styles:</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a60f51a148f8984229f34ca90f861b160">   61</a></span>&#160;<span class="preprocessor">#define CBRWS_TOP       CCS_TOP</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a1a384c11b5e28d78368a26a8b1f72428">   62</a></span>&#160;<span class="preprocessor">#define CBRWS_BOTTOM        CCS_BOTTOM</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#adfec89422d51ac867eccda278a498478">   63</a></span>&#160;<span class="preprocessor">#define CBRWS_NORESIZE      CCS_NORESIZE</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a4980b3ade0adce47e2451a32f45ed59f">   64</a></span>&#160;<span class="preprocessor">#define CBRWS_NOPARENTALIGN CCS_NOPARENTALIGN</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#aaccb068f79e1f0984abb39b9820dff9c">   65</a></span>&#160;<span class="preprocessor">#define CBRWS_NODIVIDER     CCS_NODIVIDER</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">// Extended styles</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a54def69e13b608d7681d597d1c4d0c00">   68</a></span>&#160;<span class="preprocessor">#define CBR_EX_TRANSPARENT  0x00000001L</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a33bc338539585b7aa4af90dc83ec7b8b">   69</a></span>&#160;<span class="preprocessor">#define CBR_EX_SHAREMENU    0x00000002L</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a9cd2c9ef1859f1f42f4c114f96fa41b0">   70</a></span>&#160;<span class="preprocessor">#define CBR_EX_ALTFOCUSMODE 0x00000004L</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#adad1bf70b2ae18b73473f537f35534e0">   71</a></span>&#160;<span class="preprocessor">#define CBR_EX_TRACKALWAYS  0x00000008L</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a247bcb0e7ba38932741ec0c8b71761b9">   72</a></span>&#160;<span class="preprocessor">#define CBR_EX_NOVISTAMENUS 0x00000010L</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">// standard command bar styles</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a943fb0b0a647f4e2343ac4512b9d2d0d">   75</a></span>&#160;<span class="preprocessor">#define ATL_SIMPLE_CMDBAR_PANE_STYLE \</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">    (WS_CHILD | WS_VISIBLE | WS_CLIPCHILDREN | WS_CLIPSIBLINGS | CBRWS_NODIVIDER | CBRWS_NORESIZE | CBRWS_NOPARENTALIGN)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// Messages - support chevrons for frame windows</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a1ca3673f0cd8b9d8f422734db43d595e">   79</a></span>&#160;<span class="preprocessor">#define CBRM_GETCMDBAR          (WM_USER + 301) </span><span class="comment">// returns command bar HWND</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a72f3392bf543796e5783483be9628081">   80</a></span>&#160;<span class="preprocessor">#define CBRM_GETMENU            (WM_USER + 302) </span><span class="comment">// returns loaded or attached menu</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="atlctrlw_8h.html#a80b711f34f456fd2358ca35dfd2db8fc">   81</a></span>&#160;<span class="preprocessor">#define CBRM_TRACKPOPUPMENU     (WM_USER + 303) </span><span class="comment">// displays a popup menu</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html">   83</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html">tagCBRPOPUPMENU</a></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#aca985e741a1f45d7adae9557cfb839bf">   85</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#aca985e741a1f45d7adae9557cfb839bf">cbSize</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a309bf8d531939eba86ac4913eb0863d5">   86</a></span>&#160;    HMENU <a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a309bf8d531939eba86ac4913eb0863d5">hMenu</a>;         <span class="comment">// popup menu do display</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a8890d0b8feaf1a70277a101527554974">   87</a></span>&#160;    UINT <a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a8890d0b8feaf1a70277a101527554974">uFlags</a>;         <span class="comment">// TPM_* flags for ::TrackPopupMenuEx</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a6150e0515f7202e2fb518f7206ed97dc">   88</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a0a2f84ed7838f07779ae24c5a9086d33">   89</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#adb9dba29c4be89f78a9be54f7f0d1185">   90</a></span>&#160;    LPTPMPARAMS <a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#adb9dba29c4be89f78a9be54f7f0d1185">lptpm</a>;   <span class="comment">// ptr to TPMPARAMS for ::TrackPopupMenuEx</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespace_w_t_l.html#a55d933cd4a55044d035a52be08f739fc">   91</a></span>&#160;} <a class="code" href="namespace_w_t_l.html#a55d933cd4a55044d035a52be08f739fc">CBRPOPUPMENU</a>, *<a class="code" href="namespace_w_t_l.html#a826b6edc328de072f358d7651558bd83">LPCBRPOPUPMENU</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// helper class</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_simple_stack.html">   95</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_w_t_l_1_1_c_simple_stack.html">CSimpleStack</a> : <span class="keyword">public</span> ATL::CSimpleArray&lt; T &gt;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_simple_stack.html#a935103b38e86a40245a4dc40bd225e4a">   98</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_simple_stack.html#a935103b38e86a40245a4dc40bd225e4a">Push</a>(T t)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - STACK-PUSH (%8.8X) size = %i\n&quot;</span>), t, GetSize());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">return</span> Add(t);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_simple_stack.html#a50269203f686ecb28298ff8f98708e40">  106</a></span>&#160;    T <a class="code" href="class_w_t_l_1_1_c_simple_stack.html#a50269203f686ecb28298ff8f98708e40">Pop</a>()</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">int</span> nLast = GetSize() - 1;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span>(nLast &lt; 0)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">// must be able to convert to NULL</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        T t = m_aT[nLast];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - STACK-POP (%8.8X) size = %i\n&quot;</span>), t, GetSize());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">if</span>(!RemoveAt(nLast))</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">return</span> t;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_simple_stack.html#a2002b48cc2d95cb5617ba79a369b275f">  120</a></span>&#160;    T <a class="code" href="class_w_t_l_1_1_c_simple_stack.html#a2002b48cc2d95cb5617ba79a369b275f">GetCurrent</a>()</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordtype">int</span> nLast = GetSize() - 1;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span>(nLast &lt; 0)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">// must be able to convert to NULL</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">return</span> m_aT[nLast];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;};</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">// CCommandBarCtrlBase - base class for the Command Bar implementation</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">  133</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">CCommandBarCtrlBase</a> : <span class="keyword">public</span> <a class="code" href="class_w_t_l_1_1_c_tool_bar_ctrl_t.html">CToolBarCtrl</a></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html">  136</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html">_MsgHookData</a></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#af534105edc5d607a405efc889dfa3ba8">  138</a></span>&#160;        HHOOK <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#af534105edc5d607a405efc889dfa3ba8">hMsgHook</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#afdaa7687034998769c738c6da1cbc212">  139</a></span>&#160;        DWORD <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#afdaa7687034998769c738c6da1cbc212">dwUsage</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#aa7eabb53555d83572b0163dd358ea7d4">  141</a></span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#aa7eabb53555d83572b0163dd358ea7d4">_MsgHookData</a>() : <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#af534105edc5d607a405efc889dfa3ba8">hMsgHook</a>(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#afdaa7687034998769c738c6da1cbc212">dwUsage</a>(0)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        { }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    };</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a0afbc265b43a3ae78480355de941f27a">  145</a></span>&#160;    <span class="keyword">typedef</span> ATL::CSimpleMap&lt;DWORD, _MsgHookData*&gt;   <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a0afbc265b43a3ae78480355de941f27a">CMsgHookMap</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#aee174fcdb362f7d4ee7016509e42d65f">  146</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a0afbc265b43a3ae78480355de941f27a">CMsgHookMap</a>* <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#aee174fcdb362f7d4ee7016509e42d65f">s_pmapMsgHook</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a63d42dfa843939eeb03aa5deeb0a2269">  148</a></span>&#160;    <span class="keyword">static</span> HHOOK <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a63d42dfa843939eeb03aa5deeb0a2269">s_hCreateHook</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a864c969c101b0fc778d9d35341674c35">  149</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a864c969c101b0fc778d9d35341674c35">s_bW2K</a>;  <span class="comment">// For animation flag</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#ac7683fefc092fdc60591e4e66d6f4296">  150</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">CCommandBarCtrlBase</a>* <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#ac7683fefc092fdc60591e4e66d6f4296">s_pCurrentBar</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a22a0528a0366b9daeaab72902715cc33">  151</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a22a0528a0366b9daeaab72902715cc33">s_bStaticInit</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a5b11d69a8593e4e896e98694b972f4ab">  153</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_simple_stack.html">CSimpleStack&lt;HWND&gt;</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a5b11d69a8593e4e896e98694b972f4ab">m_stackMenuWnd</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a6c5cc1ab0110520d3bdc27b544b6dada">  154</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_simple_stack.html">CSimpleStack&lt;HMENU&gt;</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a6c5cc1ab0110520d3bdc27b544b6dada">m_stackMenuHandle</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#acc5db274749f36099c3354b89c5a4fe8">  156</a></span>&#160;    HWND <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#acc5db274749f36099c3354b89c5a4fe8">m_hWndHook</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a67c91cc533ddecde060b19e879d41b71">  157</a></span>&#160;    DWORD <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a67c91cc533ddecde060b19e879d41b71">m_dwMagic</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a333cc51008f75ac0b13230f6f34915c7">  160</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a333cc51008f75ac0b13230f6f34915c7">CCommandBarCtrlBase</a>() : <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#acc5db274749f36099c3354b89c5a4fe8">m_hWndHook</a>(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a67c91cc533ddecde060b19e879d41b71">m_dwMagic</a>(1314)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// init static variables</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a22a0528a0366b9daeaab72902715cc33">s_bStaticInit</a>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html">CStaticDataInitCriticalSectionLock</a> lock;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">if</span>(FAILED(lock.<a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">Lock</a>()))</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;ERROR : Unable to lock critical section in CCommandBarCtrlBase::CCommandBarCtrlBase.\n&quot;</span>));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a22a0528a0366b9daeaab72902715cc33">s_bStaticInit</a>)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="comment">// Just in case...</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <a class="code" href="namespace_w_t_l.html#a79f79d97f4194c7b8ea7337d5dfa4844">AtlInitCommonControls</a>(ICC_COOL_CLASSES | ICC_BAR_CLASSES);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="comment">// Animation on Win2000 only</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a864c969c101b0fc778d9d35341674c35">s_bW2K</a> = !<a class="code" href="namespace_w_t_l.html#a8d350f94ec08be30642b085bb5f55785">AtlIsOldWindows</a>();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="comment">// done</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a22a0528a0366b9daeaab72902715cc33">s_bStaticInit</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            lock.<a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a25cde13030bbd27213b768fe8089b064">  187</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a25cde13030bbd27213b768fe8089b064">IsCommandBarBase</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a67c91cc533ddecde060b19e879d41b71">m_dwMagic</a> == 1314; }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;};</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<a class="code" href="namespace_w_t_l.html#aad91d7e7c16340eda106860c4c6e9cac">__declspec</a>(selectany) <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a0afbc265b43a3ae78480355de941f27a">CCommandBarCtrlBase::CMsgHookMap</a>* <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#aee174fcdb362f7d4ee7016509e42d65f">CCommandBarCtrlBase::s_pmapMsgHook</a> = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<a class="code" href="namespace_w_t_l.html#aad91d7e7c16340eda106860c4c6e9cac">__declspec</a>(selectany) HHOOK <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a63d42dfa843939eeb03aa5deeb0a2269">CCommandBarCtrlBase::s_hCreateHook</a> = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<a class="code" href="namespace_w_t_l.html#aad91d7e7c16340eda106860c4c6e9cac">__declspec</a>(selectany) CCommandBarCtrlBase* <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#ac7683fefc092fdc60591e4e66d6f4296">CCommandBarCtrlBase::s_pCurrentBar</a> = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<a class="code" href="namespace_w_t_l.html#aad91d7e7c16340eda106860c4c6e9cac">__declspec</a>(selectany) <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a864c969c101b0fc778d9d35341674c35">CCommandBarCtrlBase::s_bW2K</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<a class="code" href="namespace_w_t_l.html#aad91d7e7c16340eda106860c4c6e9cac">__declspec</a>(selectany) <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a22a0528a0366b9daeaab72902715cc33">CCommandBarCtrlBase::s_bStaticInit</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">// CCommandBarCtrl - ATL implementation of Command Bars</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">class</span> TBase = CCommandBarCtrlBase, <span class="keyword">class</span> TWinTraits = ATL::CControlWinTraits&gt;</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">  201</a></span>&#160;<span class="keyword">class </span>ATL_NO_VTABLE <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">CCommandBarCtrlImpl</a> : <span class="keyword">public</span> ATL::CWindowImpl&lt; T, TBase, TWinTraits &gt;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;{</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    DECLARE_WND_SUPERCLASS(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, TBase::GetWndClassName())</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">// Declarations</span></div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">  207</a></span>&#160;    struct <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>    <span class="comment">// menu item data</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a404947e533a0851957a74ca22666743f">  209</a></span>&#160;        DWORD <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a404947e533a0851957a74ca22666743f">dwMagic</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">  210</a></span>&#160;        LPTSTR <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">  211</a></span>&#160;        UINT <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">fType</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a067bd58dd35ee07dea81d0b4a4e144ca">  212</a></span>&#160;        UINT <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a067bd58dd35ee07dea81d0b4a4e144ca">fState</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#af89e777f3ec45bfe9b8dfadb60f5ca23">  213</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#af89e777f3ec45bfe9b8dfadb60f5ca23">iButton</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a922b217ecfd89fcd2a8bb43dfdc01d29">  215</a></span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a922b217ecfd89fcd2a8bb43dfdc01d29">_MenuItemData</a>() { dwMagic = 0x1313; }</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">  216</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">IsCmdBarMenuItem</a>() { <span class="keywordflow">return</span> (dwMagic == 0x1313); }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    };</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html">  219</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html">_ToolBarData</a> <span class="comment">// toolbar resource data</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    {</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a943e513cc2107b5bd86de1dee77c4f1e">  221</a></span>&#160;        WORD <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a943e513cc2107b5bd86de1dee77c4f1e">wVersion</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a97b4a909b19acb8104f14f8eaca3b9f6">  222</a></span>&#160;        WORD <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a97b4a909b19acb8104f14f8eaca3b9f6">wWidth</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ad950f08a0bae48d22e1cd1d20539dbdd">  223</a></span>&#160;        WORD <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ad950f08a0bae48d22e1cd1d20539dbdd">wHeight</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#aea66e70a282226dc49c492c81fec2941">  224</a></span>&#160;        WORD <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#aea66e70a282226dc49c492c81fec2941">wItemCount</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">//WORD aItems[wItemCount]</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ae3e443d24b087e2e3e73e7185ccf3fea">  227</a></span>&#160;        WORD* <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ae3e443d24b087e2e3e73e7185ccf3fea">items</a>()</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            { <span class="keywordflow">return</span> (WORD*)(<span class="keyword">this</span>+1); }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    };</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">// Constants</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af518e71b50746aab97eb347e025d523b">  232</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af518e71b50746aab97eb347e025d523b">_CmdBarDrawConstants</a></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af518e71b50746aab97eb347e025d523baf3becdf86c4a77bb626e819d4da44204">  234</a></span>&#160;        s_kcxGap = 1,</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af518e71b50746aab97eb347e025d523bafb9c560c49f0eb4c162a2d340e81e7e8">  235</a></span>&#160;        s_kcxTextMargin = 2,</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af518e71b50746aab97eb347e025d523ba00d8f0a864803741c8c04dc5174d2dfe">  236</a></span>&#160;        s_kcxButtonMargin = 3,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        s_kcyButtonMargin = 3</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af518e71b50746aab97eb347e025d523ba3280c91cc2abd69837c442c51212dd6e">  238</a></span>&#160;    };</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">enum</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedcf2109f459315e1a7f2af73ec9b603aedaab24d7cfa8baff3499b108ee55a12">  242</a></span>&#160;        _nMaxMenuItemTextLength = 100,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        _chChevronShortcut = _T(<span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedcf2109f459315e1a7f2af73ec9b603a06d19dbb736f9676d4049249380f7836">  244</a></span>&#160;    };</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#ifndef DT_HIDEPREFIX</span></div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a900dca9b26de42491763226e12dcd47ba6eebe03b29df9876649c9be76198b1c2">  247</a></span>&#160;    <span class="keyword">enum</span> { DT_HIDEPREFIX = 0x00100000 };</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !DT_HIDEPREFIX</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">// Data members</span></div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">  251</a></span>&#160;    HMENU <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">m_hMenu</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1a8b80b6c2bb4d3a376abc155ed97dad">  252</a></span>&#160;    HIMAGELIST <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1a8b80b6c2bb4d3a376abc155ed97dad">m_hImageList</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a748bdb50b24563137e4ac6e9d40e6970">  253</a></span>&#160;    ATL::CSimpleValArray&lt;WORD&gt; <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a748bdb50b24563137e4ac6e9d40e6970">m_arrCommand</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a09ec0330f5a8df543075252ca5a6948f">  255</a></span>&#160;    DWORD <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a09ec0330f5a8df543075252ca5a6948f">m_dwExtendedStyle</a>;   <span class="comment">// Command Bar specific extended styles</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4017d453ae091fcb3bf9bfb69623401f">  257</a></span>&#160;    ATL::CContainedWindow <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4017d453ae091fcb3bf9bfb69623401f">m_wndParent</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7e9b4766281fd9c862e11d884de518d9">  259</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7e9b4766281fd9c862e11d884de518d9">m_bMenuActive</a>:1;</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a770f51631ec2b94ba1b67afe0d201076">  260</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a770f51631ec2b94ba1b67afe0d201076">m_bAttachedMenu</a>:1;</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedc9ea55889e7ede32de4f2fa9407b41">  261</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedc9ea55889e7ede32de4f2fa9407b41">m_bImagesVisible</a>:1;</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abe2cda7eb8dd95e60d1c97ec2e345b95">  262</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abe2cda7eb8dd95e60d1c97ec2e345b95">m_bPopupItem</a>:1;</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a376dbbbbee802e7a39a0c222a57a6700">  263</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a376dbbbbee802e7a39a0c222a57a6700">m_bContextMenu</a>:1;</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a84d1969e5f59bfbdc449a2a1ee6cffb7">  264</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a84d1969e5f59bfbdc449a2a1ee6cffb7">m_bEscapePressed</a>:1;</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b1781893e214523d1add2ab3a1ef879">  265</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b1781893e214523d1add2ab3a1ef879">m_bSkipMsg</a>:1;</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a916b4b567753da745e576cd2a935b5e0">  266</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a916b4b567753da745e576cd2a935b5e0">m_bParentActive</a>:1;</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a99d40e167fdda1af3150f2f394cc6ce0">  267</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a99d40e167fdda1af3150f2f394cc6ce0">m_bFlatMenus</a>:1;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3af08a08dd248ed36c721da40d612c36">  268</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3af08a08dd248ed36c721da40d612c36">m_bUseKeyboardCues</a>:1;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa08db13d35633df7169462b0124041c7">  269</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa08db13d35633df7169462b0124041c7">m_bShowKeyboardCues</a>:1;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aee8582438bbe77de15e91a9eba3bdaa3">  270</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aee8582438bbe77de15e91a9eba3bdaa3">m_bAllowKeyboardCues</a>:1;</div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaebdcee2543f73f4769e23b8735eea40">  271</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaebdcee2543f73f4769e23b8735eea40">m_bKeyboardInput</a>:1;</div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedb0d4c474df4ae311bfff56c77abc35">  272</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedb0d4c474df4ae311bfff56c77abc35">m_bAlphaImages</a>:1;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abaf9e71fdee7618a34dd3700346e8370">  273</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abaf9e71fdee7618a34dd3700346e8370">m_bLayoutRTL</a>:1;</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4ba2395daaae873672fbfe67bc48ad2c">  274</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4ba2395daaae873672fbfe67bc48ad2c">m_bSkipPostDown</a>:1;</div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7c9c92583900b0286b779b8cf5d425a4">  275</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7c9c92583900b0286b779b8cf5d425a4">m_bVistaMenus</a>:1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a142cc0ea030dc7f1e0609bc832ff254f">  277</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a142cc0ea030dc7f1e0609bc832ff254f">m_nPopBtn</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a89ebe1865396a1e119d2364d13304165">  278</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a89ebe1865396a1e119d2364d13304165">m_nNextPopBtn</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a817f1614767b0304c0eda49bedeb3ba4">  280</a></span>&#160;    SIZE <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a817f1614767b0304c0eda49bedeb3ba4">m_szBitmap</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a152c5ba371219b701d32a877abb205d7">  281</a></span>&#160;    SIZE <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a152c5ba371219b701d32a877abb205d7">m_szButton</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acba9fd6e17d0f85a83263bfd5de0075e">  283</a></span>&#160;    COLORREF <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acba9fd6e17d0f85a83263bfd5de0075e">m_clrMask</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a926b2e158a4f73fe5651f65f627ba9bf">  284</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_font_t.html">CFont</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a926b2e158a4f73fe5651f65f627ba9bf">m_fontMenu</a>;   <span class="comment">// used internally, only to measure text</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a69a7fc2a235ea66c6370338905fa356b">  286</a></span>&#160;    UINT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a69a7fc2a235ea66c6370338905fa356b">m_uSysKey</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a240c8412e8a108ec6fd9e06fa27c8e90">  288</a></span>&#160;    HWND <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a240c8412e8a108ec6fd9e06fa27c8e90">m_hWndFocus</a>;   <span class="comment">// Alternate focus mode</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaec82318b45e1b28d173c81a0a42aa06">  290</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaec82318b45e1b28d173c81a0a42aa06">m_cxExtraSpacing</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    ATL::CSimpleValArray&lt;HBITMAP&gt; m_arrVistaBitmap;   <span class="comment">// Bitmaps for Vista menus</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">// Constructor/destructor</span></div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ac83fad2d0f1a426aa63d2af7a93cab8c">  297</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ac83fad2d0f1a426aa63d2af7a93cab8c">CCommandBarCtrlImpl</a>() : </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            m_hMenu(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            m_hImageList(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            m_wndParent(this, 1), </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            m_bMenuActive(false), </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            m_bAttachedMenu(false), </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            m_nPopBtn(-1), </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            m_nNextPopBtn(-1), </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            m_bPopupItem(false),</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            m_bImagesVisible(true),</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            m_bSkipMsg(false),</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            m_uSysKey(0),</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            m_hWndFocus(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            m_bContextMenu(false),</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            m_bEscapePressed(false),</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            m_clrMask(RGB(192, 192, 192)),</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            m_dwExtendedStyle(<a class="code" href="atlctrlw_8h.html#a54def69e13b608d7681d597d1c4d0c00">CBR_EX_TRANSPARENT</a> | <a class="code" href="atlctrlw_8h.html#a33bc338539585b7aa4af90dc83ec7b8b">CBR_EX_SHAREMENU</a> | <a class="code" href="atlctrlw_8h.html#adad1bf70b2ae18b73473f537f35534e0">CBR_EX_TRACKALWAYS</a>),</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            m_bParentActive(true),</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            m_bFlatMenus(false),</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            m_bUseKeyboardCues(false),</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            m_bShowKeyboardCues(false),</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            m_bAllowKeyboardCues(true),</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            m_bKeyboardInput(false),</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            m_cxExtraSpacing(0),</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            m_bAlphaImages(false),</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            m_bLayoutRTL(false),</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            m_bSkipPostDown(false),</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            m_bVistaMenus(false)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        SetImageSize(16, 15);   <span class="comment">// default</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7b36ea24dff45fb4d03af619881c02a5">  329</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7b36ea24dff45fb4d03af619881c02a5">~CCommandBarCtrlImpl</a>()</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">if</span>(m_wndParent.IsWindow())</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/*scary!*/</span>          m_wndParent.UnsubclassWindow();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">if</span>(m_hMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; (m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a33bc338539585b7aa4af90dc83ec7b8b">CBR_EX_SHAREMENU</a>) == 0)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            ::DestroyMenu(m_hMenu);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span>(m_hImageList != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            ::ImageList_Destroy(m_hImageList);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">// Attributes</span></div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaa6505e48eb4fa0e5dfbdd87a83715cf">  342</a></span>&#160;    DWORD <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaa6505e48eb4fa0e5dfbdd87a83715cf">GetCommandBarExtendedStyle</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">return</span> m_dwExtendedStyle;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4dfd23a8bd39af4f8062e8fc18d7c98b">  347</a></span>&#160;    DWORD <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4dfd23a8bd39af4f8062e8fc18d7c98b">SetCommandBarExtendedStyle</a>(DWORD dwExtendedStyle, DWORD dwMask = 0)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        DWORD dwPrevStyle = m_dwExtendedStyle;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span>(dwMask == 0)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            m_dwExtendedStyle = dwExtendedStyle;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            m_dwExtendedStyle = (m_dwExtendedStyle &amp; ~dwMask) | (dwExtendedStyle &amp; dwMask);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span> dwPrevStyle;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5d7ca217514b277ce242c7a8df7d65ca">  357</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5d7ca217514b277ce242c7a8df7d65ca">GetMenu</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">return</span> m_hMenu;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a19708fc753e4fed1258815b5cc75657f">  363</a></span>&#160;    COLORREF <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a19708fc753e4fed1258815b5cc75657f">GetImageMaskColor</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> m_clrMask;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6348bf301f65134a630a075519fb1e88">  368</a></span>&#160;    COLORREF <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6348bf301f65134a630a075519fb1e88">SetImageMaskColor</a>(COLORREF clrMask)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        COLORREF clrOld = m_clrMask;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        m_clrMask = clrMask;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">return</span> clrOld;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7dc6a6f76c854df6db9234bd442b5029">  375</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7dc6a6f76c854df6db9234bd442b5029">GetImagesVisible</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">return</span> m_bImagesVisible;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa1be7af9d37dfca29ff903d9735e7d3a">  380</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa1be7af9d37dfca29ff903d9735e7d3a">SetImagesVisible</a>(<span class="keywordtype">bool</span> bVisible)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordtype">bool</span> bOld = m_bImagesVisible;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        m_bImagesVisible = bVisible;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">return</span> bOld;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a526b9e8333727c9b349a0fbcb6434aa9">  387</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a526b9e8333727c9b349a0fbcb6434aa9">GetImageSize</a>(SIZE&amp; <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a> = m_szBitmap;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#afbf29132cd805a43eb9756452dda6cec">  392</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#afbf29132cd805a43eb9756452dda6cec">SetImageSize</a>(SIZE&amp; <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">return</span> SetImageSize(<a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aabef65f85e9e66938d12203d332c469a">  397</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aabef65f85e9e66938d12203d332c469a">SetImageSize</a>(<span class="keywordtype">int</span> cx, <span class="keywordtype">int</span> cy)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">if</span>(m_hImageList != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keywordflow">if</span>(::ImageList_GetImageCount(m_hImageList) == 0)   <span class="comment">// empty</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                ::ImageList_Destroy(m_hImageList);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                m_hImageList = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;   <span class="comment">// can&#39;t set, image list exists</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">if</span>(cx == 0 || cy == 0)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        m_szBitmap.cx = cx;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        m_szBitmap.cy = cy;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        m_szButton.cx = m_szBitmap.cx + 2 * s_kcxButtonMargin;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        m_szButton.cy = m_szBitmap.cy + 2 * s_kcyButtonMargin;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab4a4bad761fc7344925fba1fd4cde57e">  423</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab4a4bad761fc7344925fba1fd4cde57e">GetAlphaImages</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">return</span> m_bAlphaImages;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad1204acd741f993478b53340fba5d20b">  428</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad1204acd741f993478b53340fba5d20b">SetAlphaImages</a>(<span class="keywordtype">bool</span> bAlphaImages)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span>(m_hImageList != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">if</span>(::ImageList_GetImageCount(m_hImageList) == 0)   <span class="comment">// empty</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                ::ImageList_Destroy(m_hImageList);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                m_hImageList = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;   <span class="comment">// can&#39;t set, image list exists</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        m_bAlphaImages = bAlphaImages;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a12792e1c13fab5e76c6f736b162915b9">  447</a></span>&#160;    HWND <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a12792e1c13fab5e76c6f736b162915b9">GetCmdBar</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">return</span> (HWND)::SendMessage(m_hWnd, <a class="code" href="atlctrlw_8h.html#a1ca3673f0cd8b9d8f422734db43d595e">CBRM_GETCMDBAR</a>, 0, 0L);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">// Methods</span></div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a64566fe643192cb06448878e52e3c707">  454</a></span>&#160;    HWND <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a64566fe643192cb06448878e52e3c707">Create</a>(HWND hWndParent, RECT&amp; rcPos, LPCTSTR szWindowName = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            DWORD dwStyle = 0, DWORD dwExStyle = 0,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            UINT nID = 0, LPVOID lpCreateParam = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// These styles are required for command bars</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        dwStyle |= TBSTYLE_LIST | TBSTYLE_FLAT;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor">#if (_MSC_VER &gt;= 1300)</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">return</span> ATL::CWindowImpl&lt; T, TBase, TWinTraits &gt;::Create(hWndParent, rcPos, szWindowName, dwStyle, dwExStyle, nID, lpCreateParam);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#else </span><span class="comment">// !(_MSC_VER &gt;= 1300)</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keyword">typedef</span> ATL::CWindowImpl&lt; T, TBase, TWinTraits &gt;   _baseClass;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">return</span> _baseClass::Create(hWndParent, rcPos, szWindowName, dwStyle, dwExStyle, nID, lpCreateParam);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !(_MSC_VER &gt;= 1300)</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a74ef2342b53a7446fe1857ee33bc6905">  468</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a74ef2342b53a7446fe1857ee33bc6905">AttachToWindow</a>(HWND hWnd)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        ATLASSERT(m_hWnd == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        ATLASSERT(::IsWindow(hWnd));</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = SubclassWindow(hWnd);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            m_bAttachedMenu = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            pT-&gt;GetSystemSettings();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af3ab18a88601d69a41577698827492ec">  482</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af3ab18a88601d69a41577698827492ec">LoadMenu</a>(<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a> menu)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">if</span>(m_bAttachedMenu)   <span class="comment">// doesn&#39;t work in this mode</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">if</span>(menu.<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html#a2b23de29e413c50b53b825afa0c63d41">m_lpstr</a> == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        HMENU hMenu = ::LoadMenu(<a class="code" href="namespace_w_t_l_1_1_module_helper.html#a469b30fb7c668ec0e547d21f8c134175">ModuleHelper::GetResourceInstance</a>(), menu.<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html#a2b23de29e413c50b53b825afa0c63d41">m_lpstr</a>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">if</span>(hMenu == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">return</span> AttachMenu(hMenu);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5a7c2c8114fbe4bcaa18793194d0e73d">  498</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5a7c2c8114fbe4bcaa18793194d0e73d">AttachMenu</a>(HMENU hMenu)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        ATLASSERT(hMenu == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || ::IsMenu(hMenu));</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span>(hMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; !::IsMenu(hMenu))</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="comment">// remove Vista bitmaps if used</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">if</span>(m_bVistaMenus &amp;&amp; (m_hMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            pT-&gt;_RemoveVistaBitmapsFromMenu();</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">// destroy old menu, if needed, and set new one</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span>(m_hMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; (m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a33bc338539585b7aa4af90dc83ec7b8b">CBR_EX_SHAREMENU</a>) == 0)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            ::DestroyMenu(m_hMenu);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        m_hMenu = hMenu;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">if</span>(m_bAttachedMenu)   <span class="comment">// Nothing else in this mode</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">// Build buttons according to menu</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        SetRedraw(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">// Clear all buttons</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordtype">int</span> nCount = GetButtonCount();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nCount; i++)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <a class="code" href="atlapp_8h.html#a390bdfa6d9c2f2442cd38197f6ad339f">ATLVERIFY</a>(DeleteButton(0) != <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="comment">// Add buttons for each menu item</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">if</span>(m_hMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="keywordtype">int</span> nItems = ::GetMenuItemCount(m_hMenu);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            pT;   <span class="comment">// avoid level 4 warning</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            TCHAR szString[pT-&gt;_nMaxMenuItemTextLength];</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nItems; i++)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> mii;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                mii.fMask = MIIM_TYPE | MIIM_STATE | MIIM_SUBMENU;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                mii.fType = MFT_STRING;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                mii.dwTypeData = szString;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                mii.cch = pT-&gt;_nMaxMenuItemTextLength;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = ::GetMenuItemInfo(m_hMenu, i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                ATLASSERT(bRet);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="comment">// If we have more than the buffer, we assume we have bitmaps bits</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="keywordflow">if</span>(lstrlen(szString) &gt; pT-&gt;_nMaxMenuItemTextLength - 1)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    mii.fType = MFT_BITMAP;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    ::SetMenuItemInfo(m_hMenu, i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    szString[0] = 0;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <span class="comment">// NOTE: Command Bar currently supports only drop-down menu items</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                ATLASSERT(mii.hSubMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                TBBUTTON btn = { 0 };</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                btn.iBitmap = 0;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                btn.idCommand = i;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                btn.fsState = (BYTE)(((mii.fState &amp; MFS_DISABLED) == 0) ? TBSTATE_ENABLED : 0);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                btn.fsStyle = TBSTYLE_BUTTON | TBSTYLE_AUTOSIZE | TBSTYLE_DROPDOWN;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                btn.dwData = 0;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                btn.iString = 0;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                bRet = InsertButton(-1, &amp;btn);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                ATLASSERT(bRet);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                TBBUTTONINFO bi = { 0 };</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                bi.cbSize = <span class="keyword">sizeof</span>(TBBUTTONINFO);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                bi.dwMask = TBIF_TEXT;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                bi.pszText = szString;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                bRet = SetButtonInfo(i, &amp;bi);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                ATLASSERT(bRet);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        SetRedraw(<a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        Invalidate();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        UpdateWindow();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa8316c77a26be6c2133af48120bdf2da">  587</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa8316c77a26be6c2133af48120bdf2da">LoadImages</a>(<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a> <a class="code" href="namespaceimage.html">image</a>)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">return</span> _LoadImagesHelper(<a class="code" href="namespaceimage.html">image</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abf90b5a72853fd28ab530645a20233a9">  592</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abf90b5a72853fd28ab530645a20233a9">LoadMappedImages</a>(UINT nIDImage, UINT nFlags = 0, LPCOLORMAP lpColorMap = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keywordtype">int</span> nMapSize = 0)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">return</span> _LoadImagesHelper(nIDImage, <span class="keyword">true</span>, nFlags , lpColorMap, nMapSize);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acaa09118f95e4d089d242f98d527074a">  597</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acaa09118f95e4d089d242f98d527074a">_LoadImagesHelper</a>(<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a> <a class="code" href="namespaceimage.html">image</a>, <span class="keywordtype">bool</span> bMapped, UINT nFlags = 0, LPCOLORMAP lpColorMap = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keywordtype">int</span> nMapSize = 0)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        HINSTANCE hInstance = <a class="code" href="namespace_w_t_l_1_1_module_helper.html#a469b30fb7c668ec0e547d21f8c134175">ModuleHelper::GetResourceInstance</a>();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        HRSRC hRsrc = ::FindResource(hInstance, <a class="code" href="namespaceimage.html">image</a>.m_lpstr, (LPTSTR)<a class="code" href="atlres_8h.html#a9cafe9f4c01b4a48731f38d1f9e2f642">RT_TOOLBAR</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span>(hRsrc == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        HGLOBAL hGlobal = ::LoadResource(hInstance, hRsrc);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">if</span>(hGlobal == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html">_ToolBarData</a>* pData = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html">_ToolBarData</a>*)::LockResource(hGlobal);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span>(pData == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        ATLASSERT(pData-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a943e513cc2107b5bd86de1dee77c4f1e">wVersion</a> == 1);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        WORD* pItems = pData-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ae3e443d24b087e2e3e73e7185ccf3fea">items</a>();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordtype">int</span> nItems = pData-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#aea66e70a282226dc49c492c81fec2941">wItemCount</a>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="comment">// Set internal data</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        SetImageSize(pData-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a97b4a909b19acb8104f14f8eaca3b9f6">wWidth</a>, pData-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ad950f08a0bae48d22e1cd1d20539dbdd">wHeight</a>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">// Create image list if needed</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">if</span>(m_hImageList == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="comment">// Check if the bitmap is 32-bit (alpha channel) bitmap (valid for Windows XP only)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            m_bAlphaImages = <a class="code" href="namespace_w_t_l.html#a5c922e257555a46ec3da17c7951e7c05">AtlIsAlphaBitmapResource</a>(<a class="code" href="namespaceimage.html">image</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">if</span>(!pT-&gt;CreateInternalImageList(pData-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#aea66e70a282226dc49c492c81fec2941">wItemCount</a>))</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordtype">int</span> nOldImageCount = ::ImageList_GetImageCount(m_hImageList);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">// Add bitmap to our image list</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_bitmap_t.html">CBitmap</a> bmp;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">if</span>(bMapped)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            ATLASSERT(HIWORD(<a class="code" href="atlapp_8h.html#aa53040d6ed85b65dd0ebc79ced7fd547">PtrToUlong</a>(<a class="code" href="namespaceimage.html">image</a>.m_lpstr)) == 0);   <span class="comment">// if mapped, must be a numeric ID</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordtype">int</span> nIDImage = (<a class="code" href="namespacechecksum.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)(<span class="keywordtype">short</span>)LOWORD(<a class="code" href="atlapp_8h.html#aa53040d6ed85b65dd0ebc79ced7fd547">PtrToUlong</a>(<a class="code" href="namespaceimage.html">image</a>.m_lpstr));</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a88546d448955b320fc895a807632716a">LoadMappedBitmap</a>(nIDImage, (WORD)nFlags, lpColorMap, nMapSize);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordflow">if</span>(m_bAlphaImages)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                bmp = (HBITMAP)::LoadImage(<a class="code" href="namespace_w_t_l_1_1_module_helper.html#a469b30fb7c668ec0e547d21f8c134175">ModuleHelper::GetResourceInstance</a>(), <a class="code" href="namespaceimage.html">image</a>.m_lpstr, IMAGE_BITMAP, 0, 0, LR_CREATEDIBSECTION | LR_DEFAULTSIZE);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a63642d8900f6857cfa608fe2e1d29da6">LoadBitmap</a>(<a class="code" href="namespaceimage.html">image</a>.m_lpstr);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        ATLASSERT(bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a80d077468cbf98534a6621aa4f62a187">m_hBitmap</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordflow">if</span>(bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a80d077468cbf98534a6621aa4f62a187">m_hBitmap</a> == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span>(::ImageList_AddMasked(m_hImageList, bmp, m_clrMask) == -1)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="comment">// Fill the array with command IDs</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nItems; i++)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">if</span>(pItems[i] != 0)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                m_arrCommand.Add(pItems[i]);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordtype">int</span> nImageCount = ::ImageList_GetImageCount(m_hImageList);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        ATLASSERT(nImageCount == m_arrCommand.GetSize());</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">if</span>(nImageCount != m_arrCommand.GetSize())</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">RunTimeHelper::IsVista</a>())</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            pT-&gt;_AddVistaBitmapsFromImageList(nOldImageCount, nImageCount - nOldImageCount);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            ATLASSERT(nImageCount == m_arrVistaBitmap.GetSize());</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a8ca1b724201ac19095ea9555f354b53b">  681</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a8ca1b724201ac19095ea9555f354b53b">AddBitmap</a>(<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a> bitmap, <span class="keywordtype">int</span> nCommandID)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_bitmap_t.html">CBitmap</a> bmp;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a63642d8900f6857cfa608fe2e1d29da6">LoadBitmap</a>(bitmap.<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html#a2b23de29e413c50b53b825afa0c63d41">m_lpstr</a>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">if</span>(bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a80d077468cbf98534a6621aa4f62a187">m_hBitmap</a> == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">return</span> AddBitmap(bmp, nCommandID);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a548d0266db9a633faae1c719c4de0dcb">  691</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a548d0266db9a633faae1c719c4de0dcb">AddBitmap</a>(HBITMAP hBitmap, UINT nCommandID)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="comment">// Create image list if it doesn&#39;t exist</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">if</span>(m_hImageList == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">if</span>(!pT-&gt;CreateInternalImageList(1))</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="comment">// check bitmap size</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_bitmap_t.html">CBitmapHandle</a> bmp = hBitmap;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        SIZE <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a> = { 0, 0 };</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a9636e923693f93bc2d7a093275c0575b">GetSize</a>(<a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx != m_szBitmap.cx || <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy != m_szBitmap.cy)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);   <span class="comment">// must match size!</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment">// add bitmap</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordtype">int</span> nRet = ::ImageList_AddMasked(m_hImageList, hBitmap, m_clrMask);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">if</span>(nRet == -1)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = m_arrCommand.Add((WORD)nCommandID);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        ATLASSERT(::ImageList_GetImageCount(m_hImageList) == m_arrCommand.GetSize());</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">RunTimeHelper::IsVista</a>())</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            pT-&gt;_AddVistaBitmapFromImageList(m_arrCommand.GetSize() - 1);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            ATLASSERT(m_arrVistaBitmap.GetSize() == m_arrCommand.GetSize());</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ce3be3682535e058f5e160975693664">  726</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ce3be3682535e058f5e160975693664">AddIcon</a>(<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a> icon, UINT nCommandID)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        HICON hIcon = ::LoadIcon(<a class="code" href="namespace_w_t_l_1_1_module_helper.html#a469b30fb7c668ec0e547d21f8c134175">ModuleHelper::GetResourceInstance</a>(), icon.<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html#a2b23de29e413c50b53b825afa0c63d41">m_lpstr</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">if</span>(hIcon == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">return</span> AddIcon(hIcon, nCommandID);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#adff291440c6e281ea70923577ef75e5c">  735</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#adff291440c6e281ea70923577ef75e5c">AddIcon</a>(HICON hIcon, UINT nCommandID)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="comment">// create image list if it doesn&#39;t exist</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">if</span>(m_hImageList == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keywordflow">if</span>(!pT-&gt;CreateInternalImageList(1))</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordtype">int</span> nRet = ::ImageList_AddIcon(m_hImageList, hIcon);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">if</span>(nRet == -1)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = m_arrCommand.Add((WORD)nCommandID);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        ATLASSERT(::ImageList_GetImageCount(m_hImageList) == m_arrCommand.GetSize());</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">RunTimeHelper::IsVista</a>())</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            pT-&gt;_AddVistaBitmapFromImageList(m_arrCommand.GetSize() - 1);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            ATLASSERT(m_arrVistaBitmap.GetSize() == m_arrCommand.GetSize());</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a03ba2fb6c1160ceb41db6fedbc6d9740">  761</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a03ba2fb6c1160ceb41db6fedbc6d9740">ReplaceBitmap</a>(<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a> bitmap, <span class="keywordtype">int</span> nCommandID)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_bitmap_t.html">CBitmap</a> bmp;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a63642d8900f6857cfa608fe2e1d29da6">LoadBitmap</a>(bitmap.<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html#a2b23de29e413c50b53b825afa0c63d41">m_lpstr</a>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">if</span>(bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a80d077468cbf98534a6621aa4f62a187">m_hBitmap</a> == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">return</span> ReplaceBitmap(bmp, nCommandID);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad958af02eb8fb21a3c283dbbe786f38a">  771</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad958af02eb8fb21a3c283dbbe786f38a">ReplaceBitmap</a>(HBITMAP hBitmap, UINT nCommandID)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_arrCommand.GetSize(); i++)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="keywordflow">if</span>(m_arrCommand[i] == nCommandID)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                bRet = ::ImageList_Remove(m_hImageList, i);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    m_arrCommand.RemoveAt(i);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">RunTimeHelper::IsVista</a>())</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        <span class="keywordflow">if</span>(m_arrVistaBitmap[i] != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                            ::DeleteObject(m_arrVistaBitmap[i]);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        m_arrVistaBitmap.RemoveAt(i);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            bRet = AddBitmap(hBitmap, nCommandID);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a9d4ac13dc84c368305a447a18cc3d447">  800</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a9d4ac13dc84c368305a447a18cc3d447">ReplaceIcon</a>(<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a> icon, UINT nCommandID)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        HICON hIcon = ::LoadIcon(<a class="code" href="namespace_w_t_l_1_1_module_helper.html#a469b30fb7c668ec0e547d21f8c134175">ModuleHelper::GetResourceInstance</a>(), icon.<a class="code" href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html#a2b23de29e413c50b53b825afa0c63d41">m_lpstr</a>);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordflow">if</span>(hIcon == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">return</span> ReplaceIcon(hIcon, nCommandID);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ade5501a6af106fa277fc17614edbd7d0">  809</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ade5501a6af106fa277fc17614edbd7d0">ReplaceIcon</a>(HICON hIcon, UINT nCommandID)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_arrCommand.GetSize(); i++)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">if</span>(m_arrCommand[i] == nCommandID)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                bRet = (::ImageList_ReplaceIcon(m_hImageList, i, hIcon) != -1);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">RunTimeHelper::IsVista</a>() &amp;&amp; bRet != <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                    pT-&gt;_ReplaceVistaBitmapFromImageList(i);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a0c833ae6941eccbbc79a32b43eb7c43e">  831</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a0c833ae6941eccbbc79a32b43eb7c43e">RemoveImage</a>(<span class="keywordtype">int</span> nCommandID)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_arrCommand.GetSize(); i++)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">if</span>(m_arrCommand[i] == nCommandID)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                bRet = ::ImageList_Remove(m_hImageList, i);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    m_arrCommand.RemoveAt(i);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">RunTimeHelper::IsVista</a>())</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                        <span class="keywordflow">if</span>(m_arrVistaBitmap[i] != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                            ::DeleteObject(m_arrVistaBitmap[i]);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        m_arrVistaBitmap.RemoveAt(i);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b44786654c70b6c24e19bfb63850eb9">  859</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b44786654c70b6c24e19bfb63850eb9">RemoveAllImages</a>()</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Removing all images\n&quot;</span>));</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = ::ImageList_RemoveAll(m_hImageList);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            m_arrCommand.RemoveAll();</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_arrVistaBitmap.GetSize(); i++)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                <span class="keywordflow">if</span>(m_arrVistaBitmap[i] != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    ::DeleteObject(m_arrVistaBitmap[i]);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            m_arrVistaBitmap.RemoveAll();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a33cffd840b86e1208cb73f79ff6c7384">  880</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a33cffd840b86e1208cb73f79ff6c7384">TrackPopupMenu</a>(HMENU hMenu, UINT uFlags, <span class="keywordtype">int</span> <a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <span class="keywordtype">int</span> <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, LPTPMPARAMS lpParams = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        ATLASSERT(::IsMenu(hMenu));</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">if</span>(!::IsMenu(hMenu))</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        m_bContextMenu = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">if</span>(m_bUseKeyboardCues)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            m_bShowKeyboardCues = m_bKeyboardInput;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">return</span> pT-&gt;DoTrackPopupMenu(hMenu, uFlags, <a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, lpParams);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa4556f2907372535207c3f560a245179">  893</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa4556f2907372535207c3f560a245179">SetMDIClient</a>(HWND <span class="comment">/*hWndMDIClient*/</span>)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="comment">// Use CMDICommandBarCtrl for MDI support</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">// Message map and handlers</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    BEGIN_MSG_MAP(<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">CCommandBarCtrlImpl</a>)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        MESSAGE_HANDLER(WM_CREATE, OnCreate)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        MESSAGE_HANDLER(WM_DESTROY, OnDestroy)</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        MESSAGE_HANDLER(WM_ERASEBKGND, OnEraseBackground)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        MESSAGE_HANDLER(WM_INITMENU, OnInitMenu)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        MESSAGE_HANDLER(WM_INITMENUPOPUP, OnInitMenuPopup)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        MESSAGE_HANDLER(WM_MENUSELECT, OnMenuSelect)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        MESSAGE_HANDLER(GetAutoPopupMessage(), OnInternalAutoPopup)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        MESSAGE_HANDLER(GetGetBarMessage(), OnInternalGetBar)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        MESSAGE_HANDLER(WM_SETTINGCHANGE, OnSettingChange)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        MESSAGE_HANDLER(WM_MENUCHAR, OnMenuChar)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        MESSAGE_HANDLER(WM_KEYDOWN, OnKeyDown)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        MESSAGE_HANDLER(WM_KEYUP, OnKeyUp)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        MESSAGE_HANDLER(WM_CHAR, OnChar)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        MESSAGE_HANDLER(WM_SYSKEYDOWN, OnSysKeyDown)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        MESSAGE_HANDLER(WM_SYSKEYUP, OnSysKeyUp)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        MESSAGE_HANDLER(WM_SYSCHAR, OnSysChar)</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">// public API handlers - these stay to support chevrons in atlframe.h</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        MESSAGE_HANDLER(<a class="code" href="atlctrlw_8h.html#a72f3392bf543796e5783483be9628081">CBRM_GETMENU</a>, OnAPIGetMenu)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        MESSAGE_HANDLER(<a class="code" href="atlctrlw_8h.html#a80b711f34f456fd2358ca35dfd2db8fc">CBRM_TRACKPOPUPMENU</a>, OnAPITrackPopupMenu)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        MESSAGE_HANDLER(<a class="code" href="atlctrlw_8h.html#a1ca3673f0cd8b9d8f422734db43d595e">CBRM_GETCMDBAR</a>, OnAPIGetCmdBar)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        MESSAGE_HANDLER(WM_DRAWITEM, OnDrawItem)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        MESSAGE_HANDLER(WM_MEASUREITEM, OnMeasureItem)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        MESSAGE_HANDLER(WM_FORWARDMSG, OnForwardMsg)</div>
<div class="line"><a name="l00928"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5d465714b99455acb8ac5e93ed3a258a">  928</a></span>&#160;    ALT_MSG_MAP(1)   <span class="comment">// Parent window messages</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        NOTIFY_CODE_HANDLER(TBN_HOTITEMCHANGE, OnParentHotItemChange)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        NOTIFY_CODE_HANDLER(TBN_DROPDOWN, OnParentDropDown)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        MESSAGE_HANDLER(WM_INITMENUPOPUP, OnParentInitMenuPopup)</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        MESSAGE_HANDLER(GetGetBarMessage(), OnParentInternalGetBar)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        MESSAGE_HANDLER(WM_SYSCOMMAND, OnParentSysCommand)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        MESSAGE_HANDLER(<a class="code" href="atlctrlw_8h.html#a72f3392bf543796e5783483be9628081">CBRM_GETMENU</a>, OnParentAPIGetMenu)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        MESSAGE_HANDLER(WM_MENUCHAR, OnParentMenuChar)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        MESSAGE_HANDLER(<a class="code" href="atlctrlw_8h.html#a80b711f34f456fd2358ca35dfd2db8fc">CBRM_TRACKPOPUPMENU</a>, OnParentAPITrackPopupMenu)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        MESSAGE_HANDLER(<a class="code" href="atlctrlw_8h.html#a1ca3673f0cd8b9d8f422734db43d595e">CBRM_GETCMDBAR</a>, OnParentAPIGetCmdBar)</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        MESSAGE_HANDLER(WM_SETTINGCHANGE, OnParentSettingChange)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        MESSAGE_HANDLER(WM_DRAWITEM, OnParentDrawItem)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        MESSAGE_HANDLER(WM_MEASUREITEM, OnParentMeasureItem)</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        MESSAGE_HANDLER(WM_ACTIVATE, OnParentActivate)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        NOTIFY_CODE_HANDLER(NM_CUSTOMDRAW, OnParentCustomDraw)</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    ALT_MSG_MAP(2)   <span class="comment">// MDI client window messages</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="comment">// Use CMDICommandBarCtrl for MDI support</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    ALT_MSG_MAP(3)   <span class="comment">// Message hook messages</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        MESSAGE_HANDLER(WM_MOUSEMOVE, OnHookMouseMove)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        MESSAGE_HANDLER(WM_SYSKEYDOWN, OnHookSysKeyDown)</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        MESSAGE_HANDLER(WM_SYSKEYUP, OnHookSysKeyUp)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        MESSAGE_HANDLER(WM_SYSCHAR, OnHookSysChar)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        MESSAGE_HANDLER(WM_KEYDOWN, OnHookKeyDown)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        MESSAGE_HANDLER(WM_NEXTMENU, OnHookNextMenu)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        MESSAGE_HANDLER(WM_CHAR, OnHookChar)</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    END_MSG_MAP()</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6502a620e85496eb7a57b0097af61a83">  957</a></span>&#160;    LRESULT OnForwardMsg(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        LPMSG pMsg = (LPMSG)lParam;</div>
<div class="line"><a name="l00960"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5f482c2c1db17b4dca1d93d98fc2a7bf">  960</a></span>&#160;        <span class="keywordflow">if</span>(pMsg-&gt;message &gt;= WM_MOUSEFIRST &amp;&amp; pMsg-&gt;message &lt;= WM_MOUSELAST)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            m_bKeyboardInput = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6304a6928c0867c9c91d65d9e9b61117">  962</a></span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pMsg-&gt;message &gt;= WM_KEYFIRST &amp;&amp; pMsg-&gt;message &lt;= WM_KEYLAST)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            m_bKeyboardInput = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7af76fc9d621447fb00bc6e323acd01b">  964</a></span>&#160;        LRESULT lRet = 0;</div>
<div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3d2e36fe7aa6de0fa6baa09110b2b0af">  965</a></span>&#160;        <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3d2e36fe7aa6de0fa6baa09110b2b0af">ProcessWindowMessage</a>(pMsg-&gt;hwnd, pMsg-&gt;message, pMsg-&gt;wParam, pMsg-&gt;lParam, lRet, 3);</div>
<div class="line"><a name="l00966"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1b2303588f16b9d23715848cf3d16afb">  966</a></span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1b2303588f16b9d23715848cf3d16afb">lRet</a>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a248dcce220d8bb9f061f57bef06e644a">  969</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a248dcce220d8bb9f061f57bef06e644a">OnCreate</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">// Let the toolbar initialize itself</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="comment">// get and use system settings</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        pT-&gt;GetSystemSettings();</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="comment">// Parent init</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        ATL::CWindow wndParent = GetParent();</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        ATL::CWindow wndTopLevelParent = wndParent.GetTopLevelParent();</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        m_wndParent.SubclassWindow(wndTopLevelParent);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">// Toolbar Init</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        SetButtonStructSize();</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        SetImageList(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment">// Create message hook if needed</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html">CWindowCreateCriticalSectionLock</a> lock;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">if</span>(FAILED(lock.<a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">Lock</a>()))</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;ERROR : Unable to lock critical section in CCommandBarCtrlImpl::OnCreate.\n&quot;</span>));</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">if</span>(s_pmapMsgHook == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            ATLTRY(s_pmapMsgHook = <span class="keyword">new</span> CMsgHookMap);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            ATLASSERT(s_pmapMsgHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="keywordflow">if</span>(s_pmapMsgHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            DWORD dwThreadID = ::GetCurrentThreadId();</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            _MsgHookData* pData = s_pmapMsgHook-&gt;Lookup(dwThreadID);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordflow">if</span>(pData == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                ATLTRY(pData = <span class="keyword">new</span> _MsgHookData);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                ATLASSERT(pData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                HHOOK hMsgHook = ::SetWindowsHookEx(WH_GETMESSAGE, MessageHookProc, <a class="code" href="namespace_w_t_l_1_1_module_helper.html#ad444c040fe6a3be1592135f52989627f">ModuleHelper::GetModuleInstance</a>(), dwThreadID);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                ATLASSERT(hMsgHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                <span class="keywordflow">if</span>(pData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; hMsgHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    pData-&gt;hMsgHook = hMsgHook;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    pData-&gt;dwUsage = 1;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = s_pmapMsgHook-&gt;Add(dwThreadID, pData);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    bRet;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                    ATLASSERT(bRet);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                (pData-&gt;dwUsage)++;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        lock.<a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="comment">// Get layout</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#if (WINVER &gt;= 0x0500)</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        m_bLayoutRTL = ((GetExStyle() &amp; WS_EX_LAYOUTRTL) != 0);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (WINVER &gt;= 0x0500)</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a0e43918adb060a998e9212341bf68dcc"> 1033</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a0e43918adb060a998e9212341bf68dcc">OnDestroy</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="keywordflow">if</span>(m_bVistaMenus &amp;&amp; (m_hMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            pT-&gt;_RemoveVistaBitmapsFromMenu();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_arrVistaBitmap.GetSize(); i++)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordflow">if</span>(m_arrVistaBitmap[i] != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                ::DeleteObject(m_arrVistaBitmap[i]);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">if</span>(m_bAttachedMenu)   <span class="comment">// nothing to do in this mode</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html">CWindowCreateCriticalSectionLock</a> lock;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordflow">if</span>(FAILED(lock.<a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">Lock</a>()))</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;ERROR : Unable to lock critical section in CCommandBarCtrlImpl::OnDestroy.\n&quot;</span>));</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span>(s_pmapMsgHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            DWORD dwThreadID = ::GetCurrentThreadId();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            _MsgHookData* pData = s_pmapMsgHook-&gt;Lookup(dwThreadID);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">if</span>(pData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                (pData-&gt;dwUsage)--;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                <span class="keywordflow">if</span>(pData-&gt;dwUsage == 0)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = ::UnhookWindowsHookEx(pData-&gt;hMsgHook);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    ATLASSERT(bRet);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    bRet = s_pmapMsgHook-&gt;Remove(dwThreadID);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                    ATLASSERT(bRet);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                    <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                        <span class="keyword">delete</span> pData;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keywordflow">if</span>(s_pmapMsgHook-&gt;GetSize() == 0)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    <span class="keyword">delete</span> s_pmapMsgHook;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                    s_pmapMsgHook = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        lock.<a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6298050d9c49f7303e54086028ab18f9"> 1092</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6298050d9c49f7303e54086028ab18f9">OnKeyDown</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnKeyDown\n&quot;</span>));</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="comment">// Simulate Alt+Space for the parent</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">if</span>(wParam == VK_SPACE)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            m_wndParent.PostMessage(WM_SYSKEYDOWN, wParam, lParam | (1 &lt;&lt; 29));</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(wParam == VK_LEFT || wParam == VK_RIGHT)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            WPARAM wpNext = m_bLayoutRTL ? VK_LEFT : VK_RIGHT;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keywordflow">if</span>(!m_bMenuActive)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                <span class="keywordtype">int</span> nBtn = GetHotItem();</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                <span class="keywordtype">int</span> nNextBtn = (wParam == wpNext) ? pT-&gt;GetNextMenuItem(nBtn) : pT-&gt;GetPreviousMenuItem(nBtn);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                <span class="keywordflow">if</span>(nNextBtn == -2)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    SetHotItem(-1);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    <span class="keywordflow">if</span>(pT-&gt;DisplayChevronMenu())</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                        bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad00d7d3368a5345f246dea05d5c89649"> 1126</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad00d7d3368a5345f246dea05d5c89649">OnKeyUp</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnKeyUp\n&quot;</span>));</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">if</span>(wParam != VK_SPACE)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a40fc5a585e937739787cff3953b3251f"> 1136</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a40fc5a585e937739787cff3953b3251f">OnChar</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnChar\n&quot;</span>));</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">if</span>(wParam != VK_SPACE)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        <span class="comment">// Security</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">if</span>(!m_wndParent.IsWindowEnabled() || ::GetFocus() != m_hWnd)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="comment">// Handle mnemonic press when we have focus</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordtype">int</span> nBtn = 0;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="keywordflow">if</span>(wParam != VK_RETURN &amp;&amp; !MapAccelerator((TCHAR)LOWORD(wParam), nBtn))</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            <span class="keywordflow">if</span>((TCHAR)LOWORD(wParam) != _chChevronShortcut)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                ::MessageBeep(0);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            RECT rcClient = { 0 };</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            GetClientRect(&amp;rcClient);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            RECT rcBtn = { 0 };</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            GetItemRect(nBtn, &amp;rcBtn);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            TBBUTTON tbb = { 0 };</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            GetButton(nBtn, &amp;tbb);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <span class="keywordflow">if</span>((tbb.fsState &amp; TBSTATE_ENABLED) != 0 &amp;&amp; (tbb.fsState &amp; TBSTATE_HIDDEN) == 0 &amp;&amp; rcBtn.right &lt;= rcClient.right)</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                PostMessage(WM_KEYDOWN, VK_DOWN, 0L);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <span class="keywordflow">if</span>(wParam != VK_RETURN)</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                    SetHotItem(nBtn);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                ::MessageBeep(0);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        }</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae6ed89205df0d001297b9e72341ce77e"> 1185</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae6ed89205df0d001297b9e72341ce77e">OnSysKeyDown</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnSysKeyDown\n&quot;</span>));</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7d7af86743a1f641c21e41246aff0fcd"> 1194</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7d7af86743a1f641c21e41246aff0fcd">OnSysKeyUp</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnSysKeyUp\n&quot;</span>));</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a9f74a78bbb8b5cf6b82f6304ef73d911"> 1203</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a9f74a78bbb8b5cf6b82f6304ef73d911">OnSysChar</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnSysChar\n&quot;</span>));</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab9fa460e48f6a1a64c96d70939f944c3"> 1212</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab9fa460e48f6a1a64c96d70939f944c3">OnEraseBackground</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">if</span>(m_bAttachedMenu || (m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a54def69e13b608d7681d597d1c4d0c00">CBR_EX_TRANSPARENT</a>))</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a> dc = (HDC)wParam;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        RECT rect = { 0 };</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        GetClientRect(&amp;rect);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rect, COLOR_MENU);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">return</span> 1;   <span class="comment">// don&#39;t do the default erase</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aadc48f87a42e8b6785e1f87a2fc47da7"> 1228</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aadc48f87a42e8b6785e1f87a2fc47da7">OnInitMenu</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="keywordtype">int</span> nIndex = GetHotItem();</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        SendMessage(WM_MENUSELECT, MAKEWPARAM(nIndex, MF_POPUP|MF_HILITE), (LPARAM)m_hMenu);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4e5cc2f251cb8671345ffa5aad1409ad"> 1236</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4e5cc2f251cb8671345ffa5aad1409ad">OnInitMenuPopup</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <span class="keywordflow">if</span>((<a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>)HIWORD(lParam))   <span class="comment">// System menu, do nothing</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keywordflow">if</span>(!(m_bAttachedMenu || m_bMenuActive))   <span class="comment">// Not attached or ours, do nothing</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnInitMenuPopup\n&quot;</span>));</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="comment">// forward to the parent or subclassed window, so it can handle update UI</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        LRESULT lRet = 0;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">if</span>(m_bAttachedMenu)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            lRet = DefWindowProc(uMsg, wParam, (lParam || m_bContextMenu) ? lParam : GetHotItem());</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            lRet = m_wndParent.DefWindowProc(uMsg, wParam, (lParam || m_bContextMenu) ? lParam : GetHotItem());</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="comment">// If Vista menus are active, just set bitmaps and return</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keywordflow">if</span>(m_bVistaMenus)</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> menu = (HMENU)wParam;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            ATLASSERT(menu.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">m_hMenu</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; menu.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#af66b7b895159a7c38d5b4d009f00f419">GetMenuItemCount</a>(); i++)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                WORD nID = (WORD)menu.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a5b0dbba42d4213b6535766a4b1fb83c1">GetMenuItemID</a>(i);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                <span class="keywordtype">int</span> nIndex = m_arrCommand.Find(nID);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> mii;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                mii.fMask = MIIM_BITMAP;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                mii.hbmpItem = (m_bImagesVisible &amp;&amp; (nIndex != -1)) ? m_arrVistaBitmap[nIndex] : <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                menu.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a8dfb6f30aeeb3658edd247f23ba9d0d2">SetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="comment">// Convert menu items to ownerdraw, add our data</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="keywordflow">if</span>(m_bImagesVisible)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> menuPopup = (HMENU)wParam;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            ATLASSERT(menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">m_hMenu</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            pT;   <span class="comment">// avoid level 4 warning</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            TCHAR szString[pT-&gt;_nMaxMenuItemTextLength];</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#af66b7b895159a7c38d5b4d009f00f419">GetMenuItemCount</a>(); i++)</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> mii;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                mii.cch = pT-&gt;_nMaxMenuItemTextLength;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                mii.fMask = MIIM_CHECKMARKS | MIIM_DATA | MIIM_ID | MIIM_STATE | MIIM_SUBMENU | MIIM_TYPE;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                mii.dwTypeData = szString;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                bRet = menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#ace9f3d87c46a807eebc59d84d1112c2e">GetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                ATLASSERT(bRet);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                <span class="keywordflow">if</span>(!(mii.fType &amp; MFT_OWNERDRAW))   <span class="comment">// Not already an ownerdraw item</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    mii.fMask = MIIM_DATA | MIIM_TYPE | MIIM_STATE;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                    <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pMI = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                    ATLTRY(pMI = <span class="keyword">new</span> <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                    ATLASSERT(pMI != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                    <span class="keywordflow">if</span>(pMI != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                    {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                        pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">fType</a> = mii.fType;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                        pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a067bd58dd35ee07dea81d0b4a4e144ca">fState</a> = mii.fState;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                        mii.fType |= MFT_OWNERDRAW;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                        pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#af89e777f3ec45bfe9b8dfadb60f5ca23">iButton</a> = -1;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; m_arrCommand.GetSize(); j++)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                        {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                            <span class="keywordflow">if</span>(m_arrCommand[j] == mii.wID)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                            {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#af89e777f3ec45bfe9b8dfadb60f5ca23">iButton</a> = j;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                            }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                        }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                        <span class="keywordtype">int</span> cchLen = lstrlen(szString) + 1;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                        pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a> = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                        ATLTRY(pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a> = <span class="keyword">new</span> TCHAR[cchLen]);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                        ATLASSERT(pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                        <span class="keywordflow">if</span>(pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                            <a class="code" href="namespace_w_t_l_1_1_secure_helper.html#a9e13a3c9cadbdec33c78c1f95d8ec053">SecureHelper::strcpy_x</a>(pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>, cchLen, szString);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                        mii.dwItemData = (<a class="code" href="atlapp_8h.html#ac87b166e5dce7fa7bf3fa6dee25e1c19">ULONG_PTR</a>)pMI;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                        bRet = menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a8dfb6f30aeeb3658edd247f23ba9d0d2">SetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        ATLASSERT(bRet);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                    }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            }</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="comment">// Add it to the list</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            m_stackMenuHandle.Push(menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">m_hMenu</a>);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5b4a83b8ab7e55ac2f149a5e6fedfa12"> 1341</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5b4a83b8ab7e55ac2f149a5e6fedfa12">OnMenuSelect</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordflow">if</span>(!m_bAttachedMenu)   <span class="comment">// Not attached, do nothing, forward to parent</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            m_bPopupItem = (lParam != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; ((HMENU)lParam != m_hMenu) &amp;&amp; (HIWORD(wParam) &amp; MF_POPUP);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            <span class="keywordflow">if</span>(m_wndParent.IsWindow())</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                m_wndParent.SendMessage(uMsg, wParam, lParam);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="comment">// Check if a menu is closing, do a cleanup</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="keywordflow">if</span>(HIWORD(wParam) == 0xFFFF &amp;&amp; lParam == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)   <span class="comment">// Menu closing</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnMenuSelect - CLOSING!!!!\n&quot;</span>));</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            ATLASSERT(m_stackMenuWnd.GetSize() == 0);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="comment">// Restore the menu items to the previous state for all menus that were converted</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            <span class="keywordflow">if</span>(m_bImagesVisible)</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                HMENU hMenu = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                <span class="keywordflow">while</span>((hMenu = m_stackMenuHandle.Pop()) != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                    <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> menuPopup = hMenu;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                    ATLASSERT(menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">m_hMenu</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                    <span class="comment">// Restore state and delete menu item data</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#af66b7b895159a7c38d5b4d009f00f419">GetMenuItemCount</a>(); i++)</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                    {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                        <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> mii;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        mii.fMask = MIIM_DATA | MIIM_TYPE;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                        bRet = menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#ace9f3d87c46a807eebc59d84d1112c2e">GetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                        ATLASSERT(bRet);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pMI = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)mii.dwItemData;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                        <span class="keywordflow">if</span>(pMI != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">IsCmdBarMenuItem</a>())</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                        {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                            mii.fMask = MIIM_DATA | MIIM_TYPE | MIIM_STATE;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                            mii.fType = pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">fType</a>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                            mii.dwTypeData = pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                            mii.cch = lstrlen(pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                            mii.dwItemData = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                            bRet = menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a8dfb6f30aeeb3658edd247f23ba9d0d2">SetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                            ATLASSERT(bRet);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                            <span class="keyword">delete</span> [] pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                            pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a404947e533a0851957a74ca22666743f">dwMagic</a> = 0x6666;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                            <span class="keyword">delete</span> pMI;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                        }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                    }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4583c41bd455b2310571a5dbbee2eefd"> 1401</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4583c41bd455b2310571a5dbbee2eefd">OnInternalAutoPopup</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordtype">int</span> nIndex = (<a class="code" href="namespacechecksum.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)wParam;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        pT-&gt;DoPopupMenu(nIndex, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4f1ac0cdb60cdd3b5e63329c2c603ebc"> 1409</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4f1ac0cdb60cdd3b5e63329c2c603ebc">OnInternalGetBar</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="comment">// Let&#39;s make sure we&#39;re not embedded in another process</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">if</span>((LPVOID)wParam != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            *((DWORD*)wParam) = GetCurrentProcessId();</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="keywordflow">if</span>(IsWindowVisible())</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            <span class="keywordflow">return</span> (LRESULT)<span class="keyword">static_cast&lt;</span><a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">CCommandBarCtrlBase</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    }</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#add0e6835e871886ea13e07dcce66f4b8"> 1420</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#add0e6835e871886ea13e07dcce66f4b8">OnSettingChange</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="preprocessor">#ifndef SPI_GETKEYBOARDCUES</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keyword">const</span> UINT SPI_SETKEYBOARDCUES = 0x100B;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !SPI_GETKEYBOARDCUES</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="preprocessor">#ifndef SPI_GETFLATMENU</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keyword">const</span> UINT SPI_SETFLATMENU = 0x1023;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !SPI_GETFLATMENU</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="keywordflow">if</span>(wParam == SPI_SETNONCLIENTMETRICS || wParam == SPI_SETKEYBOARDCUES || wParam == SPI_SETFLATMENU)</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            pT-&gt;GetSystemSettings();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6f2ab7e9292210333aa2b8c1638eb7fd"> 1438</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6f2ab7e9292210333aa2b8c1638eb7fd">OnWindowPosChanging</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        LPWINDOWPOS lpWP = (LPWINDOWPOS)lParam;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordtype">int</span> cyMin = ::GetSystemMetrics(SM_CYMENU);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="keywordflow">if</span>(lpWP-&gt;cy &lt; cyMin)</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        lpWP-&gt;cy = cyMin;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    }</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6fd52e40523fa7884f76f6426c243ccb"> 1450</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6fd52e40523fa7884f76f6426c243ccb">OnMenuChar</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - OnMenuChar\n&quot;</span>));</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        LRESULT lRet;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="keywordflow">if</span>(m_bMenuActive &amp;&amp; LOWORD(wParam) != 0x0D)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            lRet = 0;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            lRet = MAKELRESULT(1, 1);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keywordflow">if</span>(m_bMenuActive &amp;&amp; HIWORD(wParam) == MF_POPUP)</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            <span class="comment">// Convert character to lower/uppercase and possibly Unicode, using current keyboard layout</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            TCHAR ch = (TCHAR)LOWORD(wParam);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> menu = (HMENU)lParam;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            <span class="keywordtype">int</span> nCount = ::GetMenuItemCount(menu);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            <span class="keywordtype">int</span> nRetCode = MNC_EXECUTE;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            TCHAR szString[pT-&gt;_nMaxMenuItemTextLength];</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            WORD wMnem = 0;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="keywordtype">bool</span> bFound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nCount; i++)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> mii;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                mii.cch = pT-&gt;_nMaxMenuItemTextLength;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                mii.fMask = MIIM_CHECKMARKS | MIIM_DATA | MIIM_ID | MIIM_STATE | MIIM_SUBMENU | MIIM_TYPE;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                mii.dwTypeData = szString;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                bRet = menu.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#ace9f3d87c46a807eebc59d84d1112c2e">GetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                <span class="keywordflow">if</span>(!bRet || (mii.fType &amp; MFT_SEPARATOR))</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pmd = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)mii.dwItemData;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                <span class="keywordflow">if</span>(pmd != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">IsCmdBarMenuItem</a>())</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                    LPTSTR p = pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; </div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                    <span class="keywordflow">if</span>(p != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                    {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        <span class="keywordflow">while</span>(*p &amp;&amp; *p != _T(<span class="charliteral">&#39;&amp;&#39;</span>))</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                            p = ::CharNext(p);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                        <span class="keywordflow">if</span>(p != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; *p)</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                        {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                            DWORD dwP = MAKELONG(*(++p), 0);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                            DWORD dwC = MAKELONG(ch, 0);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                            <span class="keywordflow">if</span>(::CharLower((LPTSTR)<a class="code" href="atlapp_8h.html#a9dd065718edeaaebee8314152f8c45d2">ULongToPtr</a>(dwP)) == ::CharLower((LPTSTR)<a class="code" href="atlapp_8h.html#a9dd065718edeaaebee8314152f8c45d2">ULongToPtr</a>(dwC)))</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                            {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                <span class="keywordflow">if</span>(!bFound)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                                {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                    wMnem = (WORD)i;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                                    bFound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                                }</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                                {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                    nRetCode = MNC_SELECT;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                            }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                        }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    }</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="keywordflow">if</span>(bFound)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                <span class="keywordflow">if</span>(nRetCode == MNC_EXECUTE)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                    PostMessage(TB_SETHOTITEM, (WPARAM)-1, 0L);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                    pT-&gt;GiveFocusBack();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                lRet = MAKELRESULT(wMnem, nRetCode);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        } </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!m_bMenuActive)</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <span class="keywordtype">int</span> nBtn = 0;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="keywordflow">if</span>(!MapAccelerator((TCHAR)LOWORD(wParam), nBtn))</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                PostMessage(TB_SETHOTITEM, (WPARAM)-1, 0L);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                pT-&gt;GiveFocusBack();</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                <span class="comment">// check if we should display chevron menu</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                <span class="keywordflow">if</span>((TCHAR)LOWORD(wParam) == pT-&gt;_chChevronShortcut)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                    <span class="keywordflow">if</span>(pT-&gt;DisplayChevronMenu())</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                        bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(m_wndParent.IsWindowEnabled())</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                RECT rcClient = { 0 };</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                GetClientRect(&amp;rcClient);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                RECT rcBtn = { 0 };</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                GetItemRect(nBtn, &amp;rcBtn);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                TBBUTTON tbb = { 0 };</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                GetButton(nBtn, &amp;tbb);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                <span class="keywordflow">if</span>((tbb.fsState &amp; TBSTATE_ENABLED) != 0 &amp;&amp; (tbb.fsState &amp; TBSTATE_HIDDEN) == 0 &amp;&amp; rcBtn.right &lt;= rcClient.right)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                    <span class="keywordflow">if</span>(m_bUseKeyboardCues &amp;&amp; !m_bShowKeyboardCues)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                    {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                        m_bAllowKeyboardCues = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                        ShowKeyboardCues(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                    }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                    pT-&gt;TakeFocus();</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                    PostMessage(WM_KEYDOWN, VK_DOWN, 0L);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                    SetHotItem(nBtn);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                    ::MessageBeep(0);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af8c6308ccb6f8a590b187aa34b0cbce8"> 1576</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af8c6308ccb6f8a590b187aa34b0cbce8">OnDrawItem</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        LPDRAWITEMSTRUCT lpDrawItemStruct = (LPDRAWITEMSTRUCT)lParam;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pmd = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)lpDrawItemStruct-&gt;itemData;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="keywordflow">if</span>(lpDrawItemStruct-&gt;CtlType == ODT_MENU &amp;&amp; pmd != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">IsCmdBarMenuItem</a>())</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            pT-&gt;DrawItem(lpDrawItemStruct);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="keywordflow">return</span> (LRESULT)<a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7bad7e49859b9fbe7c5f1ec2b98db78c"> 1592</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7bad7e49859b9fbe7c5f1ec2b98db78c">OnMeasureItem</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        LPMEASUREITEMSTRUCT lpMeasureItemStruct = (LPMEASUREITEMSTRUCT)lParam;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pmd = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)lpMeasureItemStruct-&gt;itemData;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordflow">if</span>(lpMeasureItemStruct-&gt;CtlType == ODT_MENU &amp;&amp; pmd != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">IsCmdBarMenuItem</a>())</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            pT-&gt;MeasureItem(lpMeasureItemStruct);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        }</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordflow">return</span> (LRESULT)<a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">// API message handlers</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa1b70e1a6f04795a2a82408b2dc97132"> 1609</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa1b70e1a6f04795a2a82408b2dc97132">OnAPIGetMenu</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="keywordflow">return</span> (LRESULT)m_hMenu;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a702cf8351bf4aeee8d211d9b55ffdfa9"> 1614</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a702cf8351bf4aeee8d211d9b55ffdfa9">OnAPITrackPopupMenu</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">if</span>(lParam == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        <a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html">LPCBRPOPUPMENU</a> lpCBRPopupMenu = (<a class="code" href="namespace_w_t_l.html#a826b6edc328de072f358d7651558bd83">LPCBRPOPUPMENU</a>)lParam;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <span class="keywordflow">if</span>(lpCBRPopupMenu-&gt;<a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#aca985e741a1f45d7adae9557cfb839bf">cbSize</a> != <span class="keyword">sizeof</span>(<a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html">CBRPOPUPMENU</a>))</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        <span class="keywordflow">return</span> pT-&gt;TrackPopupMenu(lpCBRPopupMenu-&gt;<a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a309bf8d531939eba86ac4913eb0863d5">hMenu</a>, lpCBRPopupMenu-&gt;<a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a8890d0b8feaf1a70277a101527554974">uFlags</a>, lpCBRPopupMenu-&gt;<a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, lpCBRPopupMenu-&gt;<a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>, lpCBRPopupMenu-&gt;<a class="code" href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#adb9dba29c4be89f78a9be54f7f0d1185">lptpm</a>);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acf34e95c733e73c7b0a35691c7323d9a"> 1626</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acf34e95c733e73c7b0a35691c7323d9a">OnAPIGetCmdBar</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="keywordflow">return</span> (LRESULT)m_hWnd;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">// Parent window message handlers</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa35516b84b7be6e0d6c9c8154d6bdd3e"> 1632</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa35516b84b7be6e0d6c9c8154d6bdd3e">OnParentHotItemChange</a>(<span class="keywordtype">int</span> <span class="comment">/*idCtrl*/</span>, LPNMHDR pnmh, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        LPNMTBHOTITEM lpNMHT = (LPNMTBHOTITEM)pnmh;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="comment">// Check if this comes from us</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keywordflow">if</span>(pnmh-&gt;hwndFrom != m_hWnd)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <span class="keywordtype">bool</span> bBlockTracking = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        <span class="keywordflow">if</span>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#adad1bf70b2ae18b73473f537f35534e0">CBR_EX_TRACKALWAYS</a>) == 0)</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            DWORD dwProcessID;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            ::GetWindowThreadProcessId(::GetActiveWindow(), &amp;dwProcessID);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            bBlockTracking = (::GetCurrentProcessId() != dwProcessID);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <span class="keywordflow">if</span>((!m_wndParent.IsWindowEnabled() || bBlockTracking) &amp;&amp; (lpNMHT-&gt;dwFlags &amp; HICF_MOUSE))</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        {</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="preprocessor">#ifndef HICF_LMOUSE</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            <span class="keyword">const</span> DWORD HICF_LMOUSE = 0x00000080;   <span class="comment">// left mouse button selected</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="comment">// Send WM_MENUSELECT to the app if it needs to display a status text</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="keywordflow">if</span>(!(lpNMHT-&gt;dwFlags &amp; HICF_MOUSE)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                &amp;&amp; !(lpNMHT-&gt;dwFlags &amp; HICF_ACCELERATOR)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                &amp;&amp; !(lpNMHT-&gt;dwFlags &amp; HICF_LMOUSE))</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                <span class="keywordflow">if</span>(lpNMHT-&gt;dwFlags &amp; HICF_ENTERING)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    m_wndParent.SendMessage(WM_MENUSELECT, 0, (LPARAM)m_hMenu);</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                <span class="keywordflow">if</span>(lpNMHT-&gt;dwFlags &amp; HICF_LEAVING)</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                    m_wndParent.SendMessage(WM_MENUSELECT, MAKEWPARAM(0, 0xFFFF), <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01677"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ac002aa8c87a56599532a99fbfa209435"> 1677</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ac002aa8c87a56599532a99fbfa209435">OnParentDropDown</a>(<span class="keywordtype">int</span> <span class="comment">/*idCtrl*/</span>, LPNMHDR pnmh, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <span class="comment">// Check if this comes from us</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="keywordflow">if</span>(pnmh-&gt;hwndFrom != m_hWnd)</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        }</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <span class="keywordflow">if</span>(::GetFocus() != m_hWnd)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            pT-&gt;TakeFocus();</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        LPNMTOOLBAR pNMToolBar = (LPNMTOOLBAR)pnmh;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="keywordtype">int</span> nIndex = CommandToIndex(pNMToolBar-&gt;iItem);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        m_bContextMenu = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        m_bEscapePressed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        pT-&gt;DoPopupMenu(nIndex, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        <span class="keywordflow">return</span> TBDDRET_DEFAULT;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    }</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a8c22b6e00cf3703ef4ca5c50e8b44378"> 1698</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a8c22b6e00cf3703ef4ca5c50e8b44378">OnParentInitMenuPopup</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">return</span> OnInitMenuPopup(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    }</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa583075d559bcc458862bab0dc15f25a"> 1703</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa583075d559bcc458862bab0dc15f25a">OnParentInternalGetBar</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keywordflow">return</span> OnInternalGetBar(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a766e57d4ec8002337fede01a0a1f98cb"> 1708</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a766e57d4ec8002337fede01a0a1f98cb">OnParentSysCommand</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="keywordflow">if</span>((m_uSysKey == VK_MENU </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            || (m_uSysKey == VK_F10 &amp;&amp; !(::GetKeyState(VK_SHIFT) &amp; 0x80))</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            || m_uSysKey == VK_SPACE) </div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            &amp;&amp; wParam == SC_KEYMENU)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            <span class="keywordflow">if</span>(::GetFocus() == m_hWnd)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                pT-&gt;GiveFocusBack();   <span class="comment">// exit menu &quot;loop&quot;</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                PostMessage(TB_SETHOTITEM, (WPARAM)-1, 0L);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            }</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(m_uSysKey != VK_SPACE &amp;&amp; !m_bSkipMsg)</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                <span class="keywordflow">if</span>(m_bUseKeyboardCues &amp;&amp; !m_bShowKeyboardCues &amp;&amp; m_bAllowKeyboardCues)</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                    ShowKeyboardCues(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                pT-&gt;TakeFocus();      <span class="comment">// enter menu &quot;loop&quot;</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(m_uSysKey != VK_SPACE)</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        m_bSkipMsg = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a12bd71e596184911764666b4bba34485"> 1739</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a12bd71e596184911764666b4bba34485">OnParentAPIGetMenu</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="keywordflow">return</span> OnAPIGetMenu(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; </div>
<div class="line"><a name="l01744"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ea0356b72b43ae9a74fe049f88fabf1"> 1744</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ea0356b72b43ae9a74fe049f88fabf1">OnParentMenuChar</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="keywordflow">return</span> OnMenuChar(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae7ad31a9ff0c5c4c94ee959dd48b3fda"> 1749</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae7ad31a9ff0c5c4c94ee959dd48b3fda">OnParentAPITrackPopupMenu</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <span class="keywordflow">return</span> OnAPITrackPopupMenu(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a97a2439f40c59bb40355e6fe98331747"> 1754</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a97a2439f40c59bb40355e6fe98331747">OnParentAPIGetCmdBar</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <span class="keywordflow">return</span> OnAPIGetCmdBar(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; </div>
<div class="line"><a name="l01759"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aebf660879b6233daeffde59bf54a7551"> 1759</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aebf660879b6233daeffde59bf54a7551">OnParentSettingChange</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        OnSettingChange(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1142c62f030c8241631814c0f4918231"> 1766</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1142c62f030c8241631814c0f4918231">OnParentDrawItem</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <span class="keywordflow">return</span> OnDrawItem(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    }</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a95770b97d856573d191977d1a52b0347"> 1771</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a95770b97d856573d191977d1a52b0347">OnParentMeasureItem</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <span class="keywordflow">return</span> OnMeasureItem(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad671ad82988ee3200c0ae6f57cd54257"> 1776</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad671ad82988ee3200c0ae6f57cd54257">OnParentActivate</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        m_bParentActive = (LOWORD(wParam) != WA_INACTIVE);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="keywordflow">if</span>(!m_bParentActive &amp;&amp; m_bUseKeyboardCues &amp;&amp; m_bShowKeyboardCues)</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            ShowKeyboardCues(<span class="keyword">false</span>);   <span class="comment">// this will repaint our window</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            Invalidate();</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            UpdateWindow();</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b03bba91a098c972d0a2fe33d536426"> 1792</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b03bba91a098c972d0a2fe33d536426">OnParentCustomDraw</a>(<span class="keywordtype">int</span> <span class="comment">/*idCtrl*/</span>, LPNMHDR pnmh, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        LRESULT lRet = CDRF_DODEFAULT;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <span class="keywordflow">if</span>(pnmh-&gt;hwndFrom == m_hWnd)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            LPNMTBCUSTOMDRAW lpTBCustomDraw = (LPNMTBCUSTOMDRAW)pnmh;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            <span class="keywordflow">if</span>(lpTBCustomDraw-&gt;nmcd.dwDrawStage == CDDS_PREPAINT)</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                lRet = CDRF_NOTIFYITEMDRAW;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(lpTBCustomDraw-&gt;nmcd.dwDrawStage == CDDS_ITEMPREPAINT)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;            {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                <span class="keywordflow">if</span>(m_bFlatMenus)</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="preprocessor">#ifndef COLOR_MENUHILIGHT</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> COLOR_MENUHILIGHT = 29;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !COLOR_MENUHILIGHT</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                    <span class="keywordtype">bool</span> bDisabled = ((lpTBCustomDraw-&gt;nmcd.uItemState &amp; CDIS_DISABLED) == CDIS_DISABLED);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                    <span class="keywordflow">if</span>(!bDisabled &amp;&amp; ((lpTBCustomDraw-&gt;nmcd.uItemState &amp; CDIS_HOT) == CDIS_HOT || </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                        (lpTBCustomDraw-&gt;nmcd.uItemState &amp; CDIS_SELECTED) == CDIS_SELECTED))</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                    {</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;                        ::FillRect(lpTBCustomDraw-&gt;nmcd.hdc, &amp;lpTBCustomDraw-&gt;nmcd.rc, ::GetSysColorBrush(COLOR_MENUHILIGHT));</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                        ::FrameRect(lpTBCustomDraw-&gt;nmcd.hdc, &amp;lpTBCustomDraw-&gt;nmcd.rc, ::GetSysColorBrush(COLOR_HIGHLIGHT));</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                        lpTBCustomDraw-&gt;clrText = ::GetSysColor(m_bParentActive ? COLOR_HIGHLIGHTTEXT : COLOR_GRAYTEXT);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                    }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(bDisabled || !m_bParentActive)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                    {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                        lpTBCustomDraw-&gt;clrText = ::GetSysColor(COLOR_GRAYTEXT);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                    }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                    <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a> dc = lpTBCustomDraw-&gt;nmcd.hdc;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                    dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">SetTextColor</a>(lpTBCustomDraw-&gt;clrText);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                    dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a54f653692e2fcad6b7670ba051d6ccc8">SetBkMode</a>(lpTBCustomDraw-&gt;nStringBkMode);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                    HFONT hFont = GetFont();</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                    HFONT hFontOld = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                    <span class="keywordflow">if</span>(hFont != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                        hFontOld = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">SelectFont</a>(hFont);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> cchText = 200;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                    TCHAR szText[cchText] = { 0 };</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                    TBBUTTONINFO tbbi = { 0 };</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                    tbbi.cbSize = <span class="keyword">sizeof</span>(TBBUTTONINFO);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                    tbbi.dwMask = TBIF_TEXT;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                    tbbi.pszText = szText;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                    tbbi.cchText = cchText;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                    GetButtonInfo((<span class="keywordtype">int</span>)lpTBCustomDraw-&gt;nmcd.dwItemSpec, &amp;tbbi);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                    dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2871d067a4a5d219d6d08a8f9321c404">DrawText</a>(szText, -1, &amp;lpTBCustomDraw-&gt;nmcd.rc, DT_SINGLELINE | DT_CENTER | DT_VCENTER | (m_bShowKeyboardCues ? 0 : DT_HIDEPREFIX));</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                    <span class="keywordflow">if</span>(hFont != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">SelectFont</a>(hFontOld);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                    lRet = CDRF_SKIPDEFAULT;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                    bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                }</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!m_bParentActive)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                    lpTBCustomDraw-&gt;clrText = ::GetSysColor(COLOR_GRAYTEXT);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                    bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">// Message hook handlers</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a76ffab37a62c378cb8b5d9aa826ea778"> 1855</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a76ffab37a62c378cb8b5d9aa826ea778">OnHookMouseMove</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keyword">static</span> POINT s_point = { -1, -1 };</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        DWORD dwPoint = ::GetMessagePos();</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        POINT point = { <a class="code" href="atlapp_8h.html#ac503b7bea1053172cf5044a25c266f9a">GET_X_LPARAM</a>(dwPoint), <a class="code" href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a>(dwPoint) };</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="keywordflow">if</span>(m_bMenuActive)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            <span class="keywordflow">if</span>(::WindowFromPoint(point) == m_hWnd)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                ScreenToClient(&amp;point);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                <span class="keywordtype">int</span> nHit = HitTest(&amp;point);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                <span class="keywordflow">if</span>((point.x != s_point.x || point.y != s_point.y) &amp;&amp; nHit &gt;= 0 &amp;&amp; nHit &lt; ::GetMenuItemCount(m_hMenu) &amp;&amp; nHit != m_nPopBtn &amp;&amp; m_nPopBtn != -1)</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                {</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                    TBBUTTON tbb = { 0 };</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                    GetButton(nHit, &amp;tbb);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                    <span class="keywordflow">if</span>((tbb.fsState &amp; TBSTATE_ENABLED) != 0)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                    {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                        m_nNextPopBtn = nHit | 0xFFFF0000;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                        HWND hWndMenu = m_stackMenuWnd.GetCurrent();</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                        ATLASSERT(hWndMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                        <span class="comment">// this one is needed to close a menu if mouse button was down</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                        ::PostMessage(hWndMenu, WM_LBUTTONUP, 0, MAKELPARAM(point.x, point.y));</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                        <span class="comment">// this one closes a popup menu</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                        ::PostMessage(hWndMenu, WM_KEYDOWN, VK_ESCAPE, 0L);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                        bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                    }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            }</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            ScreenToClient(&amp;point);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        }</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        s_point = point;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b5dd15017a630d7858efd971390a7c4"> 1898</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b5dd15017a630d7858efd971390a7c4">OnHookSysKeyDown</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Hook WM_SYSKEYDOWN (0x%2.2X)\n&quot;</span>), wParam);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <span class="keywordflow">if</span>(wParam == VK_MENU &amp;&amp; m_bParentActive &amp;&amp; m_bUseKeyboardCues &amp;&amp; !m_bShowKeyboardCues &amp;&amp; m_bAllowKeyboardCues)</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            ShowKeyboardCues(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="keywordflow">if</span>(wParam != VK_SPACE &amp;&amp; !m_bMenuActive &amp;&amp; ::GetFocus() == m_hWnd)</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            m_bAllowKeyboardCues = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            PostMessage(TB_SETHOTITEM, (WPARAM)-1, 0L);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            pT-&gt;GiveFocusBack();</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            m_bSkipMsg = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        }</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        {</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;            <span class="keywordflow">if</span>(wParam == VK_SPACE &amp;&amp; m_bUseKeyboardCues &amp;&amp; m_bShowKeyboardCues)</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            {</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                m_bAllowKeyboardCues = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                ShowKeyboardCues(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;            }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            m_uSysKey = (UINT)wParam;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        }</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    }</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; </div>
<div class="line"><a name="l01928"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4c0f9b682a04c6d608a437b43c3fab52"> 1928</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4c0f9b682a04c6d608a437b43c3fab52">OnHookSysKeyUp</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    {</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keywordflow">if</span>(!m_bAllowKeyboardCues)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;            m_bAllowKeyboardCues = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        wParam;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Hook WM_SYSKEYUP (0x%2.2X)\n&quot;</span>), wParam);</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a404a39c408dc077f7d526f98bc17488a"> 1940</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a404a39c408dc077f7d526f98bc17488a">OnHookSysChar</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Hook WM_SYSCHAR (0x%2.2X)\n&quot;</span>), wParam);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">if</span>(!m_bMenuActive &amp;&amp; m_hWndHook != m_hWnd &amp;&amp; wParam != VK_SPACE)</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; </div>
<div class="line"><a name="l01952"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a67faa81ecddd180b8983b3a9dea84c7f"> 1952</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a67faa81ecddd180b8983b3a9dea84c7f">OnHookKeyDown</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    {</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Hook WM_KEYDOWN (0x%2.2X)\n&quot;</span>), wParam);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        <span class="keywordflow">if</span>(wParam == VK_ESCAPE &amp;&amp; m_stackMenuWnd.GetSize() &lt;= 1)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        {</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="keywordflow">if</span>(m_bMenuActive &amp;&amp; !m_bContextMenu)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                <span class="keywordtype">int</span> nHot = GetHotItem();</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                <span class="keywordflow">if</span>(nHot == -1)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                    nHot = m_nPopBtn;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                <span class="keywordflow">if</span>(nHot == -1)</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                    nHot = 0;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                SetHotItem(nHot);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                pT-&gt;TakeFocus();</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                m_bEscapePressed = <span class="keyword">true</span>; <span class="comment">// To keep focus</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                m_bSkipPostDown = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(::GetFocus() == m_hWnd &amp;&amp; m_wndParent.IsWindow())</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                SetHotItem(-1);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                pT-&gt;GiveFocusBack();</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            }</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(wParam == VK_RETURN || wParam == VK_UP || wParam == VK_DOWN)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            <span class="keywordflow">if</span>(!m_bMenuActive &amp;&amp; ::GetFocus() == m_hWnd &amp;&amp; m_wndParent.IsWindow())</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                <span class="keywordtype">int</span> nHot = GetHotItem();</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                <span class="keywordflow">if</span>(nHot != -1)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                    <span class="keywordflow">if</span>(wParam != VK_RETURN)</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                    {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                        <span class="keywordflow">if</span>(!m_bSkipPostDown)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                        {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">// IE4 only: WM_KEYDOWN doesn&#39;t generate TBN_DROPDOWN, we need to simulate a mouse click</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="preprocessor">#if (_WIN32_IE &lt; 0x0500)</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                            DWORD dwMajor = 0, dwMinor = 0;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                            ATL::AtlGetCommCtrlVersion(&amp;dwMajor, &amp;dwMinor);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                            <span class="keywordflow">if</span>(dwMajor &lt;= 4 || (dwMajor == 5 &amp;&amp; dwMinor &lt; 80))</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                            {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                                RECT rect;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                                GetItemRect(nHot, &amp;rect);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                                PostMessage(WM_LBUTTONDOWN, MK_LBUTTON, MAKELPARAM(rect.left, rect.top));</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                            }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &lt; 0x0500)</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                            PostMessage(WM_KEYDOWN, VK_DOWN, 0L);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                            m_bSkipPostDown = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                        }</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                        {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - skipping posting another VK_DOWN\n&quot;</span>));</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                            m_bSkipPostDown = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                        }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                    }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                {</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                    ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Can&#39;t find hot button\n&quot;</span>));</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            <span class="keywordflow">if</span>(wParam == VK_RETURN &amp;&amp; m_bMenuActive)</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                PostMessage(TB_SETHOTITEM, (WPARAM)-1, 0L);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                m_nNextPopBtn = -1;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                pT-&gt;GiveFocusBack();</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            }</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(wParam == VK_LEFT || wParam == VK_RIGHT)</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            WPARAM wpNext = m_bLayoutRTL ? VK_LEFT : VK_RIGHT;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            WPARAM wpPrev = m_bLayoutRTL ? VK_RIGHT : VK_LEFT;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            <span class="keywordflow">if</span>(m_bMenuActive &amp;&amp; !m_bContextMenu &amp;&amp; !(wParam == wpNext &amp;&amp; m_bPopupItem))</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                <span class="keywordtype">bool</span> bAction = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                <span class="keywordflow">if</span>(wParam == wpPrev &amp;&amp; s_pCurrentBar-&gt;m_stackMenuWnd.GetSize() == 1)</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                {</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                    m_nNextPopBtn = pT-&gt;GetPreviousMenuItem(m_nPopBtn);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                    <span class="keywordflow">if</span>(m_nNextPopBtn != -1)</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                        bAction = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(wParam == wpNext)</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                    m_nNextPopBtn = pT-&gt;GetNextMenuItem(m_nPopBtn);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                    <span class="keywordflow">if</span>(m_nNextPopBtn != -1)</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                        bAction = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                HWND hWndMenu = m_stackMenuWnd.GetCurrent();</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                ATLASSERT(hWndMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                <span class="comment">// Close the popup menu</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                <span class="keywordflow">if</span>(bAction)</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                {</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                    ::PostMessage(hWndMenu, WM_KEYDOWN, VK_ESCAPE, 0L);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                    <span class="keywordflow">if</span>(wParam == wpNext)</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                    {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                        <span class="keywordtype">int</span> cItem = m_stackMenuWnd.GetSize() - 1;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                        <span class="keywordflow">while</span>(cItem &gt;= 0)</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                        {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                            hWndMenu = m_stackMenuWnd[cItem];</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                            <span class="keywordflow">if</span>(hWndMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                                ::PostMessage(hWndMenu, WM_KEYDOWN, VK_ESCAPE, 0L);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                            cItem--;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                    }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                    <span class="keywordflow">if</span>(m_nNextPopBtn == -2)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                    {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                        m_nNextPopBtn = -1;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                        pT-&gt;DisplayChevronMenu();</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                    }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                    bHandled = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                }</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            }</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        }</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab6db3026a4c896dc7e4990fa1f8d9694"> 2078</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab6db3026a4c896dc7e4990fa1f8d9694">OnHookNextMenu</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Hook WM_NEXTMENU\n&quot;</span>));</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    }</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; </div>
<div class="line"><a name="l02087"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa6ac97b5a2d4c1b61cb90d14c039fce3"> 2087</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa6ac97b5a2d4c1b61cb90d14c039fce3">OnHookChar</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Hook WM_CHAR (0x%2.2X)\n&quot;</span>), wParam);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        bHandled = (wParam == VK_ESCAPE);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment">// Implementation - ownerdraw overrideables and helpers</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab8ca9d6d0f62c6e136266c00be00d130"> 2097</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab8ca9d6d0f62c6e136266c00be00d130">DrawItem</a>(LPDRAWITEMSTRUCT lpDrawItemStruct)</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        <span class="keywordflow">if</span>(m_bFlatMenus)</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            pT-&gt;DrawItemFlat(lpDrawItemStruct);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            pT-&gt;DrawItem3D(lpDrawItemStruct);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    }</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; </div>
<div class="line"><a name="l02107"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6e41e47d2fff2118307a530137c0363f"> 2107</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6e41e47d2fff2118307a530137c0363f">DrawItem3D</a>(LPDRAWITEMSTRUCT lpDrawItemStruct)</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    {</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pmd = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)lpDrawItemStruct-&gt;itemData;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a> dc = lpDrawItemStruct-&gt;hDC;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        <span class="keyword">const</span> RECT&amp; rcItem = lpDrawItemStruct-&gt;rcItem;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160; </div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="keywordflow">if</span>(pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">fType</a> &amp; MFT_SEPARATOR)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        {</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <span class="comment">// draw separator</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;            RECT rc = rcItem;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            rc.top += (rc.bottom - rc.top) / 2;      <span class="comment">// vertical center</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a19ee2697138e6b4a73c1bf32587f4a81">DrawEdge</a>(&amp;rc, EDGE_ETCHED, BF_TOP);   <span class="comment">// draw separator line</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        <span class="keywordflow">else</span>        <span class="comment">// not a separator</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bDisabled = lpDrawItemStruct-&gt;itemState &amp; ODS_GRAYED;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bSelected = lpDrawItemStruct-&gt;itemState &amp; ODS_SELECTED;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bChecked = lpDrawItemStruct-&gt;itemState &amp; ODS_CHECKED;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bHasImage = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <span class="keywordflow">if</span>(LOWORD(lpDrawItemStruct-&gt;itemID) == (WORD)-1)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                bSelected = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            RECT rcButn = { rcItem.left, rcItem.top, rcItem.left + m_szButton.cx, rcItem.top + m_szButton.cy };   <span class="comment">// button rect</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            ::OffsetRect(&amp;rcButn, 0, ((rcItem.bottom - rcItem.top) - (rcButn.bottom - rcButn.top)) / 2);          <span class="comment">// center vertically</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            <span class="keywordtype">int</span> iButton = pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#af89e777f3ec45bfe9b8dfadb60f5ca23">iButton</a>;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            <span class="keywordflow">if</span>(iButton &gt;= 0)</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                bHasImage = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                <span class="comment">// calc drawing point</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                SIZE sz = { rcButn.right - rcButn.left - m_szBitmap.cx, rcButn.bottom - rcButn.top - m_szBitmap.cy };</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                sz.cx /= 2;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                sz.cy /= 2;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                POINT point = { rcButn.left + sz.cx, rcButn.top + sz.cy };</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                <span class="comment">// fill background depending on state</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                <span class="keywordflow">if</span>(!bChecked || (bSelected &amp;&amp; !bDisabled))</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                    <span class="keywordflow">if</span>(!bDisabled)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                        dc.FillRect(&amp;rcButn, (bChecked &amp;&amp; !bSelected) ? COLOR_3DLIGHT : COLOR_MENU);</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                        dc.FillRect(&amp;rcButn, COLOR_MENU);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                {</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                    COLORREF crTxt = dc.SetTextColor(::GetSysColor(COLOR_BTNFACE));</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                    COLORREF crBk = dc.SetBkColor(::GetSysColor(COLOR_BTNHILIGHT));</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                    <a class="code" href="class_w_t_l_1_1_c_brush_t.html">CBrush</a> hbr(<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a06c487f47dcf690b00e11f49871e3ad2">CDCHandle::GetHalftoneBrush</a>());</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                    dc.SetBrushOrg(rcButn.left, rcButn.top);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                    dc.FillRect(&amp;rcButn, hbr);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                    dc.SetTextColor(crTxt);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                    dc.SetBkColor(crBk);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                <span class="comment">// draw disabled or normal</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                <span class="keywordflow">if</span>(!bDisabled)</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                    <span class="comment">// draw pushed-in or popped-out edge</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                    <span class="keywordflow">if</span>(bSelected || bChecked)</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                    {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                        RECT rc2 = rcButn;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                        dc.DrawEdge(&amp;rc2, bChecked ? BDR_SUNKENOUTER : BDR_RAISEDINNER, BF_RECT);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                    }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                    <span class="comment">// draw the image</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                    ::ImageList_Draw(m_hImageList, iButton, dc, point.x, point.y, ILD_TRANSPARENT);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                    HBRUSH hBrushBackground = bChecked ? <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> : ::GetSysColorBrush(COLOR_MENU);</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                    pT-&gt;DrawBitmapDisabled(dc, iButton, point, hBrushBackground);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                }</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;            }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;            {</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                <span class="comment">// no image - look for custom checked/unchecked bitmaps</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> info;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                info.fMask = MIIM_CHECKMARKS | MIIM_TYPE;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                ::GetMenuItemInfo((HMENU)lpDrawItemStruct-&gt;hwndItem, lpDrawItemStruct-&gt;itemID, MF_BYCOMMAND, &amp;info);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                <span class="keywordflow">if</span>(bChecked || info.hbmpUnchecked != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                {</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRadio = ((info.fType &amp; MFT_RADIOCHECK) != 0);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                    bHasImage = pT-&gt;DrawCheckmark(dc, rcButn, bSelected, bDisabled, bRadio, bChecked ? info.hbmpChecked : info.hbmpUnchecked);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            }</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <span class="comment">// draw item text</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            <span class="keywordtype">int</span> cxButn = m_szButton.cx;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            COLORREF colorBG = ::GetSysColor(bSelected ? COLOR_HIGHLIGHT : COLOR_MENU);</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            <span class="keywordflow">if</span>(bSelected || lpDrawItemStruct-&gt;itemAction == ODA_SELECT)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                RECT rcBG = rcItem;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                <span class="keywordflow">if</span>(bHasImage)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                    rcBG.left += cxButn + s_kcxGap;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                dc.FillRect(&amp;rcBG, bSelected ? COLOR_HIGHLIGHT : COLOR_MENU);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            <span class="comment">// calc text rectangle and colors</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            RECT rcText = rcItem;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            rcText.left += cxButn + s_kcxGap + s_kcxTextMargin;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;            rcText.right -= cxButn;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            dc.SetBkMode(TRANSPARENT);</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            COLORREF colorText = ::GetSysColor(bDisabled ?  (bSelected ? COLOR_GRAYTEXT : COLOR_3DSHADOW) : (bSelected ? COLOR_HIGHLIGHTTEXT : COLOR_MENUTEXT));</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            <span class="comment">// font already selected by Windows</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            <span class="keywordflow">if</span>(bDisabled &amp;&amp; (!bSelected || colorText == colorBG))</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                <span class="comment">// disabled - draw shadow text shifted down and right 1 pixel (unles selected)</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                RECT rcDisabled = rcText;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                ::OffsetRect(&amp;rcDisabled, 1, 1);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                pT-&gt;DrawMenuText(dc, rcDisabled, pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>, ::GetSysColor(COLOR_3DHILIGHT));</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            pT-&gt;DrawMenuText(dc, rcText, pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>, colorText); <span class="comment">// finally!</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    }</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2ef99aeaa9138e216014841fb708f97a"> 2224</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2ef99aeaa9138e216014841fb708f97a">DrawItemFlat</a>(LPDRAWITEMSTRUCT lpDrawItemStruct)</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pmd = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)lpDrawItemStruct-&gt;itemData;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a> dc = lpDrawItemStruct-&gt;hDC;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <span class="keyword">const</span> RECT&amp; rcItem = lpDrawItemStruct-&gt;rcItem;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="preprocessor">#ifndef COLOR_MENUHILIGHT</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> COLOR_MENUHILIGHT = 29;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !COLOR_MENUHILIGHT</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bDisabled = lpDrawItemStruct-&gt;itemState &amp; ODS_GRAYED;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bSelected = lpDrawItemStruct-&gt;itemState &amp; ODS_SELECTED;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bChecked = lpDrawItemStruct-&gt;itemState &amp; ODS_CHECKED;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <span class="comment">// paint background</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <span class="keywordflow">if</span>(bSelected || lpDrawItemStruct-&gt;itemAction == ODA_SELECT)</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            <span class="keywordflow">if</span>(bSelected)</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rcItem, ::GetSysColorBrush(COLOR_MENUHILIGHT));</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                dc.FrameRect(&amp;rcItem, ::GetSysColorBrush(COLOR_HIGHLIGHT));</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                dc.FillRect(&amp;rcItem, ::GetSysColorBrush(COLOR_MENU));</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        }</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; </div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        <span class="keywordflow">if</span>(pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">fType</a> &amp; MFT_SEPARATOR)</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            <span class="comment">// draw separator</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;            RECT rc = rcItem;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            rc.top += (rc.bottom - rc.top) / 2;      <span class="comment">// vertical center</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;            dc.DrawEdge(&amp;rc, EDGE_ETCHED, BF_TOP);   <span class="comment">// draw separator line</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        }</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordflow">else</span>        <span class="comment">// not a separator</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        {</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;            <span class="keywordflow">if</span>(LOWORD(lpDrawItemStruct-&gt;itemID) == (WORD)-1)</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                bSelected = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            RECT rcButn = { rcItem.left, rcItem.top, rcItem.left + m_szButton.cx, rcItem.top + m_szButton.cy };   <span class="comment">// button rect</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;            ::OffsetRect(&amp;rcButn, 0, ((rcItem.bottom - rcItem.top) - (rcButn.bottom - rcButn.top)) / 2);          <span class="comment">// center vertically</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            <span class="comment">// draw background and border for checked items</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;            <span class="keywordflow">if</span>(bChecked)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                RECT rcCheck = rcButn;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                ::InflateRect(&amp;rcCheck, -1, -1);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                <span class="keywordflow">if</span>(bSelected)</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                    dc.FillRect(&amp;rcCheck, ::GetSysColorBrush(COLOR_MENU));</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                dc.FrameRect(&amp;rcCheck, ::GetSysColorBrush(COLOR_HIGHLIGHT));</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            <span class="keywordtype">int</span> iButton = pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#af89e777f3ec45bfe9b8dfadb60f5ca23">iButton</a>;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            <span class="keywordflow">if</span>(iButton &gt;= 0)</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                <span class="comment">// calc drawing point</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                SIZE sz = { rcButn.right - rcButn.left - m_szBitmap.cx, rcButn.bottom - rcButn.top - m_szBitmap.cy };</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                sz.cx /= 2;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                sz.cy /= 2;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                POINT point = { rcButn.left + sz.cx, rcButn.top + sz.cy };</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                <span class="comment">// draw disabled or normal</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                <span class="keywordflow">if</span>(!bDisabled)</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                    ::ImageList_Draw(m_hImageList, iButton, dc, point.x, point.y, ILD_TRANSPARENT);</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                }</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                {</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                    HBRUSH hBrushBackground = ::GetSysColorBrush((bSelected &amp;&amp; !(bDisabled &amp;&amp; bChecked)) ? COLOR_MENUHILIGHT : COLOR_MENU);</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                    HBRUSH hBrushDisabledImage = ::GetSysColorBrush(COLOR_3DSHADOW);</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                    pT-&gt;DrawBitmapDisabled(dc, iButton, point, hBrushBackground, hBrushBackground, hBrushDisabledImage);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            }</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            {</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                <span class="comment">// no image - look for custom checked/unchecked bitmaps</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> info;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                info.fMask = MIIM_CHECKMARKS | MIIM_TYPE;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;                ::GetMenuItemInfo((HMENU)lpDrawItemStruct-&gt;hwndItem, lpDrawItemStruct-&gt;itemID, MF_BYCOMMAND, &amp;info);</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                <span class="keywordflow">if</span>(bChecked || info.hbmpUnchecked != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                {</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRadio = ((info.fType &amp; MFT_RADIOCHECK) != 0);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                    pT-&gt;DrawCheckmark(dc, rcButn, bSelected, bDisabled, bRadio, bChecked ? info.hbmpChecked : info.hbmpUnchecked);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                }</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            <span class="comment">// draw item text</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;            <span class="keywordtype">int</span> cxButn = m_szButton.cx;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            <span class="comment">// calc text rectangle and colors</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            RECT rcText = rcItem;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            rcText.left += cxButn + s_kcxGap + s_kcxTextMargin;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            rcText.right -= cxButn;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            dc.SetBkMode(TRANSPARENT);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            COLORREF colorText = ::GetSysColor(bDisabled ?  (bSelected ? COLOR_GRAYTEXT : COLOR_3DSHADOW) : (bSelected ? COLOR_HIGHLIGHTTEXT : COLOR_MENUTEXT));</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            pT-&gt;DrawMenuText(dc, rcText, pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>, colorText); <span class="comment">// finally!</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        }</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; </div>
<div class="line"><a name="l02324"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad7e7a4f3d9120374e5de7a179ded3aea"> 2324</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad7e7a4f3d9120374e5de7a179ded3aea">DrawMenuText</a>(<a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a>&amp; dc, RECT&amp; rc, LPCTSTR lpstrText, COLORREF <a class="code" href="namespacecolor.html">color</a>)</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        <span class="keywordtype">int</span> nTab = -1;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; lstrlen(lpstrText); i++)</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="keywordflow">if</span>(lpstrText[i] == _T(<span class="charliteral">&#39;\t&#39;</span>))</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                nTab = i;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">SetTextColor</a>(<a class="code" href="namespacecolor.html">color</a>);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2871d067a4a5d219d6d08a8f9321c404">DrawText</a>(lpstrText, nTab, &amp;rc, DT_SINGLELINE | DT_LEFT | DT_VCENTER | (m_bShowKeyboardCues ? 0 : DT_HIDEPREFIX));</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <span class="keywordflow">if</span>(nTab != -1)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2871d067a4a5d219d6d08a8f9321c404">DrawText</a>(&amp;lpstrText[nTab + 1], -1, &amp;rc, DT_SINGLELINE | DT_RIGHT | DT_VCENTER | (m_bShowKeyboardCues ? 0 : DT_HIDEPREFIX));</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    }</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; </div>
<div class="line"><a name="l02341"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b27d235765cd2eb574826a7b62f8e86"> 2341</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b27d235765cd2eb574826a7b62f8e86">DrawBitmapDisabled</a>(<a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a>&amp; dc, <span class="keywordtype">int</span> nImage, POINT point,</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            HBRUSH hBrushBackground = ::GetSysColorBrush(COLOR_3DFACE),</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            HBRUSH hBrush3DEffect = ::GetSysColorBrush(COLOR_3DHILIGHT),</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            HBRUSH hBrushDisabledImage = ::GetSysColorBrush(COLOR_3DSHADOW))</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="preprocessor">#if (_WIN32_WINNT &gt;= 0x0501) &amp;&amp; (_WIN32_IE &gt;= 0x0501)</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="keywordflow">if</span>(m_bAlphaImages)</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            IMAGELISTDRAWPARAMS ildp = { 0 };</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            ildp.cbSize = <span class="keyword">sizeof</span>(IMAGELISTDRAWPARAMS);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            ildp.himl = m_hImageList;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            ildp.i = nImage;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            ildp.hdcDst = dc;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            ildp.x = point.x;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            ildp.y = point.y;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            ildp.cx = 0;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            ildp.cy = 0;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            ildp.xBitmap = 0;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            ildp.yBitmap = 0;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            ildp.fStyle = ILD_TRANSPARENT;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            ildp.fState = ILS_SATURATE;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;            ildp.Frame = 0;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;            ::ImageList_DrawIndirect(&amp;ildp);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        }</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_WINNT &gt;= 0x0501) &amp;&amp; (_WIN32_IE &gt;= 0x0501)</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <span class="comment">// create memory DC</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDC</a> dcMem;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a0f929e770321e607931627b973bdb67a">CreateCompatibleDC</a>(dc);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            <span class="comment">// create mono or color bitmap</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_bitmap_t.html">CBitmap</a> bmp;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a5df966ea4d80995b0655b515c1bd7399">CreateCompatibleBitmap</a>(dc, m_szBitmap.cx, m_szBitmap.cy);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            ATLASSERT(bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a80d077468cbf98534a6621aa4f62a187">m_hBitmap</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;            <span class="comment">// draw image into memory DC--fill BG white first</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            HBITMAP hBmpOld = dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">SelectBitmap</a>(bmp);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;            dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a55800b0e491698451ae52b6da0deb87c">PatBlt</a>(0, 0, m_szBitmap.cx, m_szBitmap.cy, WHITENESS);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;            <span class="comment">// If white is the text color, we can&#39;t use the normal painting since</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <span class="comment">// it would blend with the WHITENESS, but the mask is OK</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;            UINT uDrawStyle = (::GetSysColor(COLOR_BTNTEXT) == RGB(255, 255, 255)) ? ILD_MASK : ILD_NORMAL;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            ::ImageList_Draw(m_hImageList, nImage, dcMem, 0, 0, uDrawStyle);</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#ad1c93b5c6b39e9eaa9f668e248e5d637">DitherBlt</a>(point.x, point.y, m_szBitmap.cx, m_szBitmap.cy, dcMem, <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, hBrushBackground, hBrush3DEffect, hBrushDisabledImage);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">SelectBitmap</a>(hBmpOld);   <span class="comment">// restore</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        }</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    }</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="comment">// old name</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1b59c341388ead5e30320c59c34695d7"> 2388</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1b59c341388ead5e30320c59c34695d7">Draw3DCheckmark</a>(<a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a>&amp; dc, <span class="keyword">const</span> RECT&amp; rc, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bSelected, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bDisabled, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRadio, HBITMAP hBmpCheck)</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    {</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        <span class="keywordflow">return</span> DrawCheckmark(dc, rc, bSelected, bDisabled, bRadio, hBmpCheck);</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    }</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; </div>
<div class="line"><a name="l02393"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af60daf85bc2b80b44bd14b180d942472"> 2393</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af60daf85bc2b80b44bd14b180d942472">DrawCheckmark</a>(<a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDCHandle</a>&amp; dc, <span class="keyword">const</span> RECT&amp; rc, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bSelected, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bDisabled, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRadio, HBITMAP hBmpCheck)</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    {</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="comment">// get checkmark bitmap, if none, use Windows standard</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        SIZE <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a> = { 0, 0 };</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_bitmap_t.html">CBitmapHandle</a> bmp = hBmpCheck;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keywordflow">if</span>(hBmpCheck != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;            bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a9636e923693f93bc2d7a093275c0575b">GetSize</a>(<a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        }</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        {</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;            <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx = ::GetSystemMetrics(SM_CXMENUCHECK); </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;            <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy = ::GetSystemMetrics(SM_CYMENUCHECK); </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;            bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a5df966ea4d80995b0655b515c1bd7399">CreateCompatibleBitmap</a>(dc, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            ATLASSERT(bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a80d077468cbf98534a6621aa4f62a187">m_hBitmap</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        }</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="comment">// center bitmap in caller&#39;s rectangle</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        RECT rcDest = rc;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        <span class="keywordflow">if</span>((rc.right - rc.left) &gt; <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx)</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;        {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            rcDest.left = rc.left + (rc.right - rc.left - <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx) / 2;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            rcDest.right = rcDest.left + <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        }</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <span class="keywordflow">if</span>((rc.bottom - rc.top) &gt; <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy)</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        {</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            rcDest.top = rc.top + (rc.bottom - rc.top - <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy) / 2;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;            rcDest.bottom = rcDest.top + <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="comment">// paint background</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="keywordflow">if</span>(!m_bFlatMenus)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        {</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <span class="keywordflow">if</span>(bSelected &amp;&amp; !bDisabled)</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rcDest, COLOR_MENU);</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            }</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            {</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                COLORREF clrTextOld = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">SetTextColor</a>(::GetSysColor(COLOR_BTNFACE));</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                COLORREF clrBkOld = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2ddfbbb0bf3ac94b84cbdd7b3e43dc58">SetBkColor</a>(::GetSysColor(COLOR_BTNHILIGHT));</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_brush_t.html">CBrush</a> hbr(<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a06c487f47dcf690b00e11f49871e3ad2">CDCHandle::GetHalftoneBrush</a>());</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a18c4330076a89f95fa40f92b82bfc401">SetBrushOrg</a>(rcDest.left, rcDest.top);</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rcDest, hbr);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">SetTextColor</a>(clrTextOld);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2ddfbbb0bf3ac94b84cbdd7b3e43dc58">SetBkColor</a>(clrBkOld);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;            }</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        }</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        <span class="comment">// create source image</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDC</a> dcSource;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a0f929e770321e607931627b973bdb67a">CreateCompatibleDC</a>(dc);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        HBITMAP hBmpOld = dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">SelectBitmap</a>(bmp);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        <span class="comment">// set colors</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        <span class="keyword">const</span> COLORREF clrBlack = RGB(0, 0, 0);</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <span class="keyword">const</span> COLORREF clrWhite = RGB(255, 255, 255);</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        COLORREF clrTextOld = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">SetTextColor</a>(clrBlack);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        COLORREF clrBkOld = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2ddfbbb0bf3ac94b84cbdd7b3e43dc58">SetBkColor</a>(clrWhite);</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        <span class="comment">// create mask</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDC</a> dcMask;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        dcMask.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a0f929e770321e607931627b973bdb67a">CreateCompatibleDC</a>(dc);</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_bitmap_t.html">CBitmap</a> bmpMask;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        bmpMask.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a114cf196f780520a45df9052c314f469">CreateBitmap</a>(<a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy, 1, 1, <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        HBITMAP hBmpOld1 = dcMask.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">SelectBitmap</a>(bmpMask);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        <span class="comment">// draw the checkmark transparently</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        <span class="keywordtype">int</span> cx = rcDest.right - rcDest.left;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        <span class="keywordtype">int</span> cy = rcDest.bottom - rcDest.top;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        <span class="keywordflow">if</span>(hBmpCheck != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        {</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            <span class="comment">// build mask based on transparent color    </span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;            dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2ddfbbb0bf3ac94b84cbdd7b3e43dc58">SetBkColor</a>(m_clrMask);</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;            dcMask.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2ddfbbb0bf3ac94b84cbdd7b3e43dc58">SetBkColor</a>(clrBlack);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;            dcMask.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">SetTextColor</a>(clrWhite);</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;            dcMask.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(0, 0, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy, dcSource, 0, 0, SRCCOPY);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;            <span class="comment">// draw bitmap using the mask</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(rcDest.left, rcDest.top, cx, cy, dcSource, 0, 0, SRCINVERT);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(rcDest.left, rcDest.top, cx, cy, dcMask, 0, 0, SRCAND);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(rcDest.left, rcDest.top, cx, cy, dcSource, 0, 0, SRCINVERT);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        }</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        {</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            <span class="keyword">const</span> DWORD ROP_DSno = 0x00BB0226L;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;            <span class="keyword">const</span> DWORD ROP_DSa = 0x008800C6L;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            <span class="keyword">const</span> DWORD ROP_DSo = 0x00EE0086L;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            <span class="keyword">const</span> DWORD ROP_DSna = 0x00220326L;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; </div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            <span class="comment">// draw mask</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;            RECT rcSource = { 0, 0, <a class="code" href="nxtcolor_8c.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(<a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx, rc.right - rc.left), <a class="code" href="nxtcolor_8c.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>(<a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy, rc.bottom - rc.top) };</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            dcMask.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a9f517234a46ac9a1eb06786967d86c4d">DrawFrameControl</a>(&amp;rcSource, DFC_MENU, bRadio ? DFCS_MENUBULLET : DFCS_MENUCHECK);</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160; </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            <span class="comment">// draw shadow if disabled</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            <span class="keywordflow">if</span>(!m_bFlatMenus &amp;&amp; bDisabled)</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            {</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                <span class="comment">// offset by one pixel</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a> = rcDest.left + 1;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> = rcDest.top + 1;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                <span class="comment">// paint source bitmap</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> nColor = COLOR_3DHILIGHT;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rcSource, nColor);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                <span class="comment">// draw checkmark - special case black and white colors</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                COLORREF clrCheck = ::GetSysColor(nColor);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                <span class="keywordflow">if</span>(clrCheck == clrWhite)</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                    dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(<a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, cx, cy, dcMask,  0, 0,   ROP_DSno);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                    dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(<a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, cx, cy, dcSource, 0, 0, ROP_DSa);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                }</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                {</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                    <span class="keywordflow">if</span>(clrCheck != clrBlack)</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                    {</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                        ATLASSERT(dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a6e0f942bc75c698ce9dee87337d9351c">GetTextColor</a>() == clrBlack);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                        ATLASSERT(dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a9c696a7d67c96d94753be2a9829583ce">GetBkColor</a>() == clrWhite);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                        dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(0, 0, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy, dcMask, 0, 0, ROP_DSna);</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                    }</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                    dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(<a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, cx, cy, dcMask,  0,  0,  ROP_DSa);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                    dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(<a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, cx, cy, dcSource, 0, 0, ROP_DSo);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;            <span class="comment">// paint source bitmap</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nColor = bDisabled ? COLOR_BTNSHADOW : COLOR_MENUTEXT;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;            dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rcSource, nColor);</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            <span class="comment">// draw checkmark - special case black and white colors</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            COLORREF clrCheck = ::GetSysColor(nColor);</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            <span class="keywordflow">if</span>(clrCheck == clrWhite)</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(rcDest.left, rcDest.top, cx, cy, dcMask,  0, 0,   ROP_DSno);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(rcDest.left, rcDest.top, cx, cy, dcSource, 0, 0, ROP_DSa);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            }</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            {</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                <span class="keywordflow">if</span>(clrCheck != clrBlack)</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                {</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                    ATLASSERT(dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a6e0f942bc75c698ce9dee87337d9351c">GetTextColor</a>() == clrBlack);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                    ATLASSERT(dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a9c696a7d67c96d94753be2a9829583ce">GetBkColor</a>() == clrWhite);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                    dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(0, 0, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx, <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cy, dcMask, 0, 0, ROP_DSna);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                }</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(rcDest.left, rcDest.top, cx, cy, dcMask,  0,  0,  ROP_DSa);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">BitBlt</a>(rcDest.left, rcDest.top, cx, cy, dcSource, 0, 0, ROP_DSo);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;            }</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        <span class="comment">// restore all</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">SetTextColor</a>(clrTextOld);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2ddfbbb0bf3ac94b84cbdd7b3e43dc58">SetBkColor</a>(clrBkOld);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        dcSource.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">SelectBitmap</a>(hBmpOld);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        dcMask.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">SelectBitmap</a>(hBmpOld1);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <span class="keywordflow">if</span>(hBmpCheck == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            bmp.<a class="code" href="class_w_t_l_1_1_c_bitmap_t.html#a3efa2da9951422a13c9aeece49cefed9">DeleteObject</a>();</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <span class="comment">// draw pushed-in hilight</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keywordflow">if</span>(!m_bFlatMenus &amp;&amp; !bDisabled)</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="keywordflow">if</span>(rc.right - rc.left &gt; <a class="code" href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a>.cx)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                ::InflateRect(&amp;rcDest, 1,1);   <span class="comment">// inflate checkmark by one pixel all around</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a19ee2697138e6b4a73c1bf32587f4a81">DrawEdge</a>(&amp;rcDest, BDR_SUNKENOUTER, BF_RECT);</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        }</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160; </div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    }</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160; </div>
<div class="line"><a name="l02551"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa58dc0c5334149c0b7deb57ff19708ae"> 2551</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa58dc0c5334149c0b7deb57ff19708ae">MeasureItem</a>(LPMEASUREITEMSTRUCT lpMeasureItemStruct)</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pmd = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)lpMeasureItemStruct-&gt;itemData;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160; </div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <span class="keywordflow">if</span>(pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">fType</a> &amp; MFT_SEPARATOR)   <span class="comment">// separator - use half system height and zero width</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;            lpMeasureItemStruct-&gt;itemHeight = ::GetSystemMetrics(SM_CYMENU) / 2;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            lpMeasureItemStruct-&gt;itemWidth  = 0;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        }</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;            <span class="comment">// compute size of text - use DrawText with DT_CALCRECT</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_window_d_c.html">CWindowDC</a> dc(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_font_t.html">CFont</a> fontBold;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            HFONT hOldFont = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;            <span class="keywordflow">if</span>(pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a067bd58dd35ee07dea81d0b4a4e144ca">fState</a> &amp; MFS_DEFAULT)</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            {</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                <span class="comment">// need bold version of font</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                LOGFONT lf = { 0 };</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                m_fontMenu.<a class="code" href="class_w_t_l_1_1_c_font_t.html#a1db3e82448de138a98997e53e39d7336">GetLogFont</a>(lf);</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                lf.lfWeight += 200;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                fontBold.<a class="code" href="class_w_t_l_1_1_c_font_t.html#a3dd0c155f296f0480c8972c492bae4af">CreateFontIndirect</a>(&amp;lf);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                ATLASSERT(fontBold.<a class="code" href="class_w_t_l_1_1_c_font_t.html#af929af7576aa9242220212b47ca3807e">m_hFont</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                hOldFont = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">SelectFont</a>(fontBold);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;            }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            {</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                hOldFont = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">SelectFont</a>(m_fontMenu);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            }</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160; </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            RECT rcText = { 0, 0, 0, 0 };</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2871d067a4a5d219d6d08a8f9321c404">DrawText</a>(pmd-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>, -1, &amp;rcText, DT_SINGLELINE | DT_LEFT | DT_VCENTER | DT_CALCRECT);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            <span class="keywordtype">int</span> cx = rcText.right - rcText.left;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">SelectFont</a>(hOldFont);</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            LOGFONT lf = { 0 };</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            m_fontMenu.<a class="code" href="class_w_t_l_1_1_c_font_t.html#a1db3e82448de138a98997e53e39d7336">GetLogFont</a>(lf);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            <span class="keywordtype">int</span> cy = lf.lfHeight;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;            <span class="keywordflow">if</span>(cy &lt; 0)</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                cy = -cy;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> cyMargin = 8;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;            cy += cyMargin;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160; </div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            <span class="comment">// height of item is the bigger of these two</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;            lpMeasureItemStruct-&gt;itemHeight = <a class="code" href="nxtcolor_8c.html#affe776513b24d84b39af8ab0930fef7f">max</a>(cy, (<span class="keywordtype">int</span>)m_szButton.cy);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;            <span class="comment">// width is width of text plus a bunch of stuff</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            cx += 2 * s_kcxTextMargin;   <span class="comment">// L/R margin for readability</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            cx += s_kcxGap;              <span class="comment">// space between button and menu text</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            cx += 2 * m_szButton.cx;     <span class="comment">// button width (L=button; R=empty margin)</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;            cx += m_cxExtraSpacing;      <span class="comment">// extra between item text and accelerator keys</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160; </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;            <span class="comment">// Windows adds 1 to returned value</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;            cx -= ::GetSystemMetrics(SM_CXMENUCHECK) - 1;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;            lpMeasureItemStruct-&gt;itemWidth = cx;   <span class="comment">// done deal</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        }</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    }</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160; </div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="comment">// Implementation - Hook procs</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b5ffcce66a5fd634ee080907ee6f8b1"> 2610</a></span>&#160;    <span class="keyword">static</span> LRESULT CALLBACK <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b5ffcce66a5fd634ee080907ee6f8b1">CreateHookProc</a>(<span class="keywordtype">int</span> nCode, WPARAM wParam, LPARAM lParam)</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> cchClassName = 7;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        TCHAR szClassName[cchClassName] = { 0 };</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        <span class="keywordflow">if</span>(nCode == HCBT_CREATEWND)</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        {</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;            HWND hWndMenu = (HWND)wParam;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - HCBT_CREATEWND (HWND = %8.8X)\n&quot;</span>), hWndMenu);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160; </div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;            ::GetClassName(hWndMenu, szClassName, cchClassName);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;            <span class="keywordflow">if</span>(!lstrcmp(_T(<span class="stringliteral">&quot;#32768&quot;</span>), szClassName))</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                s_pCurrentBar-&gt;m_stackMenuWnd.Push(hWndMenu);</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        }</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nCode == HCBT_DESTROYWND)</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;            HWND hWndMenu = (HWND)wParam;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - HCBT_DESTROYWND (HWND = %8.8X)\n&quot;</span>), hWndMenu);</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; </div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;            ::GetClassName(hWndMenu, szClassName, cchClassName);</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            <span class="keywordflow">if</span>(!lstrcmp(_T(<span class="stringliteral">&quot;#32768&quot;</span>), szClassName))</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;            {</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                ATLASSERT(hWndMenu == s_pCurrentBar-&gt;m_stackMenuWnd.GetCurrent());</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;                s_pCurrentBar-&gt;m_stackMenuWnd.Pop();</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;            }</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        return ::CallNextHookEx(s_hCreateHook, nCode, wParam, lParam);</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    }</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab339fed939f8132a256146580ee4a3ae"> 2644</a></span>&#160;    <span class="keyword">static</span> LRESULT CALLBACK <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab339fed939f8132a256146580ee4a3ae">MessageHookProc</a>(<span class="keywordtype">int</span> nCode, WPARAM wParam, LPARAM lParam)</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    {</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        LPMSG pMsg = (LPMSG)lParam;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        <span class="keywordflow">if</span>(nCode == HC_ACTION &amp;&amp; wParam == PM_REMOVE &amp;&amp; pMsg-&gt;message != GetGetBarMessage() &amp;&amp; pMsg-&gt;message != WM_FORWARDMSG)</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        {</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">CCommandBarCtrlBase</a>* pCmdBar = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            HWND hWnd = pMsg-&gt;hwnd;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            DWORD dwPID = 0;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            <span class="keywordflow">while</span>(pCmdBar == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; hWnd != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;            {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                pCmdBar = (<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">CCommandBarCtrlBase</a>*)::SendMessage(hWnd, GetGetBarMessage(), (WPARAM)&amp;dwPID, 0L);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                hWnd = ::GetParent(hWnd);</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;            }</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;            <span class="keywordflow">if</span>(pCmdBar != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; dwPID == GetCurrentProcessId())</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                pCmdBar-&gt;<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#acc5db274749f36099c3354b89c5a4fe8">m_hWndHook</a> = pMsg-&gt;hwnd;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                ATLASSERT(pCmdBar-&gt;<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a25cde13030bbd27213b768fe8089b064">IsCommandBarBase</a>());</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160; </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;                <span class="keywordflow">if</span>(::IsWindow(pCmdBar-&gt;m_hWnd))</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;                    pCmdBar-&gt;SendMessage(WM_FORWARDMSG, 0, (LPARAM)pMsg);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                    ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - Hook skipping message, can&#39;t find command bar!\n&quot;</span>));</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        }</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        LRESULT lRet = 0;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        ATLASSERT(s_pmapMsgHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <span class="keywordflow">if</span>(s_pmapMsgHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            DWORD dwThreadID = ::GetCurrentThreadId();</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            _MsgHookData* pData = s_pmapMsgHook-&gt;Lookup(dwThreadID);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="keywordflow">if</span>(pData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            {</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                lRet = ::CallNextHookEx(pData-&gt;hMsgHook, nCode, wParam, lParam);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            }</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        }</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment">// Implementation</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a901c86a7e45f354193178f958f6706bc"> 2686</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a901c86a7e45f354193178f958f6706bc">DoPopupMenu</a>(<span class="keywordtype">int</span> nIndex, <span class="keywordtype">bool</span> bAnimate)</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    {</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - DoPopupMenu, bAnimate = %s\n&quot;</span>), bAnimate ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; </div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="comment">// Menu animation flags</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="preprocessor">#ifndef TPM_VERPOSANIMATION</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        <span class="keyword">const</span> UINT TPM_VERPOSANIMATION = 0x1000L;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="preprocessor">#ifndef TPM_NOANIMATION</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keyword">const</span> UINT TPM_NOANIMATION = 0x4000L;</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160; </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        <span class="comment">// get popup menu and it&#39;s position</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        RECT rect = { 0 };</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        GetItemRect(nIndex, &amp;rect);</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        POINT <a class="code" href="structpt.html">pt</a> = { rect.left, rect.bottom };</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        MapWindowPoints(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;<a class="code" href="structpt.html">pt</a>, 1);</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;        MapWindowPoints(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;rect);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        TPMPARAMS TPMParams = { 0 };</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        TPMParams.cbSize = <span class="keyword">sizeof</span>(TPMPARAMS);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        TPMParams.rcExclude = rect;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        HMENU hMenuPopup = ::GetSubMenu(m_hMenu, nIndex);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        ATLASSERT(hMenuPopup != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160; </div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="comment">// get button ID</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        TBBUTTON tbb = { 0 };</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        GetButton(nIndex, &amp;tbb);</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        <span class="keywordtype">int</span> nCmdID = tbb.idCommand;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; </div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        m_nPopBtn = nIndex;   <span class="comment">// remember current button&#39;s index</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160; </div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        <span class="comment">// press button and display popup menu</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        PressButton(nCmdID, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        SetHotItem(nCmdID);</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        pT-&gt;DoTrackPopupMenu(hMenuPopup, TPM_LEFTBUTTON | TPM_VERTICAL | TPM_LEFTALIGN | TPM_TOPALIGN |</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            (s_bW2K ? (bAnimate ? TPM_VERPOSANIMATION : TPM_NOANIMATION) : 0), <a class="code" href="structpt.html">pt</a>.x, <a class="code" href="structpt.html">pt</a>.y, &amp;TPMParams);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        PressButton(nCmdID, <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        <span class="keywordflow">if</span>(::GetFocus() != m_hWnd)</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            SetHotItem(-1);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160; </div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        m_nPopBtn = -1;   <span class="comment">// restore</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160; </div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        <span class="comment">// eat next message if click is on the same button</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        MSG msg = { 0 };</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        <span class="keywordflow">if</span>(::PeekMessage(&amp;msg, m_hWnd, WM_LBUTTONDOWN, WM_LBUTTONDOWN, PM_NOREMOVE) &amp;&amp; ::PtInRect(&amp;rect, msg.pt))</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            ::PeekMessage(&amp;msg, m_hWnd, WM_LBUTTONDOWN, WM_LBUTTONDOWN, PM_REMOVE);</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160; </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <span class="comment">// check if another popup menu should be displayed</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        <span class="keywordflow">if</span>(m_nNextPopBtn != -1)</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        {</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;            PostMessage(GetAutoPopupMessage(), m_nNextPopBtn &amp; 0xFFFF);</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;            <span class="keywordflow">if</span>(!(m_nNextPopBtn &amp; 0xFFFF0000) &amp;&amp; !m_bPopupItem)</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                PostMessage(WM_KEYDOWN, VK_DOWN, 0);</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            m_nNextPopBtn = -1;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        }</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        {</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            m_bContextMenu = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            <span class="comment">// If user didn&#39;t hit escape, give focus back</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            <span class="keywordflow">if</span>(!m_bEscapePressed)</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;            {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                <span class="keywordflow">if</span>(m_bUseKeyboardCues &amp;&amp; m_bShowKeyboardCues)</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                    m_bAllowKeyboardCues = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                pT-&gt;GiveFocusBack();</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;            }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            {</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                SetHotItem(nCmdID);</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                SetAnchorHighlight(<a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;            }</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        }</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    }</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#affe461ca5646cb81653b8b28ed6b0634"> 2762</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#affe461ca5646cb81653b8b28ed6b0634">DoTrackPopupMenu</a>(HMENU hMenu, UINT uFlags, <span class="keywordtype">int</span> <a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <span class="keywordtype">int</span> <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, LPTPMPARAMS lpParams = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> menuPopup = hMenu;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160; </div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html">CWindowCreateCriticalSectionLock</a> lock;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        <span class="keywordflow">if</span>(FAILED(lock.<a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">Lock</a>()))</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;ERROR : Unable to lock critical section in CCommandBarCtrlImpl::DoTrackPopupMenu.\n&quot;</span>));</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        }</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        ATLASSERT(s_hCreateHook == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160; </div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        s_pCurrentBar = <span class="keyword">static_cast&lt;</span><a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">CCommandBarCtrlBase</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; </div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        s_hCreateHook = ::SetWindowsHookEx(WH_CBT, CreateHookProc, <a class="code" href="namespace_w_t_l_1_1_module_helper.html#ad444c040fe6a3be1592135f52989627f">ModuleHelper::GetModuleInstance</a>(), GetCurrentThreadId());</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        ATLASSERT(s_hCreateHook != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160; </div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        m_bPopupItem = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        m_bMenuActive = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160; </div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bTrackRet = menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a78f2a3d405df72ac3e75a1fba6ba1ab2">TrackPopupMenuEx</a>(uFlags, <a class="code" href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, <a class="code" href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, m_hWnd, lpParams);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        m_bMenuActive = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160; </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        ::UnhookWindowsHookEx(s_hCreateHook);</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; </div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        s_hCreateHook = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        s_pCurrentBar = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        lock.<a class="code" href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160; </div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="comment">// cleanup - convert menus back to original state</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - TrackPopupMenu - cleanup\n&quot;</span>));</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; </div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        ATLASSERT(m_stackMenuWnd.GetSize() == 0);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160; </div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        UpdateWindow();</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        ATL::CWindow wndTL = GetTopLevelParent();</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        wndTL.UpdateWindow();</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; </div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        <span class="comment">// restore the menu items to the previous state for all menus that were converted</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        <span class="keywordflow">if</span>(m_bImagesVisible)</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        {</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            HMENU hMenuSav = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;            <span class="keywordflow">while</span>((hMenuSav = m_stackMenuHandle.Pop()) != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            {</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                menuPopup = hMenuSav;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                <span class="comment">// restore state and delete menu item data</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#af66b7b895159a7c38d5b4d009f00f419">GetMenuItemCount</a>(); i++)</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                {</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                    <a class="code" href="class_w_t_l_1_1_c_menu_item_info.html">CMenuItemInfo</a> mii;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                    mii.fMask = MIIM_DATA | MIIM_TYPE | MIIM_ID;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                    bRet = menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#ace9f3d87c46a807eebc59d84d1112c2e">GetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                    ATLASSERT(bRet);</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                    <a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>* pMI = (<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">_MenuItemData</a>*)mii.dwItemData;</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                    <span class="keywordflow">if</span>(pMI != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">IsCmdBarMenuItem</a>())</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                    {</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                        mii.fMask = MIIM_DATA | MIIM_TYPE | MIIM_STATE;</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                        mii.fType = pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">fType</a>;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                        mii.fState = pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a067bd58dd35ee07dea81d0b4a4e144ca">fState</a>;</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                        mii.dwTypeData = pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                        mii.cch = lstrlen(pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                        mii.dwItemData = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160; </div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                        bRet = menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a8dfb6f30aeeb3658edd247f23ba9d0d2">SetMenuItemInfo</a>(i, <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;mii);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                        <span class="comment">// this one triggers WM_MEASUREITEM</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                        menuPopup.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a8a063895f9f2bc4626874083663f576b">ModifyMenu</a>(i, MF_BYPOSITION | mii.fType | mii.fState, mii.wID, pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                        ATLASSERT(bRet);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160; </div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                        <span class="keyword">delete</span> [] pMI-&gt;<a class="code" href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">lpstrText</a>;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                        <span class="keyword">delete</span> pMI;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                    }</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                }</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;            }</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        }</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        <span class="keywordflow">return</span> bTrackRet;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160; </div>
<div class="line"><a name="l02845"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acd8146da24cc3d1a165ccfae979469c6"> 2845</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acd8146da24cc3d1a165ccfae979469c6">GetPreviousMenuItem</a>(<span class="keywordtype">int</span> nBtn)<span class="keyword"> const</span></div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;        <span class="keywordflow">if</span>(nBtn == -1)</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        RECT rcClient;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        GetClientRect(&amp;rcClient);</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <span class="keywordtype">int</span> nNextBtn;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        <span class="keywordflow">for</span>(nNextBtn = nBtn - 1; nNextBtn != nBtn; nNextBtn--)</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        {</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;            <span class="keywordflow">if</span>(nNextBtn &lt; 0)</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                nNextBtn = ::GetMenuItemCount(m_hMenu) - 1;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;            TBBUTTON tbb = { 0 };</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;            GetButton(nNextBtn, &amp;tbb);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;            RECT rcBtn;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;            GetItemRect(nNextBtn, &amp;rcBtn);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;            <span class="keywordflow">if</span>(rcBtn.right &gt; rcClient.right)</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;            {</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                nNextBtn = -2;   <span class="comment">// chevron</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;            }</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;            <span class="keywordflow">if</span>((tbb.fsState &amp; TBSTATE_ENABLED) != 0 &amp;&amp; (tbb.fsState &amp; TBSTATE_HIDDEN) == 0)</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        }</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <span class="keywordflow">return</span> (nNextBtn != nBtn) ? nNextBtn : -1;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    }</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160; </div>
<div class="line"><a name="l02875"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae68fb601023d59c150b2f38da4ea6d05"> 2875</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae68fb601023d59c150b2f38da4ea6d05">GetNextMenuItem</a>(<span class="keywordtype">int</span> nBtn)<span class="keyword"> const</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        <span class="keywordflow">if</span>(nBtn == -1)</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        RECT rcClient = { 0 };</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        GetClientRect(&amp;rcClient);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        <span class="keywordtype">int</span> nNextBtn = 0;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        <span class="keywordtype">int</span> nCount = ::GetMenuItemCount(m_hMenu);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="keywordflow">for</span>(nNextBtn = nBtn + 1; nNextBtn != nBtn; nNextBtn++)</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        {</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;            <span class="keywordflow">if</span>(nNextBtn &gt;= nCount)</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                nNextBtn = 0;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;            TBBUTTON tbb = { 0 };</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;            GetButton(nNextBtn, &amp;tbb);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;            RECT rcBtn = { 0 };</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;            GetItemRect(nNextBtn, &amp;rcBtn);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;            <span class="keywordflow">if</span>(rcBtn.right &gt; rcClient.right)</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;            {</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                nNextBtn = -2;   <span class="comment">// chevron</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;            }</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            <span class="keywordflow">if</span>((tbb.fsState &amp; TBSTATE_ENABLED) != 0 &amp;&amp; (tbb.fsState &amp; TBSTATE_HIDDEN) == 0)</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        }</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        <span class="keywordflow">return</span> (nNextBtn != nBtn) ? nNextBtn : -1;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    }</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; </div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="keywordtype">bool</span> DisplayChevronMenu()</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    {</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;        <span class="comment">// assume we are in a rebar</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        HWND hWndReBar = GetParent();</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <span class="keywordtype">int</span> nCount = (<a class="code" href="namespacechecksum.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)::SendMessage(hWndReBar, RB_GETBANDCOUNT, 0, 0L);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;        <span class="keywordtype">bool</span> bRet = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nCount; i++)</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;            REBARBANDINFO rbbi = { <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ac0771dda0062021256c9946530324d97">RunTimeHelper::SizeOf_REBARBANDINFO</a>(), RBBIM_CHILD | RBBIM_STYLE };</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRetBandInfo = (<a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>)::SendMessage(hWndReBar, RB_GETBANDINFO, i, (LPARAM)&amp;rbbi);</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;            <span class="keywordflow">if</span>(bRetBandInfo &amp;&amp; rbbi.hwndChild == m_hWnd)</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;            {</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                <span class="keywordflow">if</span>((rbbi.fStyle &amp; RBBS_USECHEVRON) != 0)</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                {</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                    ::PostMessage(hWndReBar, RB_PUSHCHEVRON, i, 0L);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                    PostMessage(WM_KEYDOWN, VK_DOWN, 0L);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                    bRet = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                }</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;            }</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        }</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        <span class="keywordflow">return</span> bRet;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    }</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160; </div>
<div class="line"><a name="l02932"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae1252bd3befe525991603b8b24a88dde"> 2932</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae1252bd3befe525991603b8b24a88dde">GetSystemSettings</a>()</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    {</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        <span class="comment">// refresh our font</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        NONCLIENTMETRICS info = { <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#a9f06e5b838fb4cb07a8dabcca8c40562">RunTimeHelper::SizeOf_NONCLIENTMETRICS</a>() };</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = ::SystemParametersInfo(SPI_GETNONCLIENTMETRICS, <span class="keyword">sizeof</span>(info), &amp;info, 0);</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        ATLASSERT(bRet);</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        {</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;            LOGFONT logfont = { 0 };</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            <span class="keywordflow">if</span>(m_fontMenu.<a class="code" href="class_w_t_l_1_1_c_font_t.html#af929af7576aa9242220212b47ca3807e">m_hFont</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                m_fontMenu.<a class="code" href="class_w_t_l_1_1_c_font_t.html#a1db3e82448de138a98997e53e39d7336">GetLogFont</a>(logfont);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            <span class="keywordflow">if</span>(logfont.lfHeight != info.lfMenuFont.lfHeight ||</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;               logfont.lfWidth != info.lfMenuFont.lfWidth ||</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;               logfont.lfEscapement != info.lfMenuFont.lfEscapement ||</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;               logfont.lfOrientation != info.lfMenuFont.lfOrientation ||</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;               logfont.lfWeight != info.lfMenuFont.lfWeight ||</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;               logfont.lfItalic != info.lfMenuFont.lfItalic ||</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;               logfont.lfUnderline != info.lfMenuFont.lfUnderline ||</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;               logfont.lfStrikeOut != info.lfMenuFont.lfStrikeOut ||</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;               logfont.lfCharSet != info.lfMenuFont.lfCharSet ||</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;               logfont.lfOutPrecision != info.lfMenuFont.lfOutPrecision ||</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;               logfont.lfClipPrecision != info.lfMenuFont.lfClipPrecision ||</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;               logfont.lfQuality != info.lfMenuFont.lfQuality ||</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;               logfont.lfPitchAndFamily != info.lfMenuFont.lfPitchAndFamily ||</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;               lstrcmp(logfont.lfFaceName, info.lfMenuFont.lfFaceName) != 0)</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;            {</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                HFONT hFontMenu = ::CreateFontIndirect(&amp;info.lfMenuFont);</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;                ATLASSERT(hFontMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;                <span class="keywordflow">if</span>(hFontMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;                {</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;                    <span class="keywordflow">if</span>(m_fontMenu.<a class="code" href="class_w_t_l_1_1_c_font_t.html#af929af7576aa9242220212b47ca3807e">m_hFont</a> != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;                        m_fontMenu.<a class="code" href="class_w_t_l_1_1_c_font_t.html#a3efa2da9951422a13c9aeece49cefed9">DeleteObject</a>();</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;                    m_fontMenu.<a class="code" href="class_w_t_l_1_1_c_font_t.html#a7395023a37c455fb266213238f615697">Attach</a>(hFontMenu);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;                    SetFont(m_fontMenu);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;                    AddStrings(_T(<span class="stringliteral">&quot;NS\0&quot;</span>));   <span class="comment">// for proper item height</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                    AutoSize();</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;                }</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            }</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160; </div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        <span class="comment">// check if we need extra spacing for menu item text</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_window_d_c.html">CWindowDC</a> dc(m_hWnd);</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;        HFONT hFontOld = dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">SelectFont</a>(m_fontMenu);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;        RECT rcText = { 0, 0, 0, 0 };</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2871d067a4a5d219d6d08a8f9321c404">DrawText</a>(_T(<span class="stringliteral">&quot;\t&quot;</span>), -1, &amp;rcText, DT_SINGLELINE | DT_LEFT | DT_VCENTER | DT_CALCRECT);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;        <span class="keywordflow">if</span>((rcText.right - rcText.left) &lt; 4)</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;        {</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            ::SetRectEmpty(&amp;rcText);</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a2871d067a4a5d219d6d08a8f9321c404">DrawText</a>(_T(<span class="stringliteral">&quot;x&quot;</span>), -1, &amp;rcText, DT_SINGLELINE | DT_LEFT | DT_VCENTER | DT_CALCRECT);</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;            m_cxExtraSpacing = rcText.right - rcText.left;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;        }</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        {</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;            m_cxExtraSpacing = 0;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        }</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">SelectFont</a>(hFontOld);</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160; </div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        <span class="comment">// get Windows version</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        OSVERSIONINFO ovi = { <span class="keyword">sizeof</span>(OSVERSIONINFO) };</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        ::GetVersionEx(&amp;ovi);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160; </div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        <span class="comment">// query keyboard cues mode (Windows 2000 or later)</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;        <span class="keywordflow">if</span>(ovi.dwMajorVersion &gt;= 5)</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        {</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="preprocessor">#ifndef SPI_GETKEYBOARDCUES</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;            <span class="keyword">const</span> UINT SPI_GETKEYBOARDCUES = 0x100A;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !SPI_GETKEYBOARDCUES</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRetVal = <a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;            bRet = ::SystemParametersInfo(SPI_GETKEYBOARDCUES, 0, &amp;bRetVal, 0);</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;            m_bUseKeyboardCues = (bRet &amp;&amp; !bRetVal);</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;            m_bAllowKeyboardCues = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            ShowKeyboardCues(!m_bUseKeyboardCues);</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        }</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160; </div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        <span class="comment">// query flat menu mode (Windows XP or later)</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        <span class="keywordflow">if</span>((ovi.dwMajorVersion == 5 &amp;&amp; ovi.dwMinorVersion &gt;= 1) || (ovi.dwMajorVersion &gt; 5))</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        {</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;<span class="preprocessor">#ifndef SPI_GETFLATMENU</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;            <span class="keyword">const</span> UINT SPI_GETFLATMENU = 0x1022;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !SPI_GETFLATMENU</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;            <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRetVal = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            bRet = ::SystemParametersInfo(SPI_GETFLATMENU, 0, &amp;bRetVal, 0);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;            m_bFlatMenus = (bRet &amp;&amp; bRetVal);</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        }</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160; </div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        <span class="comment">// check if we should use Vista menus</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordtype">bool</span> bVistaMenus = (<a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">RunTimeHelper::IsVista</a>() &amp;&amp; <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#a701445cfffddec20eacec6b89601a504">RunTimeHelper::IsCommCtrl6</a>() &amp;&amp; ((m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a247bcb0e7ba38932741ec0c8b71761b9">CBR_EX_NOVISTAMENUS</a>) == 0));</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160; </div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        <span class="keywordflow">if</span>(bVistaMenus)</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        {</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            HMODULE hThemeDLL = ::LoadLibrary(_T(<span class="stringliteral">&quot;uxtheme.dll&quot;</span>));</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;            <span class="keywordflow">if</span>(hThemeDLL != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;            {</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                <span class="keyword">typedef</span> <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> (STDAPICALLTYPE *PFN_IsThemeActive)();</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                PFN_IsThemeActive pfnIsThemeActive = (PFN_IsThemeActive)::GetProcAddress(hThemeDLL, <span class="stringliteral">&quot;IsThemeActive&quot;</span>);</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                ATLASSERT(pfnIsThemeActive != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                bVistaMenus = bVistaMenus &amp;&amp; (pfnIsThemeActive != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (pfnIsThemeActive() != <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160; </div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                <span class="keyword">typedef</span> <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> (STDAPICALLTYPE *PFN_IsAppThemed)();</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                PFN_IsAppThemed pfnIsAppThemed = (PFN_IsAppThemed)::GetProcAddress(hThemeDLL, <span class="stringliteral">&quot;IsAppThemed&quot;</span>);</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                ATLASSERT(pfnIsAppThemed != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                bVistaMenus = bVistaMenus &amp;&amp; (pfnIsAppThemed != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (pfnIsAppThemed() != <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160; </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                ::FreeLibrary(hThemeDLL);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;            }</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        <span class="keywordflow">if</span>(!bVistaMenus &amp;&amp; m_bVistaMenus &amp;&amp; (m_hMenu != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (m_arrCommand.GetSize() &gt; 0))</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        {</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;            pT-&gt;_RemoveVistaBitmapsFromMenu();</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        }</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160; </div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        m_bVistaMenus = bVistaMenus;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160; </div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;CmdBar - GetSystemSettings:\n     m_bFlatMenus = %s\n     m_bUseKeyboardCues = %s     m_bVistaMenus = %s\n&quot;</span>),</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;            m_bFlatMenus ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>, m_bUseKeyboardCues ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>, m_bVistaMenus ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    }</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160; </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="comment">// Implementation - alternate focus mode support</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2cf27e9d7128a6a4b3263ecd34c19105"> 3056</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2cf27e9d7128a6a4b3263ecd34c19105">TakeFocus</a>()</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    {</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <span class="keywordflow">if</span>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a9cd2c9ef1859f1f42f4c114f96fa41b0">CBR_EX_ALTFOCUSMODE</a>) &amp;&amp; m_hWndFocus == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;            m_hWndFocus = ::GetFocus();</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        SetFocus();</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160; </div>
<div class="line"><a name="l03063"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ac6470d713aec70b7e7c6ded4a30aaa"> 3063</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ac6470d713aec70b7e7c6ded4a30aaa">GiveFocusBack</a>()</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    {</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="keywordflow">if</span>(m_bParentActive)</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        {</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;            <span class="keywordflow">if</span>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a9cd2c9ef1859f1f42f4c114f96fa41b0">CBR_EX_ALTFOCUSMODE</a>) &amp;&amp; ::IsWindow(m_hWndFocus))</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                ::SetFocus(m_hWndFocus);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!(m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a9cd2c9ef1859f1f42f4c114f96fa41b0">CBR_EX_ALTFOCUSMODE</a>) &amp;&amp; m_wndParent.IsWindow())</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                m_wndParent.SetFocus();</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        }</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;        m_hWndFocus = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        SetAnchorHighlight(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;        <span class="keywordflow">if</span>(m_bUseKeyboardCues &amp;&amp; m_bShowKeyboardCues)</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            ShowKeyboardCues(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;        m_bSkipPostDown = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    }</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a10c6f8d5b42683c54a670433c8a1ab85"> 3079</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a10c6f8d5b42683c54a670433c8a1ab85">ShowKeyboardCues</a>(<span class="keywordtype">bool</span> bShow)</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    {</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;        m_bShowKeyboardCues = bShow;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        SetDrawTextFlags(DT_HIDEPREFIX, m_bShowKeyboardCues ? 0 : DT_HIDEPREFIX);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        Invalidate();</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        UpdateWindow();</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    }</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160; </div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="comment">// Implementation - internal message helpers</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a350a41a36a9269c9073ed5114dbee634"> 3088</a></span>&#160;    <span class="keyword">static</span> UINT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a350a41a36a9269c9073ed5114dbee634">GetAutoPopupMessage</a>()</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    {</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        <span class="keyword">static</span> UINT uAutoPopupMessage = 0;</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        <span class="keywordflow">if</span>(uAutoPopupMessage == 0)</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        {</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html">CStaticDataInitCriticalSectionLock</a> lock;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;            <span class="keywordflow">if</span>(FAILED(lock.<a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">Lock</a>()))</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            {</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;ERROR : Unable to lock critical section in CCommandBarCtrlImpl::GetAutoPopupMessage.\n&quot;</span>));</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            }</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160; </div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;            <span class="keywordflow">if</span>(uAutoPopupMessage == 0)</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                uAutoPopupMessage = ::RegisterWindowMessage(_T(<span class="stringliteral">&quot;WTL_CmdBar_InternalAutoPopupMsg&quot;</span>));</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160; </div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;            lock.<a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        }</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;        ATLASSERT(uAutoPopupMessage != 0);</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        <span class="keywordflow">return</span> uAutoPopupMessage;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    }</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160; </div>
<div class="line"><a name="l03110"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2143c2434933c756db7031e4d97c6a58"> 3110</a></span>&#160;    <span class="keyword">static</span> UINT <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2143c2434933c756db7031e4d97c6a58">GetGetBarMessage</a>()</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        <span class="keyword">static</span> UINT uGetBarMessage = 0;</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        <span class="keywordflow">if</span>(uGetBarMessage == 0)</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;        {</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html">CStaticDataInitCriticalSectionLock</a> lock;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;            <span class="keywordflow">if</span>(FAILED(lock.<a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">Lock</a>()))</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            {</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;ERROR : Unable to lock critical section in CCommandBarCtrlImpl::GetGetBarMessage.\n&quot;</span>));</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                ATLASSERT(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;            }</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160; </div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            <span class="keywordflow">if</span>(uGetBarMessage == 0)</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                uGetBarMessage = ::RegisterWindowMessage(_T(<span class="stringliteral">&quot;WTL_CmdBar_InternalGetBarMsg&quot;</span>));</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            lock.<a class="code" href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        }</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        ATLASSERT(uGetBarMessage != 0);</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        <span class="keywordflow">return</span> uGetBarMessage;</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    }</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; </div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="comment">// Implementation</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4e953080810b8d958281550d577b1ba1"> 3133</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4e953080810b8d958281550d577b1ba1">CreateInternalImageList</a>(<span class="keywordtype">int</span> cImages)</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        UINT uFlags = (m_bAlphaImages ? ILC_COLOR32 : ILC_COLOR24) | ILC_MASK;</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        m_hImageList = ::ImageList_Create(m_szBitmap.cx, m_szBitmap.cy, uFlags, cImages, 1);</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        ATLASSERT(m_hImageList != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        <span class="keywordflow">return</span> (m_hImageList != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;    }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160; </div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="comment">// Implementation - support for Vista menus</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="preprocessor">#if _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    <span class="keywordtype">void</span> _AddVistaBitmapsFromImageList(<span class="keywordtype">int</span> nStartIndex, <span class="keywordtype">int</span> nCount)</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <span class="comment">// Create display compatible memory DC</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_client_d_c.html">CClientDC</a> dc(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_d_c_t.html">CDC</a> dcMem;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;        dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a0f929e770321e607931627b973bdb67a">CreateCompatibleDC</a>(dc);</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;        HBITMAP hBitmapSave = dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#abf97da9ef015c9f63c7f11d9b1f729b6">GetCurrentBitmap</a>();</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160; </div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;        <span class="comment">// Create bitmaps for all menu items</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nCount; i++)</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;        {</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;            HBITMAP hBitmap = pT-&gt;_CreateVistaBitmapHelper(nStartIndex + i, dc, dcMem);</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">SelectBitmap</a>(hBitmapSave);</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;            m_arrVistaBitmap.Add(hBitmap);</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;        }</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    }</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160; </div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    <span class="keywordtype">void</span> _AddVistaBitmapFromImageList(<span class="keywordtype">int</span> nIndex)</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    {</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        <span class="comment">// Create display compatible memory DC</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;        CClientDC dc(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;        <a class="code" href="namespace_w_t_l.html#a9d9270441c3af66228d8a31df299c746">CDC</a> dcMem;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        dcMem.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a0f929e770321e607931627b973bdb67a">CreateCompatibleDC</a>(dc);</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        HBITMAP hBitmapSave = dcMem.GetCurrentBitmap();</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160; </div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        <span class="comment">// Create bitmap for menu item</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;        HBITMAP hBitmap = pT-&gt;_CreateVistaBitmapHelper(nIndex, dc, dcMem);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160; </div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;        <span class="comment">// Select saved bitmap back and add bitmap to the array</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;        dcMem.SelectBitmap(hBitmapSave);</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        m_arrVistaBitmap.Add(hBitmap);</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    }</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160; </div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <span class="keywordtype">void</span> _ReplaceVistaBitmapFromImageList(<span class="keywordtype">int</span> nIndex)</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    {</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        <span class="comment">// Delete existing bitmap</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;        <span class="keywordflow">if</span>(m_arrVistaBitmap[nIndex] != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;            ::DeleteObject(m_arrVistaBitmap[nIndex]);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160; </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;        <span class="comment">// Create display compatible memory DC</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        CClientDC dc(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        <a class="code" href="namespace_w_t_l.html#a9d9270441c3af66228d8a31df299c746">CDC</a> dcMem;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        dcMem.CreateCompatibleDC(dc);</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        HBITMAP hBitmapSave = dcMem.GetCurrentBitmap();</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160; </div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        <span class="comment">// Create bitmap for menu item</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        HBITMAP hBitmap = pT-&gt;_CreateVistaBitmapHelper(nIndex, dc, dcMem);</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160; </div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        <span class="comment">// Select saved bitmap back and replace bitmap in the array</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;        dcMem.SelectBitmap(hBitmapSave);</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        m_arrVistaBitmap.SetAtIndex(nIndex, hBitmap);</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    }</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    HBITMAP _CreateVistaBitmapHelper(<span class="keywordtype">int</span> nIndex, HDC hDCSource, HDC hDCTarget)</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    {</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        <span class="comment">// Create 32-bit bitmap</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        BITMAPINFO bi = { 0 };</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        bi.bmiHeader.biSize = <span class="keyword">sizeof</span>(BITMAPINFOHEADER);</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        bi.bmiHeader.biWidth = m_szBitmap.cx;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        bi.bmiHeader.biHeight = m_szBitmap.cy;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        bi.bmiHeader.biPlanes = 1;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        bi.bmiHeader.biBitCount = 32;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        bi.bmiHeader.biCompression = BI_RGB;</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        bi.bmiHeader.biSizeImage = 0;</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        bi.bmiHeader.biXPelsPerMeter = 0;</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        bi.bmiHeader.biYPelsPerMeter = 0;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        bi.bmiHeader.biClrUsed = 0;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        bi.bmiHeader.biClrImportant = 0;</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        HBITMAP hBitmap = ::CreateDIBSection(hDCSource, &amp;bi, DIB_RGB_COLORS, <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        ATLASSERT(hBitmap != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160; </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <span class="comment">// Select bitmap into target DC and draw from image list to it</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        <span class="keywordflow">if</span>(hBitmap != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        {</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;            ::SelectObject(hDCTarget, hBitmap);</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160; </div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;            IMAGELISTDRAWPARAMS ildp = { 0 };</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;            ildp.cbSize = <span class="keyword">sizeof</span>(IMAGELISTDRAWPARAMS);</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;            ildp.himl = m_hImageList;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;            ildp.i = nIndex;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            ildp.hdcDst = hDCTarget;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;            ildp.x = 0;</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;            ildp.y = 0;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;            ildp.cx = 0;</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;            ildp.cy = 0;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;            ildp.xBitmap = 0;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;            ildp.yBitmap = 0;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;            ildp.fStyle = ILD_TRANSPARENT;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;            ildp.fState = ILS_ALPHA;</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;            ildp.Frame = 255;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            ::ImageList_DrawIndirect(&amp;ildp);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        }</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <span class="keywordflow">return</span> hBitmap;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;    }</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;    <span class="keywordtype">void</span> _RemoveVistaBitmapsFromMenu()</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;    {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        <a class="code" href="namespace_w_t_l.html#adb4da30642a00b14bd247de2a13b56d3">CMenuHandle</a> menu = m_hMenu;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; m_arrCommand.GetSize(); i++)</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        {</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;            CMenuItemInfo mii;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;            mii.fMask = MIIM_BITMAP;</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            mii.hbmpItem = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;            menu.SetMenuItemInfo(m_arrCommand[i], <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, &amp;mii);</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    }</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _WTL_CMDBAR_VISTA_MENUS</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;};</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160; </div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160; </div>
<div class="line"><a name="l03257"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_command_bar_ctrl.html"> 3257</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl.html">CCommandBarCtrl</a> : <span class="keyword">public</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">CCommandBarCtrlImpl</a>&lt;CCommandBarCtrl&gt;</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;{</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    DECLARE_WND_SUPERCLASS(_T(<span class="stringliteral">&quot;WTL_CommandBar&quot;</span>), GetWndClassName())</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;};</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160; </div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160; </div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment">// CMDICommandBarCtrl - ATL implementation of Command Bars for MDI apps</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160; </div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T, <span class="keyword">class</span> TBase = CCommandBarCtrlBase, <span class="keyword">class</span> TWinTraits = ATL::CControlWinTraits&gt;</div>
<div class="line"><a name="l03268"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html"> 3268</a></span>&#160;<span class="keyword">class </span>ATL_NO_VTABLE <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html">CMDICommandBarCtrlImpl</a> : <span class="keyword">public</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">CCommandBarCtrlImpl</a>&lt; T, TBase, TWinTraits&gt;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;{</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;<span class="comment">// Data members</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a57492585af2ccfd02ca3e5ce225ba74e"> 3272</a></span>&#160;    ATL::CContainedWindow <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a57492585af2ccfd02ca3e5ce225ba74e">m_wndMDIClient</a>;</div>
<div class="line"><a name="l03273"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ad733ff7d91a627290d2448a198f8fa21"> 3273</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ad733ff7d91a627290d2448a198f8fa21">m_bChildMaximized</a>;</div>
<div class="line"><a name="l03274"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2506ef0a2d22c23c2a66bf9bebaa9674"> 3274</a></span>&#160;    HWND <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2506ef0a2d22c23c2a66bf9bebaa9674">m_hWndChildMaximized</a>;</div>
<div class="line"><a name="l03275"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2b4f6b61184648f835698fe34e9320f8"> 3275</a></span>&#160;    HICON <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2b4f6b61184648f835698fe34e9320f8">m_hIconChildMaximized</a>;</div>
<div class="line"><a name="l03276"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ac7a58b3eba4c10fd39f0e956170d5b4c"> 3276</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ac7a58b3eba4c10fd39f0e956170d5b4c">m_nBtnPressed</a>;</div>
<div class="line"><a name="l03277"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ef71986325b3b8b79aeff54fe224599"> 3277</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ef71986325b3b8b79aeff54fe224599">m_nBtnWasPressed</a>;</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160; </div>
<div class="line"><a name="l03279"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab0e78e7d3d7a13d43e5ccc88e2fd8b2c"> 3279</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab0e78e7d3d7a13d43e5ccc88e2fd8b2c">m_cxyOffset</a>;      <span class="comment">// offset between nonclient elements</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a02b1e962e1e2e78197795241d54e11df"> 3280</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a02b1e962e1e2e78197795241d54e11df">m_cxIconWidth</a>;    <span class="comment">// small icon width</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1447cce4709295e4bcd073100abd61e4"> 3281</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1447cce4709295e4bcd073100abd61e4">m_cyIconHeight</a>;   <span class="comment">// small icon height</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#acb4fd1ffdc55387f7ad379da1cfc46e9"> 3282</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#acb4fd1ffdc55387f7ad379da1cfc46e9">m_cxBtnWidth</a>;     <span class="comment">// nonclient button width</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a6cdf638f1c768f2d37066ce7741e2a3f"> 3283</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a6cdf638f1c768f2d37066ce7741e2a3f">m_cyBtnHeight</a>;    <span class="comment">// nonclient button height</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a07a24dd90cc998b5e8e3d0dd3a9847d6"> 3284</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a07a24dd90cc998b5e8e3d0dd3a9847d6">m_cxLeft</a>;         <span class="comment">// left nonclient area width</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1c23c45c3e0f53285136e9f6d7a34938"> 3285</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1c23c45c3e0f53285136e9f6d7a34938">m_cxRight</a>;        <span class="comment">// right nonclient area width</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160; </div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;<span class="comment">// Theme declarations and data members</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<span class="preprocessor">#ifndef _UXTHEME_H_</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b51f7d9c83a4107c0e17d2d672aa858"> 3290</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="namespacepyboost_1_1constants.html#a070dc5ed54c8bb6f599e426fe8657f0a">HANDLE</a> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b51f7d9c83a4107c0e17d2d672aa858">HTHEME</a>;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_UXTHEME_H_</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#aa83c88c8130b413fd293f086ab231d6e"> 3292</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b51f7d9c83a4107c0e17d2d672aa858">HTHEME</a> (STDAPICALLTYPE *PFN_OpenThemeData)(HWND hwnd, LPCWSTR pszClassList);</div>
<div class="line"><a name="l03293"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a297a50ab56c1494dec194ae3ce76a132"> 3293</a></span>&#160;    <span class="keyword">typedef</span> HRESULT (STDAPICALLTYPE *PFN_CloseThemeData)(<a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b51f7d9c83a4107c0e17d2d672aa858">HTHEME</a> hTheme);</div>
<div class="line"><a name="l03294"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a8bf4a4770b0cde4ff2e059bf93cb7d18"> 3294</a></span>&#160;    <span class="keyword">typedef</span> HRESULT (STDAPICALLTYPE *PFN_DrawThemeBackground)(<a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b51f7d9c83a4107c0e17d2d672aa858">HTHEME</a> hTheme, HDC hdc, <span class="keywordtype">int</span> iPartId, <span class="keywordtype">int</span> iStateId, <span class="keyword">const</span> RECT *pRect, OPTIONAL <span class="keyword">const</span> RECT *pClipRect);</div>
<div class="line"><a name="l03295"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a5f128c4120d6133ada3780ea891a1e07"> 3295</a></span>&#160;    <span class="keyword">typedef</span> HRESULT (STDAPICALLTYPE *PFN_DrawThemeParentBackground)(HWND hwnd, HDC hdc, OPTIONAL RECT* prc);</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160; </div>
<div class="line"><a name="l03297"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab80c7d3ea4c2eea370cf0d4bd32cb96f"> 3297</a></span>&#160;    HMODULE <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab80c7d3ea4c2eea370cf0d4bd32cb96f">m_hThemeDLL</a>;</div>
<div class="line"><a name="l03298"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a43695304235f94d44727b0530303ee67"> 3298</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b51f7d9c83a4107c0e17d2d672aa858">HTHEME</a> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a43695304235f94d44727b0530303ee67">m_hTheme</a>;</div>
<div class="line"><a name="l03299"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a813aff62ddc3481213d8b6249d808b94"> 3299</a></span>&#160;    PFN_DrawThemeBackground <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a813aff62ddc3481213d8b6249d808b94">m_pfnDrawThemeBackground</a>;</div>
<div class="line"><a name="l03300"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a033ff5206752aa0215546990a2895c6e"> 3300</a></span>&#160;    PFN_DrawThemeParentBackground <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a033ff5206752aa0215546990a2895c6e">m_pfnDrawThemeParentBackground</a>;</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160; </div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;<span class="comment">// Constructor/destructor</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#aa8c1860a2fe17b684c6de017df2ac8b1"> 3304</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#aa8c1860a2fe17b684c6de017df2ac8b1">CMDICommandBarCtrlImpl</a>() : </div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            m_wndMDIClient(this, 2), m_bChildMaximized(false), </div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            m_hWndChildMaximized(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), m_hIconChildMaximized(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), </div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;            m_nBtnPressed(-1), m_nBtnWasPressed(-1),</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;#ifndef _WTL_NO_AUTO_THEME</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;            m_hThemeDLL(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), m_hTheme(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), m_pfnDrawThemeBackground(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), m_pfnDrawThemeParentBackground(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>), </div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;#endif <span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;            m_cxyOffset(2),</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;            m_cxIconWidth(16), m_cyIconHeight(16),</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;            m_cxBtnWidth(16), m_cyBtnHeight(14),</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;            m_cxLeft(20), m_cxRight(55)</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    { }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; </div>
<div class="line"><a name="l03317"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a84e9b386041ded037722cdaba57af761"> 3317</a></span>&#160;    <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a84e9b386041ded037722cdaba57af761">~CMDICommandBarCtrlImpl</a>()</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    {</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;        <span class="keywordflow">if</span>(m_wndMDIClient.IsWindow())</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="comment">/*scary!*/</span>          m_wndMDIClient.UnsubclassWindow();</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    }</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160; </div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">// Operations</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a81ccc7dc9cf43c480ec2195bfbb4bb4e"> 3324</a></span>&#160;    <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a81ccc7dc9cf43c480ec2195bfbb4bb4e">SetMDIClient</a>(HWND hWndMDIClient)</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    {</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;        ATLASSERT(::IsWindow(m_hWnd));</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        ATLASSERT(::IsWindow(hWndMDIClient));</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        <span class="keywordflow">if</span>(!::IsWindow(hWndMDIClient))</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160; </div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;<span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        <span class="comment">// BLOCK: Test if the passed window is MDICLIENT</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;        {</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;            LPCTSTR lpszMDIClientClass = _T(<span class="stringliteral">&quot;MDICLIENT&quot;</span>);</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nNameLen = 9 + 1;   <span class="comment">// &quot;MDICLIENT&quot; + NULL</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;            TCHAR szClassName[nNameLen] = { 0 };</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;            ::GetClassName(hWndMDIClient, szClassName, nNameLen);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;            ATLASSERT(lstrcmpi(szClassName, lpszMDIClientClass) == 0);</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        }</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// _DEBUG</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160; </div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;        <span class="keywordflow">if</span>(m_wndMDIClient.IsWindow())</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="comment">/*scary!*/</span>      m_wndMDIClient.UnsubclassWindow();</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160; </div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        <span class="keywordflow">return</span> m_wndMDIClient.SubclassWindow(hWndMDIClient);</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    }</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment">// Message maps</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#abcb48c2b847714802ed707eddc1457eb"> 3349</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">CCommandBarCtrlImpl&lt; T, TBase, TWinTraits &gt;</a>   <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#abcb48c2b847714802ed707eddc1457eb">_baseClass</a>;</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    BEGIN_MSG_MAP(<a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html">CMDICommandBarCtrlImpl</a>)</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        MESSAGE_HANDLER(WM_CREATE, OnCreate)</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        MESSAGE_HANDLER(WM_DESTROY, OnDestroy)</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;        MESSAGE_HANDLER(_GetThemeChangedMsg(), OnThemeChanged)</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        MESSAGE_HANDLER(WM_SIZE, OnSize)</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        MESSAGE_HANDLER(WM_NCCALCSIZE, OnNcCalcSize)</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        MESSAGE_HANDLER(WM_NCPAINT, OnNcPaint)</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        MESSAGE_HANDLER(WM_NCHITTEST, OnNcHitTest)</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        MESSAGE_HANDLER(WM_NCLBUTTONDOWN, OnNcLButtonDown)</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        MESSAGE_HANDLER(WM_MOUSEMOVE, OnMouseMove)</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;        MESSAGE_HANDLER(WM_LBUTTONUP, OnLButtonUp)</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        MESSAGE_HANDLER(WM_NCLBUTTONDBLCLK, OnNcLButtonDblClk)</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        MESSAGE_HANDLER(WM_CAPTURECHANGED, OnCaptureChanged)</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        CHAIN_MSG_MAP(<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">_baseClass</a>)</div>
<div class="line"><a name="l03366"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a664908bd9fa2760f3f6f20220436fba9"> 3366</a></span>&#160;    ALT_MSG_MAP(1)   <span class="comment">// Parent window messages</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;        MESSAGE_HANDLER(WM_ACTIVATE, OnParentActivate)</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        CHAIN_MSG_MAP_ALT(<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">_baseClass</a>, 1)</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    ALT_MSG_MAP(2)   <span class="comment">// MDI client window messages</span></div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        MESSAGE_HANDLER(WM_MDISETMENU, OnMDISetMenu)</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;        <span class="comment">// no chaining needed since this was moved from the base class here</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;    ALT_MSG_MAP(3)   <span class="comment">// Message hook messages</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;        MESSAGE_RANGE_HANDLER(0, 0xFFFF, OnAllHookMessages)</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;        CHAIN_MSG_MAP_ALT(<a class="code" href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">_baseClass</a>, 3)</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;    END_MSG_MAP()</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160; </div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="comment">// Additional MDI message handlers</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a902f70b98c8d238a3d989d550333f035"> 3378</a></span>&#160;    LRESULT OnCreate(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    {</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        LRESULT lRet = _baseClass::OnCreate(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l03381"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a5a4a92c3b05b3908242dfe5096655d08"> 3381</a></span>&#160;        <span class="keywordflow">if</span>(lRet == (LRESULT)-1)</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;            <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160; </div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;        <span class="comment">// this will fail if theming is not supported</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ae04f591fa89a32ec2da6b7dfb0ee8009"> 3386</a></span>&#160;        m_hThemeDLL = ::LoadLibrary(_T(<span class="stringliteral">&quot;uxtheme.dll&quot;</span>));</div>
<div class="line"><a name="l03387"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ae421b0cf28a28ecfadec8546f307bbaa"> 3387</a></span>&#160;        <span class="keywordflow">if</span>(m_hThemeDLL != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;        {</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;            m_pfnDrawThemeBackground = (PFN_DrawThemeBackground)::GetProcAddress(m_hThemeDLL, <span class="stringliteral">&quot;DrawThemeBackground&quot;</span>);</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            ATLASSERT(m_pfnDrawThemeBackground != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;            <span class="keywordflow">if</span>(m_pfnDrawThemeBackground != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            {</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                pT-&gt;_OpenThemeData();</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            }</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;            {</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                ::FreeLibrary(m_hThemeDLL);</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                m_hThemeDLL = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;            }</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;            m_pfnDrawThemeParentBackground = (PFN_DrawThemeParentBackground)::GetProcAddress(m_hThemeDLL, <span class="stringliteral">&quot;DrawThemeParentBackground&quot;</span>);</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;            ATLASSERT(m_pfnDrawThemeParentBackground != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        }</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160; </div>
<div class="line"><a name="l03406"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b2303588f16b9d23715848cf3d16afb"> 3406</a></span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b2303588f16b9d23715848cf3d16afb">lRet</a>;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160; </div>
<div class="line"><a name="l03409"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2496caa3fbde2f03cf212e19ba81bf2d"> 3409</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2496caa3fbde2f03cf212e19ba81bf2d">OnDestroy</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    {</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;        LRESULT lRet = _baseClass::OnDestroy(uMsg, wParam, lParam, bHandled);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160; </div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        <span class="keywordflow">if</span>(m_hThemeDLL != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        {</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;            pT-&gt;_CloseThemeData();</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;            ::FreeLibrary(m_hThemeDLL);</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;            m_hThemeDLL = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;        }</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160; </div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;    }</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160; </div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#af6b7ed3d93129f7ce0f9a638ece0e760"> 3427</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#af6b7ed3d93129f7ce0f9a638ece0e760">OnThemeChanged</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    {</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;        <span class="keywordflow">if</span>(m_hThemeDLL != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;        {</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;            pT-&gt;_CloseThemeData();</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;            pT-&gt;_OpenThemeData();</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;        }</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    }</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160; </div>
<div class="line"><a name="l03439"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#af8c8ebae372e6f091de79ae666e2f864"> 3439</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#af8c8ebae372e6f091de79ae666e2f864">OnSize</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    {</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;        LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;        pT-&gt;_AdjustBtnSize(<a class="code" href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a>(lParam));</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    }</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160; </div>
<div class="line"><a name="l03447"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a31240ee53b951ff8ac4ca3c47c110252"> 3447</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a31240ee53b951ff8ac4ca3c47c110252">OnNcCalcSize</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    {</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;        LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160; </div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;        <span class="keywordflow">if</span>(m_bChildMaximized &amp;&amp; (<a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>)wParam)</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        {</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;            LPNCCALCSIZE_PARAMS lpParams = (LPNCCALCSIZE_PARAMS)lParam;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;            <span class="keywordflow">if</span>(m_bLayoutRTL)</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            {</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                lpParams-&gt;rgrc[0].left += m_cxRight;</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                lpParams-&gt;rgrc[0].right -= m_cxLeft;</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;            }</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;            {</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                lpParams-&gt;rgrc[0].left += m_cxLeft;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                lpParams-&gt;rgrc[0].right -= m_cxRight;</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;            }</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;        }</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160; </div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    }</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160; </div>
<div class="line"><a name="l03469"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a6e09286ac28474eaaf862217228e1bcb"> 3469</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a6e09286ac28474eaaf862217228e1bcb">OnNcPaint</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160; </div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        <span class="keywordflow">if</span>(!m_bChildMaximized)</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;            <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; </div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        ATLASSERT(m_hWndChildMaximized != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; m_hIconChildMaximized != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160; </div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        <span class="comment">// get DC and window rectangle</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        <a class="code" href="class_w_t_l_1_1_c_window_d_c.html">CWindowDC</a> dc(m_hWnd);</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        RECT rect;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;        <span class="keywordtype">int</span> cxWidth = rect.right - rect.left;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;        <span class="keywordtype">int</span> cyHeight = rect.bottom - rect.top;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160; </div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        <span class="comment">// paint left side nonclient background and draw icon</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        ::SetRect(&amp;rect, 0, 0, m_cxLeft, cyHeight);</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        <span class="keywordflow">if</span>(m_hTheme != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        {</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;            <span class="keywordflow">if</span>(m_pfnDrawThemeParentBackground != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                m_pfnDrawThemeParentBackground(m_hWnd, dc, &amp;rect);</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rect, COLOR_WINDOW);</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        }</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;        {</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;            <span class="keywordflow">if</span>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a54def69e13b608d7681d597d1c4d0c00">CBR_EX_TRANSPARENT</a>) != 0)</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rect, COLOR_3DFACE);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rect, COLOR_MENU);</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;        }</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160; </div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        RECT rcIcon = { 0 };</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        pT-&gt;_CalcIconRect(cxWidth, cyHeight, rcIcon);</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a250d67d0c53b4cb902bb3c432ef04a9a">DrawIconEx</a>(rcIcon.left, rcIcon.top, m_hIconChildMaximized, m_cxIconWidth, m_cyIconHeight);</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160; </div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        <span class="comment">// paint right side nonclient background</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        ::SetRect(&amp;rect, cxWidth - m_cxRight, 0, cxWidth, cyHeight);</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        <span class="keywordflow">if</span>(m_hTheme != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;        {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            <span class="keywordflow">if</span>(m_pfnDrawThemeParentBackground != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;            {</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;                <span class="comment">// this is to account for the left non-client area</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                POINT ptOrg = { 0, 0 };</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#ad058a0be4792f8b24f27bff74166c0db">GetViewportOrg</a>(&amp;ptOrg);</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8600f4b8d3f58a8838b3ab7973b326ba">SetViewportOrg</a>(ptOrg.x + m_cxLeft, ptOrg.y);</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                ::OffsetRect(&amp;rect, -m_cxLeft, 0);</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160; </div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;                m_pfnDrawThemeParentBackground(m_hWnd, dc, &amp;rect);</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160; </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;                <span class="comment">// restore</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a8600f4b8d3f58a8838b3ab7973b326ba">SetViewportOrg</a>(ptOrg);</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;                ::OffsetRect(&amp;rect, m_cxLeft, 0);</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;            }</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;            {</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rect, COLOR_3DFACE);</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;            }</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;        }</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        {</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;            <span class="keywordflow">if</span>((m_dwExtendedStyle &amp; <a class="code" href="atlctrlw_8h.html#a54def69e13b608d7681d597d1c4d0c00">CBR_EX_TRANSPARENT</a>) != 0)</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rect, COLOR_3DFACE);</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">FillRect</a>(&amp;rect, COLOR_MENU);</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        }</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160; </div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        <span class="comment">// draw buttons</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;        RECT arrRect[3] = { 0 };</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;        pT-&gt;_CalcBtnRects(cxWidth, cyHeight, arrRect);</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        pT-&gt;_DrawMDIButton(dc, arrRect, -1);   <span class="comment">// draw all buttons</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; </div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    }</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160; </div>
<div class="line"><a name="l03550"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a87f633c6b34c29035a3ef59659f3b42a"> 3550</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a87f633c6b34c29035a3ef59659f3b42a">OnNcHitTest</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    {</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;        LRESULT lRet = DefWindowProc(uMsg, wParam, lParam);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        <span class="keywordflow">if</span>(m_bChildMaximized)</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        {</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            RECT rect = { 0 };</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;            POINT <a class="code" href="structpt.html">pt</a> = { <a class="code" href="atlapp_8h.html#ac503b7bea1053172cf5044a25c266f9a">GET_X_LPARAM</a>(lParam) - rect.left, <a class="code" href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a>(lParam) - rect.top };</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;            <span class="keywordflow">if</span>(m_bLayoutRTL)</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            {</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                <span class="keywordflow">if</span>((<a class="code" href="structpt.html">pt</a>.x &lt; m_cxRight) || (<a class="code" href="structpt.html">pt</a>.x &gt; ((rect.right - rect.left) - m_cxLeft)))</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                    lRet = HTBORDER;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;            }</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;            {</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;                <span class="keywordflow">if</span>((<a class="code" href="structpt.html">pt</a>.x &lt; m_cxLeft) || (<a class="code" href="structpt.html">pt</a>.x &gt; ((rect.right - rect.left) - m_cxRight)))</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                    lRet = HTBORDER;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;            }</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        }</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;        <span class="keywordflow">return</span> lRet;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    }</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160; </div>
<div class="line"><a name="l03572"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a28589ccc80904106d9d8a54832b5c2ed"> 3572</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a28589ccc80904106d9d8a54832b5c2ed">OnNcLButtonDown</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    {</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;        <span class="keywordflow">if</span>(!m_bChildMaximized)</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;        {</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;        }</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160; </div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;        ATLASSERT(_DebugCheckChild());</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160; </div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;        POINT <a class="code" href="structpt.html">pt</a> = { <a class="code" href="atlapp_8h.html#ac503b7bea1053172cf5044a25c266f9a">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a>(lParam) };</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        RECT rect = { 0 };</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;        GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;        <a class="code" href="structpt.html">pt</a>.x -= rect.left;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;        <a class="code" href="structpt.html">pt</a>.y -= rect.top;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160; </div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;        RECT rcIcon = { 0 };</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;        pT-&gt;_CalcIconRect(rect.right - rect.left, rect.bottom - rect.top, rcIcon, m_bLayoutRTL);</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;        RECT arrRect[3] = { 0 };</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;        pT-&gt;_CalcBtnRects(rect.right - rect.left, rect.bottom - rect.top, arrRect, m_bLayoutRTL);</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160; </div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;        <span class="keywordflow">if</span>(::PtInRect(&amp;rcIcon, <a class="code" href="structpt.html">pt</a>))</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;        {</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - LButtonDown: icon\n&quot;</span>));</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;<span class="preprocessor">#ifndef TPM_VERPOSANIMATION</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            <span class="keyword">const</span> UINT TPM_VERPOSANIMATION = 0x1000L;   <span class="comment">// Menu animation flag</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> menu = ::GetSystemMenu(m_hWndChildMaximized, <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;            UINT uRet = (UINT)menu.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#ad39994137b1b3da8451f9b24b27a4d05">TrackPopupMenu</a>(TPM_LEFTBUTTON | TPM_VERTICAL | TPM_LEFTALIGN | TPM_TOPALIGN | TPM_RETURNCMD |  </div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                (s_bW2K ? TPM_VERPOSANIMATION : 0), m_bLayoutRTL ? rect.right : rect.left, rect.bottom, m_hWndChildMaximized);</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160; </div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;            <span class="comment">// eat next message if click is on the same button</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;            ::OffsetRect(&amp;rcIcon, rect.left, rect.top);</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;            MSG msg = { 0 };</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;            <span class="keywordflow">if</span>(::PeekMessage(&amp;msg, m_hWnd, WM_NCLBUTTONDOWN, WM_NCLBUTTONDOWN, PM_NOREMOVE) &amp;&amp; ::PtInRect(&amp;rcIcon, msg.pt))</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                ::PeekMessage(&amp;msg, m_hWnd, WM_NCLBUTTONDOWN, WM_NCLBUTTONDOWN, PM_REMOVE);</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160; </div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;            <span class="keywordflow">if</span>(uRet != 0)</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                ::SendMessage(m_hWndChildMaximized, WM_SYSCOMMAND, uRet, 0L);</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        }</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(::PtInRect(&amp;arrRect[0], <a class="code" href="structpt.html">pt</a>))</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;        {</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - LButtonDown: close button\n&quot;</span>));</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;            m_nBtnWasPressed = m_nBtnPressed = 0;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;        }</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(::PtInRect(&amp;arrRect[1], <a class="code" href="structpt.html">pt</a>))</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;        {</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - LButtonDown: restore button\n&quot;</span>));</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;            m_nBtnWasPressed = m_nBtnPressed = 1;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;        }</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(::PtInRect(&amp;arrRect[2], <a class="code" href="structpt.html">pt</a>))</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        {</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - LButtonDown: minimize button\n&quot;</span>));</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;            m_nBtnWasPressed = m_nBtnPressed = 2;</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;        }</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        {</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;        }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160; </div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        <span class="comment">// draw the button state if it was pressed</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;        <span class="keywordflow">if</span>(m_nBtnPressed != -1)</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        {</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;            SetCapture();</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_window_d_c.html">CWindowDC</a> dc(m_hWnd);</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;            pT-&gt;_CalcBtnRects(rect.right - rect.left, rect.bottom - rect.top, arrRect);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;            pT-&gt;_DrawMDIButton(dc, arrRect, m_nBtnPressed);</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;        }</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160; </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    }</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160; </div>
<div class="line"><a name="l03653"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a15f47ebc13fac72c54cc8d8f83619769"> 3653</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a15f47ebc13fac72c54cc8d8f83619769">OnMouseMove</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    {</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;        <span class="keywordflow">if</span>(!m_bChildMaximized || ::GetCapture() != m_hWnd || m_nBtnWasPressed == -1)</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;        {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;        }</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160; </div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;        POINT <a class="code" href="structpt.html">pt</a> = { <a class="code" href="atlapp_8h.html#ac503b7bea1053172cf5044a25c266f9a">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a>(lParam) };</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;        ClientToScreen(&amp;<a class="code" href="structpt.html">pt</a>);</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;        RECT rect = { 0 };</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;        GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;        <a class="code" href="structpt.html">pt</a>.x -= rect.left;</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        <a class="code" href="structpt.html">pt</a>.y -= rect.top;</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;        RECT arrRect[3] = { 0 };</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;        pT-&gt;_CalcBtnRects(rect.right - rect.left, rect.bottom - rect.top, arrRect, m_bLayoutRTL);</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;        <span class="keywordtype">int</span> nOldBtnPressed = m_nBtnPressed;</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;        m_nBtnPressed = ::PtInRect(&amp;arrRect[m_nBtnWasPressed], <a class="code" href="structpt.html">pt</a>) ? m_nBtnWasPressed : -1;</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;        <span class="keywordflow">if</span>(nOldBtnPressed != m_nBtnPressed)</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;        {</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_window_d_c.html">CWindowDC</a> dc(m_hWnd);</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;            pT-&gt;_CalcBtnRects(rect.right - rect.left, rect.bottom - rect.top, arrRect);</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;            pT-&gt;_DrawMDIButton(dc, arrRect, (m_nBtnPressed != -1) ? m_nBtnPressed : nOldBtnPressed);</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        }</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160; </div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;    }</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160; </div>
<div class="line"><a name="l03682"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a90cdaa835e87214b491a2e7c67170f33"> 3682</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a90cdaa835e87214b491a2e7c67170f33">OnLButtonUp</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    {</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;        <span class="keywordflow">if</span>(!m_bChildMaximized || ::GetCapture() != m_hWnd || m_nBtnWasPressed == -1)</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;        {</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;        }</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160; </div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;        ATLASSERT(_DebugCheckChild());</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160; </div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;        POINT <a class="code" href="structpt.html">pt</a> = { <a class="code" href="atlapp_8h.html#ac503b7bea1053172cf5044a25c266f9a">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a>(lParam) };</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;        ClientToScreen(&amp;<a class="code" href="structpt.html">pt</a>);</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;        RECT rect = { 0 };</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;        GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;        <a class="code" href="structpt.html">pt</a>.x -= rect.left;</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;        <a class="code" href="structpt.html">pt</a>.y -= rect.top;</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160; </div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;        <span class="keywordtype">int</span> nBtn = m_nBtnWasPressed;</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;        ReleaseCapture();</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160; </div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;        RECT arrRect[3] = { 0 };</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;        pT-&gt;_CalcBtnRects(rect.right - rect.left, rect.bottom - rect.top, arrRect, m_bLayoutRTL);</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;        <span class="keywordflow">if</span>(::PtInRect(&amp;arrRect[nBtn], <a class="code" href="structpt.html">pt</a>))</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;        {</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;            <span class="keywordflow">switch</span>(nBtn)</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;            {</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;            <span class="keywordflow">case</span> 0:     <span class="comment">// close</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;                ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - LButtonUp: close button\n&quot;</span>));</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;                ::SendMessage(m_hWndChildMaximized, WM_SYSCOMMAND, SC_CLOSE, 0L);</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;            <span class="keywordflow">case</span> 1:     <span class="comment">// restore</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - LButtonUp: restore button\n&quot;</span>));</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                ::SendMessage(m_hWndChildMaximized, WM_SYSCOMMAND, SC_RESTORE, 0L);</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;            <span class="keywordflow">case</span> 2:     <span class="comment">// minimize</span></div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - LButtonUp: minimize button\n&quot;</span>));</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                ::SendMessage(m_hWndChildMaximized, WM_SYSCOMMAND, SC_MINIMIZE, 0L);</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            }</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        }</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160; </div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    }</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160; </div>
<div class="line"><a name="l03735"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a334af570b0840915eff7204f164dc521"> 3735</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a334af570b0840915eff7204f164dc521">OnNcLButtonDblClk</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;    {</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;        <span class="keywordflow">if</span>(!m_bChildMaximized || m_nBtnWasPressed != -1)</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;        {</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;        }</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160; </div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        ATLASSERT(_DebugCheckChild());</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160; </div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        POINT <a class="code" href="structpt.html">pt</a> = { <a class="code" href="atlapp_8h.html#ac503b7bea1053172cf5044a25c266f9a">GET_X_LPARAM</a>(lParam), <a class="code" href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a>(lParam) };</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;        RECT rect = { 0 };</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;        <a class="code" href="structpt.html">pt</a>.x -= rect.left;</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;        <a class="code" href="structpt.html">pt</a>.y -= rect.top;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160; </div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        RECT rcIcon = { 0 };</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;        pT-&gt;_CalcIconRect(rect.right - rect.left, rect.bottom - rect.top, rcIcon, m_bLayoutRTL);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;        RECT arrRect[3] = { 0 };</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        pT-&gt;_CalcBtnRects(rect.right - rect.left, rect.bottom - rect.top, arrRect, m_bLayoutRTL);</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160; </div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;        <span class="keywordflow">if</span>(::PtInRect(&amp;rcIcon, <a class="code" href="structpt.html">pt</a>))</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;        {</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;            <a class="code" href="class_w_t_l_1_1_c_menu_t.html">CMenuHandle</a> menu = ::GetSystemMenu(m_hWndChildMaximized, <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;            UINT uDefID = menu.<a class="code" href="class_w_t_l_1_1_c_menu_t.html#a301f5ecaa30d4fae79808b97772fa56f">GetMenuDefaultItem</a>();</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;            <span class="keywordflow">if</span>(uDefID == (UINT)-1)</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                uDefID = SC_CLOSE;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;            ::SendMessage(m_hWndChildMaximized, WM_SYSCOMMAND, uDefID, 0L);</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        }</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160; </div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;    }</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160; </div>
<div class="line"><a name="l03769"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a7859bcf13bf430f301fe1c54aec1dc19"> 3769</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a7859bcf13bf430f301fe1c54aec1dc19">OnCaptureChanged</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    {</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;        <span class="keywordflow">if</span>(m_bChildMaximized)</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        {</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;            <span class="keywordflow">if</span>(m_nBtnPressed != -1)</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;            {</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                ATLASSERT(m_nBtnPressed == m_nBtnWasPressed);   <span class="comment">// must be</span></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;                m_nBtnPressed = -1;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;                RECT rect = { 0 };</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                RECT arrRect[3] = { 0 };</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;                T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                pT-&gt;_CalcBtnRects(rect.right - rect.left, rect.bottom - rect.top, arrRect);</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                <a class="code" href="class_w_t_l_1_1_c_window_d_c.html">CWindowDC</a> dc(m_hWnd);</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                pT-&gt;_DrawMDIButton(dc, arrRect, m_nBtnWasPressed);</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;            }</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;            m_nBtnWasPressed = -1;</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        }</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        {</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;            bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        }</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;    }</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160; </div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;<span class="comment">// Parent window message handlers</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ad671ad82988ee3200c0ae6f57cd54257"> 3795</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ad671ad82988ee3200c0ae6f57cd54257">OnParentActivate</a>(UINT <span class="comment">/*uMsg*/</span>, WPARAM wParam, LPARAM <span class="comment">/*lParam*/</span>, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;    {</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        m_bParentActive = (LOWORD(wParam) != WA_INACTIVE);</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        RedrawWindow(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, RDW_INVALIDATE | RDW_FRAME | RDW_UPDATENOW);</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;    }</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160; </div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="comment">// MDI client window message handlers</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab48feaf3420094f1462d88ac35acde72"> 3804</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab48feaf3420094f1462d88ac35acde72">OnMDISetMenu</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; <span class="comment">/*bHandled*/</span>)</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;    {</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;        m_wndMDIClient.DefWindowProc(uMsg, <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, lParam);</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;        HMENU hOldMenu = GetMenu();</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = AttachMenu((HMENU)wParam);</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;        bRet;   <span class="comment">// avoid level 4 warning</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;        ATLASSERT(bRet);</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160; </div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0400)</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;        pT-&gt;UpdateRebarBandIdealSize();</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &gt;= 0x0400)</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160; </div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;        <span class="keywordflow">return</span> (LRESULT)hOldMenu;</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;    }</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160; </div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="comment">// All messages from the message hook</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a251dc3dd218bee20c9cab5cbf3f3bd58"> 3821</a></span>&#160;    LRESULT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a251dc3dd218bee20c9cab5cbf3f3bd58">OnAllHookMessages</a>(UINT uMsg, WPARAM wParam, LPARAM lParam, <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a>&amp; bHandled)</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    {</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;        pT-&gt;_ProcessAllHookMessages(uMsg, wParam, lParam);</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160; </div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        bHandled = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    }</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160; </div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="comment">// Overrideables</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;    <span class="comment">// override this to provide different ideal size</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a87c26e87946df82fa4e4bf5b22d5c1e1"> 3832</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a87c26e87946df82fa4e4bf5b22d5c1e1">UpdateRebarBandIdealSize</a>()</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;    {</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;        <span class="comment">// assuming we are in a rebar, change ideal size to our size</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;        <span class="comment">// we hope that if we are not in a rebar, nCount will be 0</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        <span class="keywordtype">int</span> nCount = (<a class="code" href="namespacechecksum.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)::SendMessage(GetParent(), RB_GETBANDCOUNT, 0, 0L);</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nCount; i++)</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;        {</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;            REBARBANDINFO rbi = { <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ac0771dda0062021256c9946530324d97">RunTimeHelper::SizeOf_REBARBANDINFO</a>(), RBBIM_CHILD | RBBIM_CHILDSIZE | RBBIM_IDEALSIZE };</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;            ::SendMessage(GetParent(), RB_GETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;            <span class="keywordflow">if</span>(rbi.hwndChild == m_hWnd)</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            {</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;                rbi.fMask = RBBIM_IDEALSIZE;</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;                rbi.cxIdeal = m_bChildMaximized ? m_cxLeft + m_cxRight : 0;</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;                <span class="keywordtype">int</span> nBtnCount = GetButtonCount();</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;                <span class="keywordflow">if</span>(nBtnCount &gt; 0)</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;                {</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;                    RECT rect = { 0 };</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                    GetItemRect(nBtnCount - 1, &amp;rect);</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                    rbi.cxIdeal += rect.right;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                }</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;                ::SendMessage(GetParent(), RB_SETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;            }</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;        }</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    }</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160; </div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;    <span class="comment">// all hook messages - check for the maximized MDI child window change</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a508def142e1fe5514befa5f47e7a8b97"> 3859</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a508def142e1fe5514befa5f47e7a8b97">_ProcessAllHookMessages</a>(UINT uMsg, WPARAM <span class="comment">/*wParam*/</span>, LPARAM <span class="comment">/*lParam*/</span>)</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;    {</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;        <span class="keywordflow">if</span>(uMsg == WM_MDIGETACTIVE || uMsg == WM_MDISETMENU)</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160; </div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bMaximized = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        HWND hWndChild = (HWND)::SendMessage(m_wndMDIClient, WM_MDIGETACTIVE, 0, (LPARAM)&amp;bMaximized);</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;        <span class="keywordtype">bool</span> bMaxOld = m_bChildMaximized;</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;        m_bChildMaximized = (hWndChild != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; bMaximized);</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;        HICON hIconOld = m_hIconChildMaximized;</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160; </div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        <span class="keywordflow">if</span>(m_bChildMaximized)</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;        {</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;            <span class="keywordflow">if</span>(m_hWndChildMaximized != hWndChild)</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;            {</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;                ATL::CWindow wnd = m_hWndChildMaximized = hWndChild;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;                m_hIconChildMaximized = wnd.GetIcon(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;                <span class="keywordflow">if</span>(m_hIconChildMaximized == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;                {</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;                    m_hIconChildMaximized = wnd.GetIcon(<a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;                    <span class="keywordflow">if</span>(m_hIconChildMaximized == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;                    {</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                        <span class="comment">// no icon set with WM_SETICON, get the class one</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="comment">// need conditional code because types don&#39;t match in winuser.h</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;<span class="preprocessor">#ifdef _WIN64</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                        m_hIconChildMaximized = (HICON)::<a class="code" href="atlapp_8h.html#a6484b325f0b6005b6ca826abab935270">GetClassLongPtr</a>(wnd, <a class="code" href="atlapp_8h.html#a19d37f26db9a3e536b3e81979cde7b2b">GCLP_HICONSM</a>);</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;                        m_hIconChildMaximized = (HICON)<a class="code" href="atlapp_8h.html#a4599ee696a42cac2f19d588a816af70f">LongToHandle</a>(::<a class="code" href="atlapp_8h.html#a6484b325f0b6005b6ca826abab935270">GetClassLongPtr</a>(wnd, <a class="code" href="atlapp_8h.html#a19d37f26db9a3e536b3e81979cde7b2b">GCLP_HICONSM</a>));</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;                    }</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;                }</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;            }</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;        }</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;        {</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;            m_hWndChildMaximized = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;            m_hIconChildMaximized = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        }</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160; </div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;        <span class="keywordflow">if</span>(bMaxOld != m_bChildMaximized)</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;        {</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;            ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - All messages hook change: m_bChildMaximized = %s\n&quot;</span>), m_bChildMaximized ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;            <span class="comment">// assuming we are in a rebar, change our size to accomodate new state</span></div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;            <span class="comment">// we hope that if we are not in a rebar, nCount will be 0</span></div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;            <span class="keywordtype">int</span> nCount = (<a class="code" href="namespacechecksum.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)::SendMessage(GetParent(), RB_GETBANDCOUNT, 0, 0L);</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;            <span class="keywordtype">int</span> cxDiff = (m_bChildMaximized ? 1 : -1) * (m_cxLeft + m_cxRight);</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nCount; i++)</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;            {</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;<span class="preprocessor">#if (_WIN32_IE &gt;= 0x0500)</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;                REBARBANDINFO rbi = { <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ac0771dda0062021256c9946530324d97">RunTimeHelper::SizeOf_REBARBANDINFO</a>(), RBBIM_CHILD | RBBIM_CHILDSIZE | RBBIM_IDEALSIZE | RBBIM_STYLE };</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;                ::SendMessage(GetParent(), RB_GETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                <span class="keywordflow">if</span>(rbi.hwndChild == m_hWnd)</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                {</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                    <span class="keywordflow">if</span>((rbi.fStyle &amp; RBBS_USECHEVRON) != 0)</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                    {</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                        rbi.fMask = RBBIM_CHILDSIZE | RBBIM_IDEALSIZE;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;                        rbi.cxMinChild += cxDiff;</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                        rbi.cxIdeal += cxDiff;</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;                        ::SendMessage(GetParent(), RB_SETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;                    }</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;                }</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;<span class="preprocessor">#elif (_WIN32_IE &gt;= 0x0400)</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;                REBARBANDINFO rbi = { <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ac0771dda0062021256c9946530324d97">RunTimeHelper::SizeOf_REBARBANDINFO</a>(), RBBIM_CHILD | RBBIM_CHILDSIZE | RBBIM_IDEALSIZE };</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;                ::SendMessage(GetParent(), RB_GETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;                <span class="keywordflow">if</span>(rbi.hwndChild == m_hWnd)</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;                {</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;                    rbi.fMask = RBBIM_CHILDSIZE | RBBIM_IDEALSIZE;</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;                    rbi.cxMinChild += cxDiff;</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;                    rbi.cxIdeal += cxDiff;</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;                    ::SendMessage(GetParent(), RB_SETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                }</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="preprocessor">#else </span><span class="comment">// (_WIN32_IE &lt; 0x0400)</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                REBARBANDINFO rbi = { <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#ac0771dda0062021256c9946530324d97">RunTimeHelper::SizeOf_REBARBANDINFO</a>(), RBBIM_CHILD | RBBIM_CHILDSIZE };</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                ::SendMessage(GetParent(), RB_GETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                <span class="keywordflow">if</span>(rbi.hwndChild == m_hWnd)</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                {</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                    rbi.fMask = RBBIM_CHILDSIZE;</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                    rbi.cxMinChild += cxDiff;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                    ::SendMessage(GetParent(), RB_SETBANDINFO, i, (LPARAM)&amp;rbi);</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                }</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// (_WIN32_IE &lt; 0x0400)</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;            }</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;        }</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160; </div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;        <span class="keywordflow">if</span>(bMaxOld != m_bChildMaximized || hIconOld != m_hIconChildMaximized)</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;        {</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;            <span class="comment">// force size change and redraw everything</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;            RECT rect = { 0 };</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;            GetWindowRect(&amp;rect);</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;            ::MapWindowPoints(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, GetParent(), (LPPOINT)&amp;rect, 2);</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;            SetRedraw(<a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;            SetWindowPos(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 1, 1, SWP_NOZORDER | SWP_NOMOVE);</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;            SetWindowPos(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;rect, SWP_NOZORDER | SWP_NOMOVE);</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;            SetRedraw(<a class="code" href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;            RedrawWindow(<a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, RDW_FRAME | RDW_INVALIDATE | RDW_UPDATENOW);</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;        }</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    }</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160; </div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;<span class="comment">// Implementation</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ae1252bd3befe525991603b8b24a88dde"> 3963</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ae1252bd3befe525991603b8b24a88dde">GetSystemSettings</a>()</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    {</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="preprocessor">#ifdef _CMDBAR_EXTRA_TRACE</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;        ATLTRACE2(<a class="code" href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">atlTraceUI</a>, 0, _T(<span class="stringliteral">&quot;MDI CmdBar - GetSystemSettings\n&quot;</span>));</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        _baseClass::GetSystemSettings();</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160; </div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;        NONCLIENTMETRICS info = { <a class="code" href="namespace_w_t_l_1_1_run_time_helper.html#a9f06e5b838fb4cb07a8dabcca8c40562">RunTimeHelper::SizeOf_NONCLIENTMETRICS</a>() };</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bRet = ::SystemParametersInfo(SPI_GETNONCLIENTMETRICS, <span class="keyword">sizeof</span>(info), &amp;info, 0);</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;        ATLASSERT(bRet);</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;        <span class="keywordflow">if</span>(bRet)</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;        {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;            m_cxIconWidth = ::GetSystemMetrics(SM_CXSMICON);</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;            m_cyIconHeight = ::GetSystemMetrics(SM_CYSMICON);</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;            m_cxLeft = m_cxIconWidth;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160; </div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;            <span class="keywordflow">if</span>(m_hTheme != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;            {</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;                m_cxBtnWidth = info.iCaptionWidth - 2 * m_cxyOffset;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                m_cyBtnHeight = info.iCaptionHeight - 2 * m_cxyOffset;</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                m_cxRight = 3 * m_cxBtnWidth;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;            }</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;            {</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                m_cxBtnWidth = info.iCaptionWidth - m_cxyOffset;</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                m_cyBtnHeight = info.iCaptionHeight - 2 * m_cxyOffset;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                m_cxRight = 3 * m_cxBtnWidth + m_cxyOffset;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;            }</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;        }</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160; </div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;        RECT rect = { 0 };</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;        GetClientRect(&amp;rect);</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;        T* pT = <span class="keyword">static_cast&lt;</span>T*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;        pT-&gt;_AdjustBtnSize(rect.bottom);</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    }</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160; </div>
<div class="line"><a name="l04001"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a7cb07d78cb1f7a2490c687eaabf4f94c"> 4001</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a7cb07d78cb1f7a2490c687eaabf4f94c">_AdjustBtnSize</a>(<span class="keywordtype">int</span> cyHeight)</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    {</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;        <span class="keywordflow">if</span>(cyHeight &gt; 1 &amp;&amp; m_cyBtnHeight &gt; cyHeight)</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;        {</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;            <span class="keywordflow">if</span>(m_hTheme != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;            {</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                m_cyBtnHeight = cyHeight;</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;                m_cxBtnWidth = cyHeight;</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;                m_cxRight = 3 * m_cxBtnWidth;</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;            }</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;            {</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;                m_cyBtnHeight = cyHeight;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;                m_cxBtnWidth = cyHeight + m_cxyOffset;</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;                m_cxRight = 3 * m_cxBtnWidth + m_cxyOffset;</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;            }</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        }</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    }</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160; </div>
<div class="line"><a name="l04022"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a83ded089e8ec74a12168ad1c966f7328"> 4022</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a83ded089e8ec74a12168ad1c966f7328">_CalcIconRect</a>(<span class="keywordtype">int</span> cxWidth, <span class="keywordtype">int</span> cyHeight, RECT&amp; rect, <span class="keywordtype">bool</span> bInvertX = <span class="keyword">false</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;        <span class="keywordtype">int</span> xStart = (m_cxLeft - m_cxIconWidth) / 2;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        <span class="keywordflow">if</span>(xStart &lt; 0)</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;            xStart = 0;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        <span class="keywordtype">int</span> yStart = (cyHeight - m_cyIconHeight) / 2;</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        <span class="keywordflow">if</span>(yStart &lt; 0)</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;            yStart = 0;</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160; </div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;        <span class="keywordflow">if</span>(bInvertX)</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;            ::SetRect(&amp;rect, cxWidth - (xStart + m_cxBtnWidth), yStart, cxWidth - xStart, yStart + m_cyBtnHeight);</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        else</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;            ::SetRect(&amp;rect, xStart, yStart, xStart + m_cxBtnWidth, yStart + m_cyBtnHeight);</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;    }</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160; </div>
<div class="line"><a name="l04037"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a8557ebe2fed358eb10781a53fb0dd49c"> 4037</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a8557ebe2fed358eb10781a53fb0dd49c">_CalcBtnRects</a>(<span class="keywordtype">int</span> cxWidth, <span class="keywordtype">int</span> cyHeight, RECT arrRect[3], <span class="keywordtype">bool</span> bInvertX = <span class="keyword">false</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        <span class="keywordtype">int</span> yStart = (cyHeight - m_cyBtnHeight) / 2;</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;        <span class="keywordflow">if</span>(yStart &lt; 0)</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;            yStart = 0;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160; </div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;        RECT rcBtn = { cxWidth - m_cxBtnWidth, yStart, cxWidth, yStart + m_cyBtnHeight };</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;        <span class="keywordtype">int</span> nDirection = -1;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        <span class="keywordflow">if</span>(bInvertX)</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        {</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;            ::SetRect(&amp;rcBtn, 0, yStart, m_cxBtnWidth, yStart + m_cyBtnHeight);</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;            nDirection = 1;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;        }</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160; </div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;        arrRect[0] = rcBtn;</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;        <span class="keywordflow">if</span>(m_hTheme != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;            ::OffsetRect(&amp;rcBtn, nDirection * m_cxBtnWidth, 0);</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;            ::OffsetRect(&amp;rcBtn, nDirection * (m_cxBtnWidth + m_cxyOffset), 0);</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;        arrRect[1] = rcBtn;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;        ::OffsetRect(&amp;rcBtn, nDirection * m_cxBtnWidth, 0);</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;        arrRect[2] = rcBtn;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    }</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160; </div>
<div class="line"><a name="l04063"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a54bc6588d6e4586a21ddeda744ded3ef"> 4063</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a54bc6588d6e4586a21ddeda744ded3ef">_DrawMDIButton</a>(<a class="code" href="class_w_t_l_1_1_c_window_d_c.html">CWindowDC</a>&amp; dc, LPRECT pRects, <span class="keywordtype">int</span> nBtn)</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <span class="keywordflow">if</span>(m_hTheme != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        {</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;<span class="preprocessor">#ifndef TMSCHEMA_H</span></div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> WP_MDICLOSEBUTTON = 20;</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> CBS_NORMAL = 1;</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> CBS_PUSHED = 3;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> CBS_DISABLED = 4;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> WP_MDIRESTOREBUTTON = 22;</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> RBS_NORMAL = 1;</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> RBS_PUSHED = 3;</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> RBS_DISABLED = 4;</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> WP_MDIMINBUTTON = 16;</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> MINBS_NORMAL = 1;</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> MINBS_PUSHED = 3;</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> MINBS_DISABLED = 4;</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// TMSCHEMA_H</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;            <span class="keywordflow">if</span>(nBtn == -1 || nBtn == 0)</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                m_pfnDrawThemeBackground(m_hTheme, dc, WP_MDICLOSEBUTTON, m_bParentActive ? ((m_nBtnPressed == 0) ? CBS_PUSHED : CBS_NORMAL) : CBS_DISABLED, &amp;pRects[0], <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;            <span class="keywordflow">if</span>(nBtn == -1 || nBtn == 1)</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;                m_pfnDrawThemeBackground(m_hTheme, dc, WP_MDIRESTOREBUTTON, m_bParentActive ? ((m_nBtnPressed == 1) ? RBS_PUSHED : RBS_NORMAL) : RBS_DISABLED, &amp;pRects[1], <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;            <span class="keywordflow">if</span>(nBtn == -1 || nBtn == 2)</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;                m_pfnDrawThemeBackground(m_hTheme, dc, WP_MDIMINBUTTON, m_bParentActive ? ((m_nBtnPressed == 2) ? MINBS_PUSHED : MINBS_NORMAL) : MINBS_DISABLED, &amp;pRects[2], <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;        }</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;        {</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;            <span class="keywordflow">if</span>(nBtn == -1 || nBtn == 0)</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a9f517234a46ac9a1eb06786967d86c4d">DrawFrameControl</a>(&amp;pRects[0], DFC_CAPTION, DFCS_CAPTIONCLOSE | ((m_nBtnPressed == 0) ? DFCS_PUSHED : 0));</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;            <span class="keywordflow">if</span>(nBtn == -1 || nBtn == 1)</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a9f517234a46ac9a1eb06786967d86c4d">DrawFrameControl</a>(&amp;pRects[1], DFC_CAPTION, DFCS_CAPTIONRESTORE | ((m_nBtnPressed == 1) ? DFCS_PUSHED : 0));</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;            <span class="keywordflow">if</span>(nBtn == -1 || nBtn == 2)</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;                dc.<a class="code" href="class_w_t_l_1_1_c_d_c_t.html#a9f517234a46ac9a1eb06786967d86c4d">DrawFrameControl</a>(&amp;pRects[2], DFC_CAPTION, DFCS_CAPTIONMIN | ((m_nBtnPressed == 2) ? DFCS_PUSHED : 0));</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;        }</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    }</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160; </div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="preprocessor">#ifndef _WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a19364d71b0c4515431688da67df9cc5f"> 4102</a></span>&#160;    <span class="keyword">static</span> UINT <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a19364d71b0c4515431688da67df9cc5f">_GetThemeChangedMsg</a>()</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    {</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="preprocessor">#ifndef WM_THEMECHANGED</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> UINT WM_THEMECHANGED = 0x031A;</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !WM_THEMECHANGED</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;        <span class="keywordflow">return</span> WM_THEMECHANGED;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    }</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160; </div>
<div class="line"><a name="l04110"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab1be99ad2174db6c4cf99fcc70a30059"> 4110</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab1be99ad2174db6c4cf99fcc70a30059">_OpenThemeData</a>()</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    {</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;        ATLASSERT(m_hThemeDLL != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160; </div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;        PFN_OpenThemeData pfnOpenThemeData = (PFN_OpenThemeData)::GetProcAddress(m_hThemeDLL, <span class="stringliteral">&quot;OpenThemeData&quot;</span>);</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;        ATLASSERT(pfnOpenThemeData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;        <span class="keywordflow">if</span>(pfnOpenThemeData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;            m_hTheme = pfnOpenThemeData(m_hWnd, L<span class="stringliteral">&quot;Window&quot;</span>);</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    }</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160; </div>
<div class="line"><a name="l04120"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ac885569c45082d57e1a4562dbc54a9"> 4120</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ac885569c45082d57e1a4562dbc54a9">_CloseThemeData</a>()</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    {</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;        ATLASSERT(m_hThemeDLL != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160; </div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;        <span class="keywordflow">if</span>(m_hTheme == <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;            <span class="keywordflow">return</span>;   <span class="comment">// nothing to do</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160; </div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;        PFN_CloseThemeData pfnCloseThemeData = (PFN_CloseThemeData)::GetProcAddress(m_hThemeDLL, <span class="stringliteral">&quot;CloseThemeData&quot;</span>);</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;        ATLASSERT(pfnCloseThemeData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;        <span class="keywordflow">if</span>(pfnCloseThemeData != <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;        {</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;            pfnCloseThemeData(m_hTheme);</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;            m_hTheme = <a class="code" href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;        }</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    }</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_WTL_NO_AUTO_THEME</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160; </div>
<div class="line"><a name="l04137"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ea4d15dcd59c9a653a6691c3bb7e6a8"> 4137</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ea4d15dcd59c9a653a6691c3bb7e6a8">_DebugCheckChild</a>()</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;    {</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;        <a class="code" href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a> bMaximized = <a class="code" href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;        HWND hWndChild = (HWND)::SendMessage(m_wndMDIClient, WM_MDIGETACTIVE, 0, (LPARAM)&amp;bMaximized);</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;        <span class="keywordflow">return</span> (bMaximized &amp;&amp; hWndChild == m_hWndChildMaximized);</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;<span class="preprocessor">#else </span><span class="comment">// !_DEBUG</span></div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !_DEBUG</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    }</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;};</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160; </div>
<div class="line"><a name="l04149"></a><span class="lineno"><a class="line" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl.html"> 4149</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl.html">CMDICommandBarCtrl</a> : <span class="keyword">public</span> <a class="code" href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html">CMDICommandBarCtrlImpl</a>&lt;CMDICommandBarCtrl&gt;</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;{</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    DECLARE_WND_SUPERCLASS(_T(<span class="stringliteral">&quot;WTL_MDICommandBar&quot;</span>), GetWndClassName())</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;};</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160; </div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;}; <span class="comment">// namespace WTL</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160; </div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// __ATLCTRLW_H__</span></div>
<div class="ttc" id="aatlapp_8h_html_a19d37f26db9a3e536b3e81979cde7b2b"><div class="ttname"><a href="atlapp_8h.html#a19d37f26db9a3e536b3e81979cde7b2b">GCLP_HICONSM</a></div><div class="ttdeci">#define GCLP_HICONSM</div><div class="ttdef"><b>Definition:</b> atlapp.h:321</div></div>
<div class="ttc" id="aatlapp_8h_html_a390bdfa6d9c2f2442cd38197f6ad339f"><div class="ttname"><a href="atlapp_8h.html#a390bdfa6d9c2f2442cd38197f6ad339f">ATLVERIFY</a></div><div class="ttdeci">#define ATLVERIFY(expr)</div><div class="ttdef"><b>Definition:</b> atlapp.h:469</div></div>
<div class="ttc" id="aatlapp_8h_html_a4599ee696a42cac2f19d588a816af70f"><div class="ttname"><a href="atlapp_8h.html#a4599ee696a42cac2f19d588a816af70f">LongToHandle</a></div><div class="ttdeci">#define LongToHandle(h)</div><div class="ttdef"><b>Definition:</b> atlapp.h:375</div></div>
<div class="ttc" id="aatlapp_8h_html_a6484b325f0b6005b6ca826abab935270"><div class="ttname"><a href="atlapp_8h.html#a6484b325f0b6005b6ca826abab935270">GetClassLongPtr</a></div><div class="ttdeci">#define GetClassLongPtr</div><div class="ttdef"><b>Definition:</b> atlapp.h:316</div></div>
<div class="ttc" id="aatlapp_8h_html_a81b884738a496c4654d04b037e248491"><div class="ttname"><a href="atlapp_8h.html#a81b884738a496c4654d04b037e248491">GET_Y_LPARAM</a></div><div class="ttdeci">#define GET_Y_LPARAM(lParam)</div><div class="ttdef"><b>Definition:</b> atlapp.h:453</div></div>
<div class="ttc" id="aatlapp_8h_html_a9dd065718edeaaebee8314152f8c45d2"><div class="ttname"><a href="atlapp_8h.html#a9dd065718edeaaebee8314152f8c45d2">ULongToPtr</a></div><div class="ttdeci">#define ULongToPtr(ul)</div><div class="ttdef"><b>Definition:</b> atlapp.h:405</div></div>
<div class="ttc" id="aatlapp_8h_html_aa53040d6ed85b65dd0ebc79ced7fd547"><div class="ttname"><a href="atlapp_8h.html#aa53040d6ed85b65dd0ebc79ced7fd547">PtrToUlong</a></div><div class="ttdeci">#define PtrToUlong(p)</div><div class="ttdef"><b>Definition:</b> atlapp.h:378</div></div>
<div class="ttc" id="aatlapp_8h_html_ac503b7bea1053172cf5044a25c266f9a"><div class="ttname"><a href="atlapp_8h.html#ac503b7bea1053172cf5044a25c266f9a">GET_X_LPARAM</a></div><div class="ttdeci">#define GET_X_LPARAM(lParam)</div><div class="ttdef"><b>Definition:</b> atlapp.h:450</div></div>
<div class="ttc" id="aatlapp_8h_html_ac87b166e5dce7fa7bf3fa6dee25e1c19"><div class="ttname"><a href="atlapp_8h.html#ac87b166e5dce7fa7bf3fa6dee25e1c19">ULONG_PTR</a></div><div class="ttdeci">unsigned long ULONG_PTR</div><div class="ttdef"><b>Definition:</b> atlapp.h:365</div></div>
<div class="ttc" id="aatlctrlw_8h_html_a1ca3673f0cd8b9d8f422734db43d595e"><div class="ttname"><a href="atlctrlw_8h.html#a1ca3673f0cd8b9d8f422734db43d595e">CBRM_GETCMDBAR</a></div><div class="ttdeci">#define CBRM_GETCMDBAR</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:79</div></div>
<div class="ttc" id="aatlctrlw_8h_html_a247bcb0e7ba38932741ec0c8b71761b9"><div class="ttname"><a href="atlctrlw_8h.html#a247bcb0e7ba38932741ec0c8b71761b9">CBR_EX_NOVISTAMENUS</a></div><div class="ttdeci">#define CBR_EX_NOVISTAMENUS</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:72</div></div>
<div class="ttc" id="aatlctrlw_8h_html_a33bc338539585b7aa4af90dc83ec7b8b"><div class="ttname"><a href="atlctrlw_8h.html#a33bc338539585b7aa4af90dc83ec7b8b">CBR_EX_SHAREMENU</a></div><div class="ttdeci">#define CBR_EX_SHAREMENU</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:69</div></div>
<div class="ttc" id="aatlctrlw_8h_html_a54def69e13b608d7681d597d1c4d0c00"><div class="ttname"><a href="atlctrlw_8h.html#a54def69e13b608d7681d597d1c4d0c00">CBR_EX_TRANSPARENT</a></div><div class="ttdeci">#define CBR_EX_TRANSPARENT</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:68</div></div>
<div class="ttc" id="aatlctrlw_8h_html_a72f3392bf543796e5783483be9628081"><div class="ttname"><a href="atlctrlw_8h.html#a72f3392bf543796e5783483be9628081">CBRM_GETMENU</a></div><div class="ttdeci">#define CBRM_GETMENU</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:80</div></div>
<div class="ttc" id="aatlctrlw_8h_html_a80b711f34f456fd2358ca35dfd2db8fc"><div class="ttname"><a href="atlctrlw_8h.html#a80b711f34f456fd2358ca35dfd2db8fc">CBRM_TRACKPOPUPMENU</a></div><div class="ttdeci">#define CBRM_TRACKPOPUPMENU</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:81</div></div>
<div class="ttc" id="aatlctrlw_8h_html_a9cd2c9ef1859f1f42f4c114f96fa41b0"><div class="ttname"><a href="atlctrlw_8h.html#a9cd2c9ef1859f1f42f4c114f96fa41b0">CBR_EX_ALTFOCUSMODE</a></div><div class="ttdeci">#define CBR_EX_ALTFOCUSMODE</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:70</div></div>
<div class="ttc" id="aatlctrlw_8h_html_adad1bf70b2ae18b73473f537f35534e0"><div class="ttname"><a href="atlctrlw_8h.html#adad1bf70b2ae18b73473f537f35534e0">CBR_EX_TRACKALWAYS</a></div><div class="ttdeci">#define CBR_EX_TRACKALWAYS</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:71</div></div>
<div class="ttc" id="aatlres_8h_html_a9cafe9f4c01b4a48731f38d1f9e2f642"><div class="ttname"><a href="atlres_8h.html#a9cafe9f4c01b4a48731f38d1f9e2f642">RT_TOOLBAR</a></div><div class="ttdeci">#define RT_TOOLBAR</div><div class="ttdef"><b>Definition:</b> atlres.h:66</div></div>
<div class="ttc" id="abluenrg__types_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="bluenrg__types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> bluenrg_types.h:22</div></div>
<div class="ttc" id="abluenrg__types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="bluenrg__types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> bluenrg_types.h:51</div></div>
<div class="ttc" id="abluenrg__types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="bluenrg__types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> bluenrg_types.h:55</div></div>
<div class="ttc" id="abluenrg__types_8h_html_ad2f8ed01c1733d4eab0932d970abaa4c"><div class="ttname"><a href="bluenrg__types_8h.html#ad2f8ed01c1733d4eab0932d970abaa4c">BOOL</a></div><div class="ttdeci">uint8_t BOOL</div><div class="ttdef"><b>Definition:</b> bluenrg_types.h:48</div></div>
<div class="ttc" id="aclass_a_t_l_1_1___u___s_t_r_i_n_gor_i_d_html"><div class="ttname"><a href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html">ATL::_U_STRINGorID</a></div><div class="ttdef"><b>Definition:</b> atlwinx.h:456</div></div>
<div class="ttc" id="aclass_a_t_l_1_1___u___s_t_r_i_n_gor_i_d_html_a2b23de29e413c50b53b825afa0c63d41"><div class="ttname"><a href="class_a_t_l_1_1___u___s_t_r_i_n_gor_i_d.html#a2b23de29e413c50b53b825afa0c63d41">ATL::_U_STRINGorID::m_lpstr</a></div><div class="ttdeci">LPCTSTR m_lpstr</div><div class="ttdef"><b>Definition:</b> atlwinx.h:462</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html">WTL::CBitmapT&lt; true &gt;</a></div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html_a114cf196f780520a45df9052c314f469"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html#a114cf196f780520a45df9052c314f469">WTL::CBitmapT::CreateBitmap</a></div><div class="ttdeci">HBITMAP CreateBitmap(int nWidth, int nHeight, UINT nPlanes, UINT nBitsPerPixel, const void *lpBits)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:756</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html_a3efa2da9951422a13c9aeece49cefed9"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html#a3efa2da9951422a13c9aeece49cefed9">WTL::CBitmapT::DeleteObject</a></div><div class="ttdeci">BOOL DeleteObject()</div><div class="ttdef"><b>Definition:</b> atlgdi.h:788</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html_a5df966ea4d80995b0655b515c1bd7399"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html#a5df966ea4d80995b0655b515c1bd7399">WTL::CBitmapT::CreateCompatibleBitmap</a></div><div class="ttdeci">HBITMAP CreateCompatibleBitmap(HDC hDC, int nWidth, int nHeight)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:772</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html_a63642d8900f6857cfa608fe2e1d29da6"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html#a63642d8900f6857cfa608fe2e1d29da6">WTL::CBitmapT::LoadBitmap</a></div><div class="ttdeci">HBITMAP LoadBitmap(ATL::_U_STRINGorID bitmap)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:733</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html_a80d077468cbf98534a6621aa4f62a187"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html#a80d077468cbf98534a6621aa4f62a187">WTL::CBitmapT::m_hBitmap</a></div><div class="ttdeci">HBITMAP m_hBitmap</div><div class="ttdef"><b>Definition:</b> atlgdi.h:696</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html_a88546d448955b320fc895a807632716a"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html#a88546d448955b320fc895a807632716a">WTL::CBitmapT::LoadMappedBitmap</a></div><div class="ttdeci">HBITMAP LoadMappedBitmap(UINT nIDBitmap, UINT nFlags=0, LPCOLORMAP lpColorMap=NULL, int nMapSize=0)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:748</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_bitmap_t_html_a9636e923693f93bc2d7a093275c0575b"><div class="ttname"><a href="class_w_t_l_1_1_c_bitmap_t.html#a9636e923693f93bc2d7a093275c0575b">WTL::CBitmapT::GetSize</a></div><div class="ttdeci">bool GetSize(SIZE &amp;size) const</div><div class="ttdef"><b>Definition:</b> atlgdi.h:810</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_brush_t_html"><div class="ttname"><a href="class_w_t_l_1_1_c_brush_t.html">WTL::CBrushT</a></div><div class="ttdef"><b>Definition:</b> atlgdi.h:231</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_client_d_c_html"><div class="ttname"><a href="class_w_t_l_1_1_c_client_d_c.html">WTL::CClientDC</a></div><div class="ttdef"><b>Definition:</b> atlgdi.h:3389</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html">WTL::CCommandBarCtrlBase</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:134</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a0afbc265b43a3ae78480355de941f27a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a0afbc265b43a3ae78480355de941f27a">WTL::CCommandBarCtrlBase::CMsgHookMap</a></div><div class="ttdeci">ATL::CSimpleMap&lt; DWORD, _MsgHookData * &gt; CMsgHookMap</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:145</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a22a0528a0366b9daeaab72902715cc33"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a22a0528a0366b9daeaab72902715cc33">WTL::CCommandBarCtrlBase::s_bStaticInit</a></div><div class="ttdeci">static bool s_bStaticInit</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:151</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a25cde13030bbd27213b768fe8089b064"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a25cde13030bbd27213b768fe8089b064">WTL::CCommandBarCtrlBase::IsCommandBarBase</a></div><div class="ttdeci">bool IsCommandBarBase() const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:187</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a333cc51008f75ac0b13230f6f34915c7"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a333cc51008f75ac0b13230f6f34915c7">WTL::CCommandBarCtrlBase::CCommandBarCtrlBase</a></div><div class="ttdeci">CCommandBarCtrlBase()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:160</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a5b11d69a8593e4e896e98694b972f4ab"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a5b11d69a8593e4e896e98694b972f4ab">WTL::CCommandBarCtrlBase::m_stackMenuWnd</a></div><div class="ttdeci">CSimpleStack&lt; HWND &gt; m_stackMenuWnd</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:153</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a63d42dfa843939eeb03aa5deeb0a2269"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a63d42dfa843939eeb03aa5deeb0a2269">WTL::CCommandBarCtrlBase::s_hCreateHook</a></div><div class="ttdeci">static HHOOK s_hCreateHook</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:148</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a67c91cc533ddecde060b19e879d41b71"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a67c91cc533ddecde060b19e879d41b71">WTL::CCommandBarCtrlBase::m_dwMagic</a></div><div class="ttdeci">DWORD m_dwMagic</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:157</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a6c5cc1ab0110520d3bdc27b544b6dada"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a6c5cc1ab0110520d3bdc27b544b6dada">WTL::CCommandBarCtrlBase::m_stackMenuHandle</a></div><div class="ttdeci">CSimpleStack&lt; HMENU &gt; m_stackMenuHandle</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:154</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_a864c969c101b0fc778d9d35341674c35"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#a864c969c101b0fc778d9d35341674c35">WTL::CCommandBarCtrlBase::s_bW2K</a></div><div class="ttdeci">static bool s_bW2K</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:149</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_ac7683fefc092fdc60591e4e66d6f4296"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#ac7683fefc092fdc60591e4e66d6f4296">WTL::CCommandBarCtrlBase::s_pCurrentBar</a></div><div class="ttdeci">static CCommandBarCtrlBase * s_pCurrentBar</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:150</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_acc5db274749f36099c3354b89c5a4fe8"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#acc5db274749f36099c3354b89c5a4fe8">WTL::CCommandBarCtrlBase::m_hWndHook</a></div><div class="ttdeci">HWND m_hWndHook</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:156</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_base_html_aee174fcdb362f7d4ee7016509e42d65f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_base.html#aee174fcdb362f7d4ee7016509e42d65f">WTL::CCommandBarCtrlBase::s_pmapMsgHook</a></div><div class="ttdeci">static CMsgHookMap * s_pmapMsgHook</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:146</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_html"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl.html">WTL::CCommandBarCtrl</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3258</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html">WTL::CCommandBarCtrlImpl</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:202</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a03ba2fb6c1160ceb41db6fedbc6d9740"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a03ba2fb6c1160ceb41db6fedbc6d9740">WTL::CCommandBarCtrlImpl::ReplaceBitmap</a></div><div class="ttdeci">BOOL ReplaceBitmap(ATL::_U_STRINGorID bitmap, int nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:761</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a09ec0330f5a8df543075252ca5a6948f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a09ec0330f5a8df543075252ca5a6948f">WTL::CCommandBarCtrlImpl::m_dwExtendedStyle</a></div><div class="ttdeci">DWORD m_dwExtendedStyle</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:255</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a0c833ae6941eccbbc79a32b43eb7c43e"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a0c833ae6941eccbbc79a32b43eb7c43e">WTL::CCommandBarCtrlImpl::RemoveImage</a></div><div class="ttdeci">BOOL RemoveImage(int nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:831</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a0e43918adb060a998e9212341bf68dcc"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a0e43918adb060a998e9212341bf68dcc">WTL::CCommandBarCtrlImpl::OnDestroy</a></div><div class="ttdeci">LRESULT OnDestroy(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1033</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a10c6f8d5b42683c54a670433c8a1ab85"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a10c6f8d5b42683c54a670433c8a1ab85">WTL::CCommandBarCtrlImpl::ShowKeyboardCues</a></div><div class="ttdeci">void ShowKeyboardCues(bool bShow)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3079</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a1142c62f030c8241631814c0f4918231"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1142c62f030c8241631814c0f4918231">WTL::CCommandBarCtrlImpl::OnParentDrawItem</a></div><div class="ttdeci">LRESULT OnParentDrawItem(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1766</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a12792e1c13fab5e76c6f736b162915b9"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a12792e1c13fab5e76c6f736b162915b9">WTL::CCommandBarCtrlImpl::GetCmdBar</a></div><div class="ttdeci">HWND GetCmdBar() const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:447</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a12bd71e596184911764666b4bba34485"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a12bd71e596184911764666b4bba34485">WTL::CCommandBarCtrlImpl::OnParentAPIGetMenu</a></div><div class="ttdeci">LRESULT OnParentAPIGetMenu(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1739</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a142cc0ea030dc7f1e0609bc832ff254f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a142cc0ea030dc7f1e0609bc832ff254f">WTL::CCommandBarCtrlImpl::m_nPopBtn</a></div><div class="ttdeci">int m_nPopBtn</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:277</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a152c5ba371219b701d32a877abb205d7"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a152c5ba371219b701d32a877abb205d7">WTL::CCommandBarCtrlImpl::m_szButton</a></div><div class="ttdeci">SIZE m_szButton</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:281</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a19708fc753e4fed1258815b5cc75657f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a19708fc753e4fed1258815b5cc75657f">WTL::CCommandBarCtrlImpl::GetImageMaskColor</a></div><div class="ttdeci">COLORREF GetImageMaskColor() const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:363</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a1a8b80b6c2bb4d3a376abc155ed97dad"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1a8b80b6c2bb4d3a376abc155ed97dad">WTL::CCommandBarCtrlImpl::m_hImageList</a></div><div class="ttdeci">HIMAGELIST m_hImageList</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:252</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a1b2303588f16b9d23715848cf3d16afb"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1b2303588f16b9d23715848cf3d16afb">WTL::CCommandBarCtrlImpl::lRet</a></div><div class="ttdeci">return lRet</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:966</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a1b59c341388ead5e30320c59c34695d7"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a1b59c341388ead5e30320c59c34695d7">WTL::CCommandBarCtrlImpl::Draw3DCheckmark</a></div><div class="ttdeci">BOOL Draw3DCheckmark(CDCHandle &amp;dc, const RECT &amp;rc, BOOL bSelected, BOOL bDisabled, BOOL bRadio, HBITMAP hBmpCheck)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2388</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a2143c2434933c756db7031e4d97c6a58"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2143c2434933c756db7031e4d97c6a58">WTL::CCommandBarCtrlImpl::GetGetBarMessage</a></div><div class="ttdeci">static UINT GetGetBarMessage()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3110</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a240c8412e8a108ec6fd9e06fa27c8e90"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a240c8412e8a108ec6fd9e06fa27c8e90">WTL::CCommandBarCtrlImpl::m_hWndFocus</a></div><div class="ttdeci">HWND m_hWndFocus</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:288</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a248dcce220d8bb9f061f57bef06e644a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a248dcce220d8bb9f061f57bef06e644a">WTL::CCommandBarCtrlImpl::OnCreate</a></div><div class="ttdeci">LRESULT OnCreate(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:969</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a2cf27e9d7128a6a4b3263ecd34c19105"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2cf27e9d7128a6a4b3263ecd34c19105">WTL::CCommandBarCtrlImpl::TakeFocus</a></div><div class="ttdeci">void TakeFocus()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3056</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a2ef99aeaa9138e216014841fb708f97a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a2ef99aeaa9138e216014841fb708f97a">WTL::CCommandBarCtrlImpl::DrawItemFlat</a></div><div class="ttdeci">void DrawItemFlat(LPDRAWITEMSTRUCT lpDrawItemStruct)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2224</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a33cffd840b86e1208cb73f79ff6c7384"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a33cffd840b86e1208cb73f79ff6c7384">WTL::CCommandBarCtrlImpl::TrackPopupMenu</a></div><div class="ttdeci">BOOL TrackPopupMenu(HMENU hMenu, UINT uFlags, int x, int y, LPTPMPARAMS lpParams=NULL)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:880</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a350a41a36a9269c9073ed5114dbee634"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a350a41a36a9269c9073ed5114dbee634">WTL::CCommandBarCtrlImpl::GetAutoPopupMessage</a></div><div class="ttdeci">static UINT GetAutoPopupMessage()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3088</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a376dbbbbee802e7a39a0c222a57a6700"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a376dbbbbee802e7a39a0c222a57a6700">WTL::CCommandBarCtrlImpl::m_bContextMenu</a></div><div class="ttdeci">bool m_bContextMenu</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:263</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a3af08a08dd248ed36c721da40d612c36"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3af08a08dd248ed36c721da40d612c36">WTL::CCommandBarCtrlImpl::m_bUseKeyboardCues</a></div><div class="ttdeci">bool m_bUseKeyboardCues</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:268</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a3b03bba91a098c972d0a2fe33d536426"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b03bba91a098c972d0a2fe33d536426">WTL::CCommandBarCtrlImpl::OnParentCustomDraw</a></div><div class="ttdeci">LRESULT OnParentCustomDraw(int, LPNMHDR pnmh, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1792</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a3b44786654c70b6c24e19bfb63850eb9"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b44786654c70b6c24e19bfb63850eb9">WTL::CCommandBarCtrlImpl::RemoveAllImages</a></div><div class="ttdeci">BOOL RemoveAllImages()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:859</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a3b5dd15017a630d7858efd971390a7c4"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3b5dd15017a630d7858efd971390a7c4">WTL::CCommandBarCtrlImpl::OnHookSysKeyDown</a></div><div class="ttdeci">LRESULT OnHookSysKeyDown(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1898</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a3d2e36fe7aa6de0fa6baa09110b2b0af"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a3d2e36fe7aa6de0fa6baa09110b2b0af">WTL::CCommandBarCtrlImpl::ProcessWindowMessage</a></div><div class="ttdeci">ProcessWindowMessage(pMsg-&gt;hwnd, pMsg-&gt;message, pMsg-&gt;wParam, pMsg-&gt;lParam, lRet, 3)</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4017d453ae091fcb3bf9bfb69623401f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4017d453ae091fcb3bf9bfb69623401f">WTL::CCommandBarCtrlImpl::m_wndParent</a></div><div class="ttdeci">ATL::CContainedWindow m_wndParent</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:257</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a404a39c408dc077f7d526f98bc17488a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a404a39c408dc077f7d526f98bc17488a">WTL::CCommandBarCtrlImpl::OnHookSysChar</a></div><div class="ttdeci">LRESULT OnHookSysChar(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1940</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a40fc5a585e937739787cff3953b3251f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a40fc5a585e937739787cff3953b3251f">WTL::CCommandBarCtrlImpl::OnChar</a></div><div class="ttdeci">LRESULT OnChar(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1136</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4583c41bd455b2310571a5dbbee2eefd"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4583c41bd455b2310571a5dbbee2eefd">WTL::CCommandBarCtrlImpl::OnInternalAutoPopup</a></div><div class="ttdeci">LRESULT OnInternalAutoPopup(UINT, WPARAM wParam, LPARAM, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1401</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4ba2395daaae873672fbfe67bc48ad2c"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4ba2395daaae873672fbfe67bc48ad2c">WTL::CCommandBarCtrlImpl::m_bSkipPostDown</a></div><div class="ttdeci">bool m_bSkipPostDown</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:274</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4c0f9b682a04c6d608a437b43c3fab52"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4c0f9b682a04c6d608a437b43c3fab52">WTL::CCommandBarCtrlImpl::OnHookSysKeyUp</a></div><div class="ttdeci">LRESULT OnHookSysKeyUp(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1928</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4dfd23a8bd39af4f8062e8fc18d7c98b"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4dfd23a8bd39af4f8062e8fc18d7c98b">WTL::CCommandBarCtrlImpl::SetCommandBarExtendedStyle</a></div><div class="ttdeci">DWORD SetCommandBarExtendedStyle(DWORD dwExtendedStyle, DWORD dwMask=0)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:347</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4e5cc2f251cb8671345ffa5aad1409ad"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4e5cc2f251cb8671345ffa5aad1409ad">WTL::CCommandBarCtrlImpl::OnInitMenuPopup</a></div><div class="ttdeci">LRESULT OnInitMenuPopup(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1236</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4e953080810b8d958281550d577b1ba1"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4e953080810b8d958281550d577b1ba1">WTL::CCommandBarCtrlImpl::CreateInternalImageList</a></div><div class="ttdeci">bool CreateInternalImageList(int cImages)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3133</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a4f1ac0cdb60cdd3b5e63329c2c603ebc"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a4f1ac0cdb60cdd3b5e63329c2c603ebc">WTL::CCommandBarCtrlImpl::OnInternalGetBar</a></div><div class="ttdeci">LRESULT OnInternalGetBar(UINT, WPARAM wParam, LPARAM, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1409</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a526b9e8333727c9b349a0fbcb6434aa9"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a526b9e8333727c9b349a0fbcb6434aa9">WTL::CCommandBarCtrlImpl::GetImageSize</a></div><div class="ttdeci">void GetImageSize(SIZE &amp;size) const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:387</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a548d0266db9a633faae1c719c4de0dcb"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a548d0266db9a633faae1c719c4de0dcb">WTL::CCommandBarCtrlImpl::AddBitmap</a></div><div class="ttdeci">BOOL AddBitmap(HBITMAP hBitmap, UINT nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:691</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a5a7c2c8114fbe4bcaa18793194d0e73d"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5a7c2c8114fbe4bcaa18793194d0e73d">WTL::CCommandBarCtrlImpl::AttachMenu</a></div><div class="ttdeci">BOOL AttachMenu(HMENU hMenu)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:498</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a5b4a83b8ab7e55ac2f149a5e6fedfa12"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5b4a83b8ab7e55ac2f149a5e6fedfa12">WTL::CCommandBarCtrlImpl::OnMenuSelect</a></div><div class="ttdeci">LRESULT OnMenuSelect(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1341</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a5d7ca217514b277ce242c7a8df7d65ca"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a5d7ca217514b277ce242c7a8df7d65ca">WTL::CCommandBarCtrlImpl::GetMenu</a></div><div class="ttdeci">CMenuHandle GetMenu() const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:357</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6298050d9c49f7303e54086028ab18f9"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6298050d9c49f7303e54086028ab18f9">WTL::CCommandBarCtrlImpl::OnKeyDown</a></div><div class="ttdeci">LRESULT OnKeyDown(UINT, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1092</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6348bf301f65134a630a075519fb1e88"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6348bf301f65134a630a075519fb1e88">WTL::CCommandBarCtrlImpl::SetImageMaskColor</a></div><div class="ttdeci">COLORREF SetImageMaskColor(COLORREF clrMask)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:368</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a64566fe643192cb06448878e52e3c707"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a64566fe643192cb06448878e52e3c707">WTL::CCommandBarCtrlImpl::Create</a></div><div class="ttdeci">HWND Create(HWND hWndParent, RECT &amp;rcPos, LPCTSTR szWindowName=NULL, DWORD dwStyle=0, DWORD dwExStyle=0, UINT nID=0, LPVOID lpCreateParam=NULL)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:454</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a67faa81ecddd180b8983b3a9dea84c7f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a67faa81ecddd180b8983b3a9dea84c7f">WTL::CCommandBarCtrlImpl::OnHookKeyDown</a></div><div class="ttdeci">LRESULT OnHookKeyDown(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1952</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a69a7fc2a235ea66c6370338905fa356b"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a69a7fc2a235ea66c6370338905fa356b">WTL::CCommandBarCtrlImpl::m_uSysKey</a></div><div class="ttdeci">UINT m_uSysKey</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:286</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6ac6470d713aec70b7e7c6ded4a30aaa"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ac6470d713aec70b7e7c6ded4a30aaa">WTL::CCommandBarCtrlImpl::GiveFocusBack</a></div><div class="ttdeci">void GiveFocusBack()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3063</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6b1781893e214523d1add2ab3a1ef879"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b1781893e214523d1add2ab3a1ef879">WTL::CCommandBarCtrlImpl::m_bSkipMsg</a></div><div class="ttdeci">bool m_bSkipMsg</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:265</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6b27d235765cd2eb574826a7b62f8e86"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b27d235765cd2eb574826a7b62f8e86">WTL::CCommandBarCtrlImpl::DrawBitmapDisabled</a></div><div class="ttdeci">void DrawBitmapDisabled(CDCHandle &amp;dc, int nImage, POINT point, HBRUSH hBrushBackground=::GetSysColorBrush(COLOR_3DFACE), HBRUSH hBrush3DEffect=::GetSysColorBrush(COLOR_3DHILIGHT), HBRUSH hBrushDisabledImage=::GetSysColorBrush(COLOR_3DSHADOW))</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2341</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6b5ffcce66a5fd634ee080907ee6f8b1"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6b5ffcce66a5fd634ee080907ee6f8b1">WTL::CCommandBarCtrlImpl::CreateHookProc</a></div><div class="ttdeci">static LRESULT CALLBACK CreateHookProc(int nCode, WPARAM wParam, LPARAM lParam)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2610</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6ce3be3682535e058f5e160975693664"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ce3be3682535e058f5e160975693664">WTL::CCommandBarCtrlImpl::AddIcon</a></div><div class="ttdeci">BOOL AddIcon(ATL::_U_STRINGorID icon, UINT nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:726</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6e41e47d2fff2118307a530137c0363f"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6e41e47d2fff2118307a530137c0363f">WTL::CCommandBarCtrlImpl::DrawItem3D</a></div><div class="ttdeci">void DrawItem3D(LPDRAWITEMSTRUCT lpDrawItemStruct)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2107</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6ea0356b72b43ae9a74fe049f88fabf1"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6ea0356b72b43ae9a74fe049f88fabf1">WTL::CCommandBarCtrlImpl::OnParentMenuChar</a></div><div class="ttdeci">LRESULT OnParentMenuChar(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1744</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6f2ab7e9292210333aa2b8c1638eb7fd"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6f2ab7e9292210333aa2b8c1638eb7fd">WTL::CCommandBarCtrlImpl::OnWindowPosChanging</a></div><div class="ttdeci">LRESULT OnWindowPosChanging(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1438</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a6fd52e40523fa7884f76f6426c243ccb"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a6fd52e40523fa7884f76f6426c243ccb">WTL::CCommandBarCtrlImpl::OnMenuChar</a></div><div class="ttdeci">LRESULT OnMenuChar(UINT, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1450</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a702cf8351bf4aeee8d211d9b55ffdfa9"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a702cf8351bf4aeee8d211d9b55ffdfa9">WTL::CCommandBarCtrlImpl::OnAPITrackPopupMenu</a></div><div class="ttdeci">LRESULT OnAPITrackPopupMenu(UINT, WPARAM, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1614</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a748bdb50b24563137e4ac6e9d40e6970"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a748bdb50b24563137e4ac6e9d40e6970">WTL::CCommandBarCtrlImpl::m_arrCommand</a></div><div class="ttdeci">ATL::CSimpleValArray&lt; WORD &gt; m_arrCommand</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:253</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a74ef2342b53a7446fe1857ee33bc6905"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a74ef2342b53a7446fe1857ee33bc6905">WTL::CCommandBarCtrlImpl::AttachToWindow</a></div><div class="ttdeci">BOOL AttachToWindow(HWND hWnd)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:468</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a766e57d4ec8002337fede01a0a1f98cb"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a766e57d4ec8002337fede01a0a1f98cb">WTL::CCommandBarCtrlImpl::OnParentSysCommand</a></div><div class="ttdeci">LRESULT OnParentSysCommand(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1708</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a76ffab37a62c378cb8b5d9aa826ea778"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a76ffab37a62c378cb8b5d9aa826ea778">WTL::CCommandBarCtrlImpl::OnHookMouseMove</a></div><div class="ttdeci">LRESULT OnHookMouseMove(UINT, WPARAM, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1855</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a770f51631ec2b94ba1b67afe0d201076"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a770f51631ec2b94ba1b67afe0d201076">WTL::CCommandBarCtrlImpl::m_bAttachedMenu</a></div><div class="ttdeci">bool m_bAttachedMenu</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:260</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a7b36ea24dff45fb4d03af619881c02a5"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7b36ea24dff45fb4d03af619881c02a5">WTL::CCommandBarCtrlImpl::~CCommandBarCtrlImpl</a></div><div class="ttdeci">~CCommandBarCtrlImpl()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:329</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a7bad7e49859b9fbe7c5f1ec2b98db78c"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7bad7e49859b9fbe7c5f1ec2b98db78c">WTL::CCommandBarCtrlImpl::OnMeasureItem</a></div><div class="ttdeci">LRESULT OnMeasureItem(UINT, WPARAM, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1592</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a7c9c92583900b0286b779b8cf5d425a4"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7c9c92583900b0286b779b8cf5d425a4">WTL::CCommandBarCtrlImpl::m_bVistaMenus</a></div><div class="ttdeci">bool m_bVistaMenus</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:275</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a7d7af86743a1f641c21e41246aff0fcd"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7d7af86743a1f641c21e41246aff0fcd">WTL::CCommandBarCtrlImpl::OnSysKeyUp</a></div><div class="ttdeci">LRESULT OnSysKeyUp(UINT, WPARAM, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1194</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a7dc6a6f76c854df6db9234bd442b5029"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7dc6a6f76c854df6db9234bd442b5029">WTL::CCommandBarCtrlImpl::GetImagesVisible</a></div><div class="ttdeci">bool GetImagesVisible() const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:375</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a7e9b4766281fd9c862e11d884de518d9"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a7e9b4766281fd9c862e11d884de518d9">WTL::CCommandBarCtrlImpl::m_bMenuActive</a></div><div class="ttdeci">bool m_bMenuActive</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:259</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a817f1614767b0304c0eda49bedeb3ba4"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a817f1614767b0304c0eda49bedeb3ba4">WTL::CCommandBarCtrlImpl::m_szBitmap</a></div><div class="ttdeci">SIZE m_szBitmap</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:280</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a84d1969e5f59bfbdc449a2a1ee6cffb7"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a84d1969e5f59bfbdc449a2a1ee6cffb7">WTL::CCommandBarCtrlImpl::m_bEscapePressed</a></div><div class="ttdeci">bool m_bEscapePressed</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:264</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a89ebe1865396a1e119d2364d13304165"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a89ebe1865396a1e119d2364d13304165">WTL::CCommandBarCtrlImpl::m_nNextPopBtn</a></div><div class="ttdeci">int m_nNextPopBtn</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:278</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a8c22b6e00cf3703ef4ca5c50e8b44378"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a8c22b6e00cf3703ef4ca5c50e8b44378">WTL::CCommandBarCtrlImpl::OnParentInitMenuPopup</a></div><div class="ttdeci">LRESULT OnParentInitMenuPopup(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1698</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a8ca1b724201ac19095ea9555f354b53b"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a8ca1b724201ac19095ea9555f354b53b">WTL::CCommandBarCtrlImpl::AddBitmap</a></div><div class="ttdeci">BOOL AddBitmap(ATL::_U_STRINGorID bitmap, int nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:681</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a901c86a7e45f354193178f958f6706bc"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a901c86a7e45f354193178f958f6706bc">WTL::CCommandBarCtrlImpl::DoPopupMenu</a></div><div class="ttdeci">void DoPopupMenu(int nIndex, bool bAnimate)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2686</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a916b4b567753da745e576cd2a935b5e0"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a916b4b567753da745e576cd2a935b5e0">WTL::CCommandBarCtrlImpl::m_bParentActive</a></div><div class="ttdeci">bool m_bParentActive</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:266</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a926b2e158a4f73fe5651f65f627ba9bf"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a926b2e158a4f73fe5651f65f627ba9bf">WTL::CCommandBarCtrlImpl::m_fontMenu</a></div><div class="ttdeci">CFont m_fontMenu</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:284</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a95770b97d856573d191977d1a52b0347"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a95770b97d856573d191977d1a52b0347">WTL::CCommandBarCtrlImpl::OnParentMeasureItem</a></div><div class="ttdeci">LRESULT OnParentMeasureItem(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1771</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a97a2439f40c59bb40355e6fe98331747"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a97a2439f40c59bb40355e6fe98331747">WTL::CCommandBarCtrlImpl::OnParentAPIGetCmdBar</a></div><div class="ttdeci">LRESULT OnParentAPIGetCmdBar(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1754</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a99d40e167fdda1af3150f2f394cc6ce0"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a99d40e167fdda1af3150f2f394cc6ce0">WTL::CCommandBarCtrlImpl::m_bFlatMenus</a></div><div class="ttdeci">bool m_bFlatMenus</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:267</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a9d4ac13dc84c368305a447a18cc3d447"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a9d4ac13dc84c368305a447a18cc3d447">WTL::CCommandBarCtrlImpl::ReplaceIcon</a></div><div class="ttdeci">BOOL ReplaceIcon(ATL::_U_STRINGorID icon, UINT nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:800</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_a9f74a78bbb8b5cf6b82f6304ef73d911"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#a9f74a78bbb8b5cf6b82f6304ef73d911">WTL::CCommandBarCtrlImpl::OnSysChar</a></div><div class="ttdeci">LRESULT OnSysChar(UINT, WPARAM, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1203</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa08db13d35633df7169462b0124041c7"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa08db13d35633df7169462b0124041c7">WTL::CCommandBarCtrlImpl::m_bShowKeyboardCues</a></div><div class="ttdeci">bool m_bShowKeyboardCues</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:269</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa1b70e1a6f04795a2a82408b2dc97132"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa1b70e1a6f04795a2a82408b2dc97132">WTL::CCommandBarCtrlImpl::OnAPIGetMenu</a></div><div class="ttdeci">LRESULT OnAPIGetMenu(UINT, WPARAM, LPARAM, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1609</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa1be7af9d37dfca29ff903d9735e7d3a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa1be7af9d37dfca29ff903d9735e7d3a">WTL::CCommandBarCtrlImpl::SetImagesVisible</a></div><div class="ttdeci">bool SetImagesVisible(bool bVisible)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:380</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa35516b84b7be6e0d6c9c8154d6bdd3e"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa35516b84b7be6e0d6c9c8154d6bdd3e">WTL::CCommandBarCtrlImpl::OnParentHotItemChange</a></div><div class="ttdeci">LRESULT OnParentHotItemChange(int, LPNMHDR pnmh, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1632</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa4556f2907372535207c3f560a245179"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa4556f2907372535207c3f560a245179">WTL::CCommandBarCtrlImpl::SetMDIClient</a></div><div class="ttdeci">BOOL SetMDIClient(HWND)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:893</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa583075d559bcc458862bab0dc15f25a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa583075d559bcc458862bab0dc15f25a">WTL::CCommandBarCtrlImpl::OnParentInternalGetBar</a></div><div class="ttdeci">LRESULT OnParentInternalGetBar(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1703</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa58dc0c5334149c0b7deb57ff19708ae"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa58dc0c5334149c0b7deb57ff19708ae">WTL::CCommandBarCtrlImpl::MeasureItem</a></div><div class="ttdeci">void MeasureItem(LPMEASUREITEMSTRUCT lpMeasureItemStruct)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2551</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa6ac97b5a2d4c1b61cb90d14c039fce3"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa6ac97b5a2d4c1b61cb90d14c039fce3">WTL::CCommandBarCtrlImpl::OnHookChar</a></div><div class="ttdeci">LRESULT OnHookChar(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2087</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aa8316c77a26be6c2133af48120bdf2da"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aa8316c77a26be6c2133af48120bdf2da">WTL::CCommandBarCtrlImpl::LoadImages</a></div><div class="ttdeci">BOOL LoadImages(ATL::_U_STRINGorID image)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:587</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aaa6505e48eb4fa0e5dfbdd87a83715cf"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaa6505e48eb4fa0e5dfbdd87a83715cf">WTL::CCommandBarCtrlImpl::GetCommandBarExtendedStyle</a></div><div class="ttdeci">DWORD GetCommandBarExtendedStyle() const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:342</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aabef65f85e9e66938d12203d332c469a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aabef65f85e9e66938d12203d332c469a">WTL::CCommandBarCtrlImpl::SetImageSize</a></div><div class="ttdeci">bool SetImageSize(int cx, int cy)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:397</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aadc48f87a42e8b6785e1f87a2fc47da7"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aadc48f87a42e8b6785e1f87a2fc47da7">WTL::CCommandBarCtrlImpl::OnInitMenu</a></div><div class="ttdeci">LRESULT OnInitMenu(UINT, WPARAM, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1228</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aaebdcee2543f73f4769e23b8735eea40"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaebdcee2543f73f4769e23b8735eea40">WTL::CCommandBarCtrlImpl::m_bKeyboardInput</a></div><div class="ttdeci">bool m_bKeyboardInput</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:271</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aaec82318b45e1b28d173c81a0a42aa06"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aaec82318b45e1b28d173c81a0a42aa06">WTL::CCommandBarCtrlImpl::m_cxExtraSpacing</a></div><div class="ttdeci">int m_cxExtraSpacing</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:290</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ab339fed939f8132a256146580ee4a3ae"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab339fed939f8132a256146580ee4a3ae">WTL::CCommandBarCtrlImpl::MessageHookProc</a></div><div class="ttdeci">static LRESULT CALLBACK MessageHookProc(int nCode, WPARAM wParam, LPARAM lParam)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2644</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ab4a4bad761fc7344925fba1fd4cde57e"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab4a4bad761fc7344925fba1fd4cde57e">WTL::CCommandBarCtrlImpl::GetAlphaImages</a></div><div class="ttdeci">bool GetAlphaImages() const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:423</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ab6db3026a4c896dc7e4990fa1f8d9694"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab6db3026a4c896dc7e4990fa1f8d9694">WTL::CCommandBarCtrlImpl::OnHookNextMenu</a></div><div class="ttdeci">LRESULT OnHookNextMenu(UINT, WPARAM, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2078</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ab8ca9d6d0f62c6e136266c00be00d130"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab8ca9d6d0f62c6e136266c00be00d130">WTL::CCommandBarCtrlImpl::DrawItem</a></div><div class="ttdeci">void DrawItem(LPDRAWITEMSTRUCT lpDrawItemStruct)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2097</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ab9fa460e48f6a1a64c96d70939f944c3"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ab9fa460e48f6a1a64c96d70939f944c3">WTL::CCommandBarCtrlImpl::OnEraseBackground</a></div><div class="ttdeci">LRESULT OnEraseBackground(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1212</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_abaf9e71fdee7618a34dd3700346e8370"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abaf9e71fdee7618a34dd3700346e8370">WTL::CCommandBarCtrlImpl::m_bLayoutRTL</a></div><div class="ttdeci">bool m_bLayoutRTL</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:273</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_abe2cda7eb8dd95e60d1c97ec2e345b95"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abe2cda7eb8dd95e60d1c97ec2e345b95">WTL::CCommandBarCtrlImpl::m_bPopupItem</a></div><div class="ttdeci">bool m_bPopupItem</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:262</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_abf90b5a72853fd28ab530645a20233a9"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#abf90b5a72853fd28ab530645a20233a9">WTL::CCommandBarCtrlImpl::LoadMappedImages</a></div><div class="ttdeci">BOOL LoadMappedImages(UINT nIDImage, UINT nFlags=0, LPCOLORMAP lpColorMap=NULL, int nMapSize=0)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:592</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ac002aa8c87a56599532a99fbfa209435"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ac002aa8c87a56599532a99fbfa209435">WTL::CCommandBarCtrlImpl::OnParentDropDown</a></div><div class="ttdeci">LRESULT OnParentDropDown(int, LPNMHDR pnmh, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1677</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ac83fad2d0f1a426aa63d2af7a93cab8c"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ac83fad2d0f1a426aa63d2af7a93cab8c">WTL::CCommandBarCtrlImpl::CCommandBarCtrlImpl</a></div><div class="ttdeci">CCommandBarCtrlImpl()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:297</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_acaa09118f95e4d089d242f98d527074a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acaa09118f95e4d089d242f98d527074a">WTL::CCommandBarCtrlImpl::_LoadImagesHelper</a></div><div class="ttdeci">BOOL _LoadImagesHelper(ATL::_U_STRINGorID image, bool bMapped, UINT nFlags=0, LPCOLORMAP lpColorMap=NULL, int nMapSize=0)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:597</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_acba9fd6e17d0f85a83263bfd5de0075e"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acba9fd6e17d0f85a83263bfd5de0075e">WTL::CCommandBarCtrlImpl::m_clrMask</a></div><div class="ttdeci">COLORREF m_clrMask</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:283</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_acd8146da24cc3d1a165ccfae979469c6"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acd8146da24cc3d1a165ccfae979469c6">WTL::CCommandBarCtrlImpl::GetPreviousMenuItem</a></div><div class="ttdeci">int GetPreviousMenuItem(int nBtn) const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2845</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_acf34e95c733e73c7b0a35691c7323d9a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#acf34e95c733e73c7b0a35691c7323d9a">WTL::CCommandBarCtrlImpl::OnAPIGetCmdBar</a></div><div class="ttdeci">LRESULT OnAPIGetCmdBar(UINT, WPARAM, LPARAM, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1626</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ad00d7d3368a5345f246dea05d5c89649"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad00d7d3368a5345f246dea05d5c89649">WTL::CCommandBarCtrlImpl::OnKeyUp</a></div><div class="ttdeci">LRESULT OnKeyUp(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1126</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ad1204acd741f993478b53340fba5d20b"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad1204acd741f993478b53340fba5d20b">WTL::CCommandBarCtrlImpl::SetAlphaImages</a></div><div class="ttdeci">bool SetAlphaImages(bool bAlphaImages)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:428</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ad671ad82988ee3200c0ae6f57cd54257"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad671ad82988ee3200c0ae6f57cd54257">WTL::CCommandBarCtrlImpl::OnParentActivate</a></div><div class="ttdeci">LRESULT OnParentActivate(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1776</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ad7e7a4f3d9120374e5de7a179ded3aea"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad7e7a4f3d9120374e5de7a179ded3aea">WTL::CCommandBarCtrlImpl::DrawMenuText</a></div><div class="ttdeci">void DrawMenuText(CDCHandle &amp;dc, RECT &amp;rc, LPCTSTR lpstrText, COLORREF color)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2324</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ad958af02eb8fb21a3c283dbbe786f38a"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ad958af02eb8fb21a3c283dbbe786f38a">WTL::CCommandBarCtrlImpl::ReplaceBitmap</a></div><div class="ttdeci">BOOL ReplaceBitmap(HBITMAP hBitmap, UINT nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:771</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_add0e6835e871886ea13e07dcce66f4b8"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#add0e6835e871886ea13e07dcce66f4b8">WTL::CCommandBarCtrlImpl::OnSettingChange</a></div><div class="ttdeci">LRESULT OnSettingChange(UINT, WPARAM wParam, LPARAM, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1420</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ade5501a6af106fa277fc17614edbd7d0"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ade5501a6af106fa277fc17614edbd7d0">WTL::CCommandBarCtrlImpl::ReplaceIcon</a></div><div class="ttdeci">BOOL ReplaceIcon(HICON hIcon, UINT nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:809</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_adff291440c6e281ea70923577ef75e5c"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#adff291440c6e281ea70923577ef75e5c">WTL::CCommandBarCtrlImpl::AddIcon</a></div><div class="ttdeci">BOOL AddIcon(HICON hIcon, UINT nCommandID)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:735</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ae1252bd3befe525991603b8b24a88dde"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae1252bd3befe525991603b8b24a88dde">WTL::CCommandBarCtrlImpl::GetSystemSettings</a></div><div class="ttdeci">void GetSystemSettings()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2932</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ae68fb601023d59c150b2f38da4ea6d05"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae68fb601023d59c150b2f38da4ea6d05">WTL::CCommandBarCtrlImpl::GetNextMenuItem</a></div><div class="ttdeci">int GetNextMenuItem(int nBtn) const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2875</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ae6ed89205df0d001297b9e72341ce77e"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae6ed89205df0d001297b9e72341ce77e">WTL::CCommandBarCtrlImpl::OnSysKeyDown</a></div><div class="ttdeci">LRESULT OnSysKeyDown(UINT, WPARAM, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1185</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_ae7ad31a9ff0c5c4c94ee959dd48b3fda"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#ae7ad31a9ff0c5c4c94ee959dd48b3fda">WTL::CCommandBarCtrlImpl::OnParentAPITrackPopupMenu</a></div><div class="ttdeci">LRESULT OnParentAPITrackPopupMenu(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1749</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aebf660879b6233daeffde59bf54a7551"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aebf660879b6233daeffde59bf54a7551">WTL::CCommandBarCtrlImpl::OnParentSettingChange</a></div><div class="ttdeci">LRESULT OnParentSettingChange(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1759</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aedb0d4c474df4ae311bfff56c77abc35"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedb0d4c474df4ae311bfff56c77abc35">WTL::CCommandBarCtrlImpl::m_bAlphaImages</a></div><div class="ttdeci">bool m_bAlphaImages</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:272</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aedc9ea55889e7ede32de4f2fa9407b41"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aedc9ea55889e7ede32de4f2fa9407b41">WTL::CCommandBarCtrlImpl::m_bImagesVisible</a></div><div class="ttdeci">bool m_bImagesVisible</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:261</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_aee8582438bbe77de15e91a9eba3bdaa3"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#aee8582438bbe77de15e91a9eba3bdaa3">WTL::CCommandBarCtrlImpl::m_bAllowKeyboardCues</a></div><div class="ttdeci">bool m_bAllowKeyboardCues</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:270</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_af3ab18a88601d69a41577698827492ec"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af3ab18a88601d69a41577698827492ec">WTL::CCommandBarCtrlImpl::LoadMenu</a></div><div class="ttdeci">BOOL LoadMenu(ATL::_U_STRINGorID menu)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:482</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_af518e71b50746aab97eb347e025d523b"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af518e71b50746aab97eb347e025d523b">WTL::CCommandBarCtrlImpl::_CmdBarDrawConstants</a></div><div class="ttdeci">_CmdBarDrawConstants</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:233</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_af60daf85bc2b80b44bd14b180d942472"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af60daf85bc2b80b44bd14b180d942472">WTL::CCommandBarCtrlImpl::DrawCheckmark</a></div><div class="ttdeci">BOOL DrawCheckmark(CDCHandle &amp;dc, const RECT &amp;rc, BOOL bSelected, BOOL bDisabled, BOOL bRadio, HBITMAP hBmpCheck)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2393</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_af8c6308ccb6f8a590b187aa34b0cbce8"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#af8c6308ccb6f8a590b187aa34b0cbce8">WTL::CCommandBarCtrlImpl::OnDrawItem</a></div><div class="ttdeci">LRESULT OnDrawItem(UINT, WPARAM, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:1576</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_afbf29132cd805a43eb9756452dda6cec"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#afbf29132cd805a43eb9756452dda6cec">WTL::CCommandBarCtrlImpl::SetImageSize</a></div><div class="ttdeci">bool SetImageSize(SIZE &amp;size)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:392</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_afd3dd5f72cf90cc16b3aebc01e53bcf3"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">WTL::CCommandBarCtrlImpl::m_hMenu</a></div><div class="ttdeci">HMENU m_hMenu</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:251</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_command_bar_ctrl_impl_html_affe461ca5646cb81653b8b28ed6b0634"><div class="ttname"><a href="class_w_t_l_1_1_c_command_bar_ctrl_impl.html#affe461ca5646cb81653b8b28ed6b0634">WTL::CCommandBarCtrlImpl::DoTrackPopupMenu</a></div><div class="ttdeci">BOOL DoTrackPopupMenu(HMENU hMenu, UINT uFlags, int x, int y, LPTPMPARAMS lpParams=NULL)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:2762</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html">WTL::CDCT</a></div><div class="ttdef"><b>Definition:</b> atlgdi.h:1212</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a06c487f47dcf690b00e11f49871e3ad2"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a06c487f47dcf690b00e11f49871e3ad2">WTL::CDCT::GetHalftoneBrush</a></div><div class="ttdeci">static CBrushHandle PASCAL GetHalftoneBrush()</div><div class="ttdef"><b>Definition:</b> atlgdi.h:3046</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a0f929e770321e607931627b973bdb67a"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a0f929e770321e607931627b973bdb67a">WTL::CDCT::CreateCompatibleDC</a></div><div class="ttdeci">HDC CreateCompatibleDC(HDC hDC=NULL)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1298</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a18c4330076a89f95fa40f92b82bfc401"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a18c4330076a89f95fa40f92b82bfc401">WTL::CDCT::SetBrushOrg</a></div><div class="ttdeci">BOOL SetBrushOrg(int x, int y, LPPOINT lpPoint=NULL)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1361</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a19ee2697138e6b4a73c1bf32587f4a81"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a19ee2697138e6b4a73c1bf32587f4a81">WTL::CDCT::DrawEdge</a></div><div class="ttdeci">BOOL DrawEdge(LPRECT lpRect, UINT nEdge, UINT nFlags)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2688</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a21a3524c4a8fbb6613043847ec26f397"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a21a3524c4a8fbb6613043847ec26f397">WTL::CDCT::FillRect</a></div><div class="ttdeci">BOOL FillRect(LPCRECT lpRect, HBRUSH hBrush)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2056</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a250d67d0c53b4cb902bb3c432ef04a9a"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a250d67d0c53b4cb902bb3c432ef04a9a">WTL::CDCT::DrawIconEx</a></div><div class="ttdeci">BOOL DrawIconEx(int x, int y, HICON hIcon, int cxWidth, int cyWidth, UINT uStepIfAniCur=0, HBRUSH hbrFlickerFreeDraw=NULL, UINT uFlags=DI_NORMAL)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2108</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a2871d067a4a5d219d6d08a8f9321c404"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a2871d067a4a5d219d6d08a8f9321c404">WTL::CDCT::DrawText</a></div><div class="ttdeci">int DrawText(LPCTSTR lpstrText, int cchText, LPRECT lpRect, UINT uFormat)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2515</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a2ddfbbb0bf3ac94b84cbdd7b3e43dc58"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a2ddfbbb0bf3ac94b84cbdd7b3e43dc58">WTL::CDCT::SetBkColor</a></div><div class="ttdeci">COLORREF SetBkColor(COLORREF crColor)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1530</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a54f653692e2fcad6b7670ba051d6ccc8"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a54f653692e2fcad6b7670ba051d6ccc8">WTL::CDCT::SetBkMode</a></div><div class="ttdeci">int SetBkMode(int nBkMode)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1536</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a55800b0e491698451ae52b6da0deb87c"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a55800b0e491698451ae52b6da0deb87c">WTL::CDCT::PatBlt</a></div><div class="ttdeci">BOOL PatBlt(int x, int y, int nWidth, int nHeight, DWORD dwRop)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2232</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a6e0f942bc75c698ce9dee87337d9351c"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a6e0f942bc75c698ce9dee87337d9351c">WTL::CDCT::GetTextColor</a></div><div class="ttdeci">COLORREF GetTextColor() const</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1524</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a8600f4b8d3f58a8838b3ab7973b326ba"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a8600f4b8d3f58a8838b3ab7973b326ba">WTL::CDCT::SetViewportOrg</a></div><div class="ttdeci">BOOL SetViewportOrg(int x, int y, LPPOINT lpPoint=NULL)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1604</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a8e3c0357eda97a7f7727f7a2d6cd465a"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a8e3c0357eda97a7f7727f7a2d6cd465a">WTL::CDCT::SelectBitmap</a></div><div class="ttdeci">HBITMAP SelectBitmap(HBITMAP hBitmap)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1411</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a9c696a7d67c96d94753be2a9829583ce"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a9c696a7d67c96d94753be2a9829583ce">WTL::CDCT::GetBkColor</a></div><div class="ttdeci">COLORREF GetBkColor() const</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1492</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_a9f517234a46ac9a1eb06786967d86c4d"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#a9f517234a46ac9a1eb06786967d86c4d">WTL::CDCT::DrawFrameControl</a></div><div class="ttdeci">BOOL DrawFrameControl(LPRECT lpRect, UINT nType, UINT nState)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2694</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_aadcc3fbf38d5e2e5d306da07338eec9a"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#aadcc3fbf38d5e2e5d306da07338eec9a">WTL::CDCT::BitBlt</a></div><div class="ttdeci">BOOL BitBlt(int x, int y, int nWidth, int nHeight, HDC hSrcDC, int xSrc, int ySrc, DWORD dwRop)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2238</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_abf97da9ef015c9f63c7f11d9b1f729b6"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#abf97da9ef015c9f63c7f11d9b1f729b6">WTL::CDCT::GetCurrentBitmap</a></div><div class="ttdeci">CBitmapHandle GetCurrentBitmap() const</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1285</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_ad058a0be4792f8b24f27bff74166c0db"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#ad058a0be4792f8b24f27bff74166c0db">WTL::CDCT::GetViewportOrg</a></div><div class="ttdeci">BOOL GetViewportOrg(LPPOINT lpPoint) const</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1590</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_ad1c93b5c6b39e9eaa9f668e248e5d637"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#ad1c93b5c6b39e9eaa9f668e248e5d637">WTL::CDCT::DitherBlt</a></div><div class="ttdeci">BOOL DitherBlt(int x, int y, int nWidth, int nHeight, HDC hSrcDC, HBITMAP hBitmap, int xSrc, int ySrc, HBRUSH hBrushBackground=::GetSysColorBrush(COLOR_3DFACE), HBRUSH hBrush3DEffect=::GetSysColorBrush(COLOR_3DHILIGHT), HBRUSH hBrushDisabledImage=::GetSysColorBrush(COLOR_3DSHADOW))</div><div class="ttdef"><b>Definition:</b> atlgdi.h:2376</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_af2a741bfc7d73f5de2fdd1813b151ad0"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#af2a741bfc7d73f5de2fdd1813b151ad0">WTL::CDCT::SelectFont</a></div><div class="ttdeci">HFONT SelectFont(HFONT hFont)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1404</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_d_c_t_html_af6f8c7ab2199238a799faa63d2ddfe48"><div class="ttname"><a href="class_w_t_l_1_1_c_d_c_t.html#af6f8c7ab2199238a799faa63d2ddfe48">WTL::CDCT::SetTextColor</a></div><div class="ttdeci">COLORREF SetTextColor(COLORREF crColor)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:1564</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_font_t_html"><div class="ttname"><a href="class_w_t_l_1_1_c_font_t.html">WTL::CFontT&lt; true &gt;</a></div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_font_t_html_a1db3e82448de138a98997e53e39d7336"><div class="ttname"><a href="class_w_t_l_1_1_c_font_t.html#a1db3e82448de138a98997e53e39d7336">WTL::CFontT::GetLogFont</a></div><div class="ttdeci">int GetLogFont(LOGFONT *pLogFont) const</div><div class="ttdef"><b>Definition:</b> atlgdi.h:671</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_font_t_html_a3dd0c155f296f0480c8972c492bae4af"><div class="ttname"><a href="class_w_t_l_1_1_c_font_t.html#a3dd0c155f296f0480c8972c492bae4af">WTL::CFontT::CreateFontIndirect</a></div><div class="ttdeci">HFONT CreateFontIndirect(const LOGFONT *lpLogFont)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:583</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_font_t_html_a3efa2da9951422a13c9aeece49cefed9"><div class="ttname"><a href="class_w_t_l_1_1_c_font_t.html#a3efa2da9951422a13c9aeece49cefed9">WTL::CFontT::DeleteObject</a></div><div class="ttdeci">BOOL DeleteObject()</div><div class="ttdef"><b>Definition:</b> atlgdi.h:661</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_font_t_html_a7395023a37c455fb266213238f615697"><div class="ttname"><a href="class_w_t_l_1_1_c_font_t.html#a7395023a37c455fb266213238f615697">WTL::CFontT::Attach</a></div><div class="ttdeci">void Attach(HFONT hFont)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:564</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_font_t_html_af929af7576aa9242220212b47ca3807e"><div class="ttname"><a href="class_w_t_l_1_1_c_font_t.html#af929af7576aa9242220212b47ca3807e">WTL::CFontT::m_hFont</a></div><div class="ttdeci">HFONT m_hFont</div><div class="ttdef"><b>Definition:</b> atlgdi.h:546</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_html"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl.html">WTL::CMDICommandBarCtrl</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4150</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html">WTL::CMDICommandBarCtrlImpl</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3269</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a02b1e962e1e2e78197795241d54e11df"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a02b1e962e1e2e78197795241d54e11df">WTL::CMDICommandBarCtrlImpl::m_cxIconWidth</a></div><div class="ttdeci">int m_cxIconWidth</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3280</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a033ff5206752aa0215546990a2895c6e"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a033ff5206752aa0215546990a2895c6e">WTL::CMDICommandBarCtrlImpl::m_pfnDrawThemeParentBackground</a></div><div class="ttdeci">PFN_DrawThemeParentBackground m_pfnDrawThemeParentBackground</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3300</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a07a24dd90cc998b5e8e3d0dd3a9847d6"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a07a24dd90cc998b5e8e3d0dd3a9847d6">WTL::CMDICommandBarCtrlImpl::m_cxLeft</a></div><div class="ttdeci">int m_cxLeft</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3284</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a0ac885569c45082d57e1a4562dbc54a9"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ac885569c45082d57e1a4562dbc54a9">WTL::CMDICommandBarCtrlImpl::_CloseThemeData</a></div><div class="ttdeci">void _CloseThemeData()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4120</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a0ea4d15dcd59c9a653a6691c3bb7e6a8"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ea4d15dcd59c9a653a6691c3bb7e6a8">WTL::CMDICommandBarCtrlImpl::_DebugCheckChild</a></div><div class="ttdeci">bool _DebugCheckChild()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4137</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a0ef71986325b3b8b79aeff54fe224599"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a0ef71986325b3b8b79aeff54fe224599">WTL::CMDICommandBarCtrlImpl::m_nBtnWasPressed</a></div><div class="ttdeci">int m_nBtnWasPressed</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3277</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a1447cce4709295e4bcd073100abd61e4"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1447cce4709295e4bcd073100abd61e4">WTL::CMDICommandBarCtrlImpl::m_cyIconHeight</a></div><div class="ttdeci">int m_cyIconHeight</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3281</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a15f47ebc13fac72c54cc8d8f83619769"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a15f47ebc13fac72c54cc8d8f83619769">WTL::CMDICommandBarCtrlImpl::OnMouseMove</a></div><div class="ttdeci">LRESULT OnMouseMove(UINT, WPARAM, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3653</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a19364d71b0c4515431688da67df9cc5f"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a19364d71b0c4515431688da67df9cc5f">WTL::CMDICommandBarCtrlImpl::_GetThemeChangedMsg</a></div><div class="ttdeci">static UINT _GetThemeChangedMsg()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4102</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a1b2303588f16b9d23715848cf3d16afb"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b2303588f16b9d23715848cf3d16afb">WTL::CMDICommandBarCtrlImpl::lRet</a></div><div class="ttdeci">return lRet</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3406</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a1b51f7d9c83a4107c0e17d2d672aa858"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1b51f7d9c83a4107c0e17d2d672aa858">WTL::CMDICommandBarCtrlImpl::HTHEME</a></div><div class="ttdeci">HANDLE HTHEME</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3290</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a1c23c45c3e0f53285136e9f6d7a34938"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a1c23c45c3e0f53285136e9f6d7a34938">WTL::CMDICommandBarCtrlImpl::m_cxRight</a></div><div class="ttdeci">int m_cxRight</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3285</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a2496caa3fbde2f03cf212e19ba81bf2d"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2496caa3fbde2f03cf212e19ba81bf2d">WTL::CMDICommandBarCtrlImpl::OnDestroy</a></div><div class="ttdeci">LRESULT OnDestroy(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3409</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a2506ef0a2d22c23c2a66bf9bebaa9674"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2506ef0a2d22c23c2a66bf9bebaa9674">WTL::CMDICommandBarCtrlImpl::m_hWndChildMaximized</a></div><div class="ttdeci">HWND m_hWndChildMaximized</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3274</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a251dc3dd218bee20c9cab5cbf3f3bd58"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a251dc3dd218bee20c9cab5cbf3f3bd58">WTL::CMDICommandBarCtrlImpl::OnAllHookMessages</a></div><div class="ttdeci">LRESULT OnAllHookMessages(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3821</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a28589ccc80904106d9d8a54832b5c2ed"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a28589ccc80904106d9d8a54832b5c2ed">WTL::CMDICommandBarCtrlImpl::OnNcLButtonDown</a></div><div class="ttdeci">LRESULT OnNcLButtonDown(UINT, WPARAM, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3572</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a2b4f6b61184648f835698fe34e9320f8"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a2b4f6b61184648f835698fe34e9320f8">WTL::CMDICommandBarCtrlImpl::m_hIconChildMaximized</a></div><div class="ttdeci">HICON m_hIconChildMaximized</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3275</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a31240ee53b951ff8ac4ca3c47c110252"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a31240ee53b951ff8ac4ca3c47c110252">WTL::CMDICommandBarCtrlImpl::OnNcCalcSize</a></div><div class="ttdeci">LRESULT OnNcCalcSize(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3447</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a334af570b0840915eff7204f164dc521"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a334af570b0840915eff7204f164dc521">WTL::CMDICommandBarCtrlImpl::OnNcLButtonDblClk</a></div><div class="ttdeci">LRESULT OnNcLButtonDblClk(UINT, WPARAM, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3735</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a43695304235f94d44727b0530303ee67"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a43695304235f94d44727b0530303ee67">WTL::CMDICommandBarCtrlImpl::m_hTheme</a></div><div class="ttdeci">HTHEME m_hTheme</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3298</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a508def142e1fe5514befa5f47e7a8b97"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a508def142e1fe5514befa5f47e7a8b97">WTL::CMDICommandBarCtrlImpl::_ProcessAllHookMessages</a></div><div class="ttdeci">void _ProcessAllHookMessages(UINT uMsg, WPARAM, LPARAM)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3859</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a54bc6588d6e4586a21ddeda744ded3ef"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a54bc6588d6e4586a21ddeda744ded3ef">WTL::CMDICommandBarCtrlImpl::_DrawMDIButton</a></div><div class="ttdeci">void _DrawMDIButton(CWindowDC &amp;dc, LPRECT pRects, int nBtn)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4063</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a57492585af2ccfd02ca3e5ce225ba74e"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a57492585af2ccfd02ca3e5ce225ba74e">WTL::CMDICommandBarCtrlImpl::m_wndMDIClient</a></div><div class="ttdeci">ATL::CContainedWindow m_wndMDIClient</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3272</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a6cdf638f1c768f2d37066ce7741e2a3f"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a6cdf638f1c768f2d37066ce7741e2a3f">WTL::CMDICommandBarCtrlImpl::m_cyBtnHeight</a></div><div class="ttdeci">int m_cyBtnHeight</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3283</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a6e09286ac28474eaaf862217228e1bcb"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a6e09286ac28474eaaf862217228e1bcb">WTL::CMDICommandBarCtrlImpl::OnNcPaint</a></div><div class="ttdeci">LRESULT OnNcPaint(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3469</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a7859bcf13bf430f301fe1c54aec1dc19"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a7859bcf13bf430f301fe1c54aec1dc19">WTL::CMDICommandBarCtrlImpl::OnCaptureChanged</a></div><div class="ttdeci">LRESULT OnCaptureChanged(UINT, WPARAM, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3769</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a7cb07d78cb1f7a2490c687eaabf4f94c"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a7cb07d78cb1f7a2490c687eaabf4f94c">WTL::CMDICommandBarCtrlImpl::_AdjustBtnSize</a></div><div class="ttdeci">void _AdjustBtnSize(int cyHeight)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4001</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a813aff62ddc3481213d8b6249d808b94"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a813aff62ddc3481213d8b6249d808b94">WTL::CMDICommandBarCtrlImpl::m_pfnDrawThemeBackground</a></div><div class="ttdeci">PFN_DrawThemeBackground m_pfnDrawThemeBackground</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3299</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a81ccc7dc9cf43c480ec2195bfbb4bb4e"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a81ccc7dc9cf43c480ec2195bfbb4bb4e">WTL::CMDICommandBarCtrlImpl::SetMDIClient</a></div><div class="ttdeci">BOOL SetMDIClient(HWND hWndMDIClient)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3324</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a83ded089e8ec74a12168ad1c966f7328"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a83ded089e8ec74a12168ad1c966f7328">WTL::CMDICommandBarCtrlImpl::_CalcIconRect</a></div><div class="ttdeci">void _CalcIconRect(int cxWidth, int cyHeight, RECT &amp;rect, bool bInvertX=false) const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4022</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a84e9b386041ded037722cdaba57af761"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a84e9b386041ded037722cdaba57af761">WTL::CMDICommandBarCtrlImpl::~CMDICommandBarCtrlImpl</a></div><div class="ttdeci">~CMDICommandBarCtrlImpl()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3317</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a8557ebe2fed358eb10781a53fb0dd49c"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a8557ebe2fed358eb10781a53fb0dd49c">WTL::CMDICommandBarCtrlImpl::_CalcBtnRects</a></div><div class="ttdeci">void _CalcBtnRects(int cxWidth, int cyHeight, RECT arrRect[3], bool bInvertX=false) const</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4037</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a87c26e87946df82fa4e4bf5b22d5c1e1"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a87c26e87946df82fa4e4bf5b22d5c1e1">WTL::CMDICommandBarCtrlImpl::UpdateRebarBandIdealSize</a></div><div class="ttdeci">void UpdateRebarBandIdealSize()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3832</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a87f633c6b34c29035a3ef59659f3b42a"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a87f633c6b34c29035a3ef59659f3b42a">WTL::CMDICommandBarCtrlImpl::OnNcHitTest</a></div><div class="ttdeci">LRESULT OnNcHitTest(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3550</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_a90cdaa835e87214b491a2e7c67170f33"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#a90cdaa835e87214b491a2e7c67170f33">WTL::CMDICommandBarCtrlImpl::OnLButtonUp</a></div><div class="ttdeci">LRESULT OnLButtonUp(UINT, WPARAM, LPARAM lParam, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3682</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_aa8c1860a2fe17b684c6de017df2ac8b1"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#aa8c1860a2fe17b684c6de017df2ac8b1">WTL::CMDICommandBarCtrlImpl::CMDICommandBarCtrlImpl</a></div><div class="ttdeci">CMDICommandBarCtrlImpl()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3304</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ab0e78e7d3d7a13d43e5ccc88e2fd8b2c"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab0e78e7d3d7a13d43e5ccc88e2fd8b2c">WTL::CMDICommandBarCtrlImpl::m_cxyOffset</a></div><div class="ttdeci">int m_cxyOffset</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3279</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ab1be99ad2174db6c4cf99fcc70a30059"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab1be99ad2174db6c4cf99fcc70a30059">WTL::CMDICommandBarCtrlImpl::_OpenThemeData</a></div><div class="ttdeci">void _OpenThemeData()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:4110</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ab48feaf3420094f1462d88ac35acde72"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab48feaf3420094f1462d88ac35acde72">WTL::CMDICommandBarCtrlImpl::OnMDISetMenu</a></div><div class="ttdeci">LRESULT OnMDISetMenu(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3804</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ab80c7d3ea4c2eea370cf0d4bd32cb96f"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ab80c7d3ea4c2eea370cf0d4bd32cb96f">WTL::CMDICommandBarCtrlImpl::m_hThemeDLL</a></div><div class="ttdeci">HMODULE m_hThemeDLL</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3297</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_abcb48c2b847714802ed707eddc1457eb"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#abcb48c2b847714802ed707eddc1457eb">WTL::CMDICommandBarCtrlImpl::_baseClass</a></div><div class="ttdeci">CCommandBarCtrlImpl&lt; T, TBase, TWinTraits &gt; _baseClass</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3349</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ac7a58b3eba4c10fd39f0e956170d5b4c"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ac7a58b3eba4c10fd39f0e956170d5b4c">WTL::CMDICommandBarCtrlImpl::m_nBtnPressed</a></div><div class="ttdeci">int m_nBtnPressed</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3276</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_acb4fd1ffdc55387f7ad379da1cfc46e9"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#acb4fd1ffdc55387f7ad379da1cfc46e9">WTL::CMDICommandBarCtrlImpl::m_cxBtnWidth</a></div><div class="ttdeci">int m_cxBtnWidth</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3282</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ad671ad82988ee3200c0ae6f57cd54257"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ad671ad82988ee3200c0ae6f57cd54257">WTL::CMDICommandBarCtrlImpl::OnParentActivate</a></div><div class="ttdeci">LRESULT OnParentActivate(UINT, WPARAM wParam, LPARAM, BOOL &amp;bHandled)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3795</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ad733ff7d91a627290d2448a198f8fa21"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ad733ff7d91a627290d2448a198f8fa21">WTL::CMDICommandBarCtrlImpl::m_bChildMaximized</a></div><div class="ttdeci">bool m_bChildMaximized</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3273</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_ae1252bd3befe525991603b8b24a88dde"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#ae1252bd3befe525991603b8b24a88dde">WTL::CMDICommandBarCtrlImpl::GetSystemSettings</a></div><div class="ttdeci">void GetSystemSettings()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3963</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_af6b7ed3d93129f7ce0f9a638ece0e760"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#af6b7ed3d93129f7ce0f9a638ece0e760">WTL::CMDICommandBarCtrlImpl::OnThemeChanged</a></div><div class="ttdeci">LRESULT OnThemeChanged(UINT, WPARAM, LPARAM, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3427</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl_html_af8c8ebae372e6f091de79ae666e2f864"><div class="ttname"><a href="class_w_t_l_1_1_c_m_d_i_command_bar_ctrl_impl.html#af8c8ebae372e6f091de79ae666e2f864">WTL::CMDICommandBarCtrlImpl::OnSize</a></div><div class="ttdeci">LRESULT OnSize(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL &amp;)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:3439</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_item_info_html"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_item_info.html">WTL::CMenuItemInfo</a></div><div class="ttdef"><b>Definition:</b> atluser.h:130</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html">WTL::CMenuT&lt; false &gt;</a></div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_a301f5ecaa30d4fae79808b97772fa56f"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#a301f5ecaa30d4fae79808b97772fa56f">WTL::CMenuT::GetMenuDefaultItem</a></div><div class="ttdeci">UINT GetMenuDefaultItem(BOOL bByPosition=FALSE, UINT uFlags=0U) const</div><div class="ttdef"><b>Definition:</b> atluser.h:567</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_a5b0dbba42d4213b6535766a4b1fb83c1"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#a5b0dbba42d4213b6535766a4b1fb83c1">WTL::CMenuT::GetMenuItemID</a></div><div class="ttdeci">UINT GetMenuItemID(int nPos) const</div><div class="ttdef"><b>Definition:</b> atluser.h:365</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_a78f2a3d405df72ac3e75a1fba6ba1ab2"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#a78f2a3d405df72ac3e75a1fba6ba1ab2">WTL::CMenuT::TrackPopupMenuEx</a></div><div class="ttdeci">BOOL TrackPopupMenuEx(UINT uFlags, int x, int y, HWND hWnd, LPTPMPARAMS lptpm=NULL)</div><div class="ttdef"><b>Definition:</b> atluser.h:263</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_a8a063895f9f2bc4626874083663f576b"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#a8a063895f9f2bc4626874083663f576b">WTL::CMenuT::ModifyMenu</a></div><div class="ttdeci">BOOL ModifyMenu(UINT nPosition, UINT nFlags, UINT_PTR nIDNewItem=0, LPCTSTR lpszNewItem=NULL)</div><div class="ttdef"><b>Definition:</b> atluser.h:501</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_a8dfb6f30aeeb3658edd247f23ba9d0d2"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#a8dfb6f30aeeb3658edd247f23ba9d0d2">WTL::CMenuT::SetMenuItemInfo</a></div><div class="ttdeci">BOOL SetMenuItemInfo(UINT uItem, BOOL bByPosition, LPMENUITEMINFO lpmii)</div><div class="ttdef"><b>Definition:</b> atluser.h:554</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_ace9f3d87c46a807eebc59d84d1112c2e"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#ace9f3d87c46a807eebc59d84d1112c2e">WTL::CMenuT::GetMenuItemInfo</a></div><div class="ttdeci">BOOL GetMenuItemInfo(UINT uItem, BOOL bByPosition, LPMENUITEMINFO lpmii) const</div><div class="ttdef"><b>Definition:</b> atluser.h:548</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_ad39994137b1b3da8451f9b24b27a4d05"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#ad39994137b1b3da8451f9b24b27a4d05">WTL::CMenuT::TrackPopupMenu</a></div><div class="ttdeci">BOOL TrackPopupMenu(UINT nFlags, int x, int y, HWND hWnd, LPCRECT lpRect=NULL)</div><div class="ttdef"><b>Definition:</b> atluser.h:249</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_af66b7b895159a7c38d5b4d009f00f419"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#af66b7b895159a7c38d5b4d009f00f419">WTL::CMenuT::GetMenuItemCount</a></div><div class="ttdeci">int GetMenuItemCount() const</div><div class="ttdef"><b>Definition:</b> atluser.h:359</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_menu_t_html_afd3dd5f72cf90cc16b3aebc01e53bcf3"><div class="ttname"><a href="class_w_t_l_1_1_c_menu_t.html#afd3dd5f72cf90cc16b3aebc01e53bcf3">WTL::CMenuT::m_hMenu</a></div><div class="ttdeci">HMENU m_hMenu</div><div class="ttdef"><b>Definition:</b> atluser.h:159</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_simple_stack_html"><div class="ttname"><a href="class_w_t_l_1_1_c_simple_stack.html">WTL::CSimpleStack</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:96</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_simple_stack_html_a2002b48cc2d95cb5617ba79a369b275f"><div class="ttname"><a href="class_w_t_l_1_1_c_simple_stack.html#a2002b48cc2d95cb5617ba79a369b275f">WTL::CSimpleStack::GetCurrent</a></div><div class="ttdeci">T GetCurrent()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:120</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_simple_stack_html_a50269203f686ecb28298ff8f98708e40"><div class="ttname"><a href="class_w_t_l_1_1_c_simple_stack.html#a50269203f686ecb28298ff8f98708e40">WTL::CSimpleStack::Pop</a></div><div class="ttdeci">T Pop()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:106</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_simple_stack_html_a935103b38e86a40245a4dc40bd225e4a"><div class="ttname"><a href="class_w_t_l_1_1_c_simple_stack.html#a935103b38e86a40245a4dc40bd225e4a">WTL::CSimpleStack::Push</a></div><div class="ttdeci">BOOL Push(T t)</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:98</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_static_data_init_critical_section_lock_html"><div class="ttname"><a href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html">WTL::CStaticDataInitCriticalSectionLock</a></div><div class="ttdef"><b>Definition:</b> atlapp.h:1233</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_static_data_init_critical_section_lock_html_a6d2b1346740fd205af778b70c75a282d"><div class="ttname"><a href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">WTL::CStaticDataInitCriticalSectionLock::Lock</a></div><div class="ttdeci">HRESULT Lock()</div><div class="ttdef"><b>Definition:</b> atlapp.h:1242</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_static_data_init_critical_section_lock_html_a91b88a5d5517cb042431c4ea24d8ecb7"><div class="ttname"><a href="class_w_t_l_1_1_c_static_data_init_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">WTL::CStaticDataInitCriticalSectionLock::Unlock</a></div><div class="ttdeci">void Unlock()</div><div class="ttdef"><b>Definition:</b> atlapp.h:1252</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_tool_bar_ctrl_t_html"><div class="ttname"><a href="class_w_t_l_1_1_c_tool_bar_ctrl_t.html">WTL::CToolBarCtrlT&lt; ATL::CWindow &gt;</a></div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_window_create_critical_section_lock_html"><div class="ttname"><a href="class_w_t_l_1_1_c_window_create_critical_section_lock.html">WTL::CWindowCreateCriticalSectionLock</a></div><div class="ttdef"><b>Definition:</b> atlapp.h:1264</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_window_create_critical_section_lock_html_a6d2b1346740fd205af778b70c75a282d"><div class="ttname"><a href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a6d2b1346740fd205af778b70c75a282d">WTL::CWindowCreateCriticalSectionLock::Lock</a></div><div class="ttdeci">HRESULT Lock()</div><div class="ttdef"><b>Definition:</b> atlapp.h:1273</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_window_create_critical_section_lock_html_a91b88a5d5517cb042431c4ea24d8ecb7"><div class="ttname"><a href="class_w_t_l_1_1_c_window_create_critical_section_lock.html#a91b88a5d5517cb042431c4ea24d8ecb7">WTL::CWindowCreateCriticalSectionLock::Unlock</a></div><div class="ttdeci">void Unlock()</div><div class="ttdef"><b>Definition:</b> atlapp.h:1283</div></div>
<div class="ttc" id="aclass_w_t_l_1_1_c_window_d_c_html"><div class="ttname"><a href="class_w_t_l_1_1_c_window_d_c.html">WTL::CWindowDC</a></div><div class="ttdef"><b>Definition:</b> atlgdi.h:3410</div></div>
<div class="ttc" id="anamespace_w_t_l_1_1_module_helper_html_a469b30fb7c668ec0e547d21f8c134175"><div class="ttname"><a href="namespace_w_t_l_1_1_module_helper.html#a469b30fb7c668ec0e547d21f8c134175">WTL::ModuleHelper::GetResourceInstance</a></div><div class="ttdeci">HINSTANCE GetResourceInstance()</div><div class="ttdef"><b>Definition:</b> atlapp.h:752</div></div>
<div class="ttc" id="anamespace_w_t_l_1_1_module_helper_html_ad444c040fe6a3be1592135f52989627f"><div class="ttname"><a href="namespace_w_t_l_1_1_module_helper.html#ad444c040fe6a3be1592135f52989627f">WTL::ModuleHelper::GetModuleInstance</a></div><div class="ttdeci">HINSTANCE GetModuleInstance()</div><div class="ttdef"><b>Definition:</b> atlapp.h:743</div></div>
<div class="ttc" id="anamespace_w_t_l_1_1_run_time_helper_html_a701445cfffddec20eacec6b89601a504"><div class="ttname"><a href="namespace_w_t_l_1_1_run_time_helper.html#a701445cfffddec20eacec6b89601a504">WTL::RunTimeHelper::IsCommCtrl6</a></div><div class="ttdeci">bool IsCommCtrl6()</div><div class="ttdef"><b>Definition:</b> atlapp.h:603</div></div>
<div class="ttc" id="anamespace_w_t_l_1_1_run_time_helper_html_a9f06e5b838fb4cb07a8dabcca8c40562"><div class="ttname"><a href="namespace_w_t_l_1_1_run_time_helper.html#a9f06e5b838fb4cb07a8dabcca8c40562">WTL::RunTimeHelper::SizeOf_NONCLIENTMETRICS</a></div><div class="ttdeci">int SizeOf_NONCLIENTMETRICS()</div><div class="ttdef"><b>Definition:</b> atlapp.h:725</div></div>
<div class="ttc" id="anamespace_w_t_l_1_1_run_time_helper_html_ac0771dda0062021256c9946530324d97"><div class="ttname"><a href="namespace_w_t_l_1_1_run_time_helper.html#ac0771dda0062021256c9946530324d97">WTL::RunTimeHelper::SizeOf_REBARBANDINFO</a></div><div class="ttdeci">int SizeOf_REBARBANDINFO()</div><div class="ttdef"><b>Definition:</b> atlapp.h:682</div></div>
<div class="ttc" id="anamespace_w_t_l_1_1_run_time_helper_html_ae29ab45e10320b9e47c1deba2db8ee0b"><div class="ttname"><a href="namespace_w_t_l_1_1_run_time_helper.html#ae29ab45e10320b9e47c1deba2db8ee0b">WTL::RunTimeHelper::IsVista</a></div><div class="ttdeci">bool IsVista()</div><div class="ttdef"><b>Definition:</b> atlapp.h:610</div></div>
<div class="ttc" id="anamespace_w_t_l_1_1_secure_helper_html_a9e13a3c9cadbdec33c78c1f95d8ec053"><div class="ttname"><a href="namespace_w_t_l_1_1_secure_helper.html#a9e13a3c9cadbdec33c78c1f95d8ec053">WTL::SecureHelper::strcpy_x</a></div><div class="ttdeci">void strcpy_x(LPTSTR lpstrDest, size_t cchDest, LPCTSTR lpstrSrc)</div><div class="ttdef"><b>Definition:</b> atlapp.h:810</div></div>
<div class="ttc" id="anamespace_w_t_l_html"><div class="ttname"><a href="namespace_w_t_l.html">WTL</a></div><div class="ttdef"><b>Definition:</b> atlapp.h:485</div></div>
<div class="ttc" id="anamespace_w_t_l_html_a55d933cd4a55044d035a52be08f739fc"><div class="ttname"><a href="namespace_w_t_l.html#a55d933cd4a55044d035a52be08f739fc">WTL::CBRPOPUPMENU</a></div><div class="ttdeci">struct WTL::tagCBRPOPUPMENU CBRPOPUPMENU</div></div>
<div class="ttc" id="anamespace_w_t_l_html_a5c922e257555a46ec3da17c7951e7c05"><div class="ttname"><a href="namespace_w_t_l.html#a5c922e257555a46ec3da17c7951e7c05">WTL::AtlIsAlphaBitmapResource</a></div><div class="ttdeci">bool AtlIsAlphaBitmapResource(ATL::_U_STRINGorID image)</div><div class="ttdef"><b>Definition:</b> atlgdi.h:111</div></div>
<div class="ttc" id="anamespace_w_t_l_html_a79f79d97f4194c7b8ea7337d5dfa4844"><div class="ttname"><a href="namespace_w_t_l.html#a79f79d97f4194c7b8ea7337d5dfa4844">WTL::AtlInitCommonControls</a></div><div class="ttdeci">BOOL AtlInitCommonControls(DWORD dwFlags)</div><div class="ttdef"><b>Definition:</b> atlapp.h:555</div></div>
<div class="ttc" id="anamespace_w_t_l_html_a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a"><div class="ttname"><a href="namespace_w_t_l.html#a7fbf1dca96abf6df069cdd5544920d43a78c22c0b2be61f12997df69f2d2fe00a">WTL::atlTraceUI</a></div><div class="ttdeci">@ atlTraceUI</div><div class="ttdef"><b>Definition:</b> atlapp.h:495</div></div>
<div class="ttc" id="anamespace_w_t_l_html_a826b6edc328de072f358d7651558bd83"><div class="ttname"><a href="namespace_w_t_l.html#a826b6edc328de072f358d7651558bd83">WTL::LPCBRPOPUPMENU</a></div><div class="ttdeci">struct WTL::tagCBRPOPUPMENU * LPCBRPOPUPMENU</div></div>
<div class="ttc" id="anamespace_w_t_l_html_a8d350f94ec08be30642b085bb5f55785"><div class="ttname"><a href="namespace_w_t_l.html#a8d350f94ec08be30642b085bb5f55785">WTL::AtlIsOldWindows</a></div><div class="ttdeci">bool AtlIsOldWindows()</div><div class="ttdef"><b>Definition:</b> atlapp.h:500</div></div>
<div class="ttc" id="anamespace_w_t_l_html_a9d9270441c3af66228d8a31df299c746"><div class="ttname"><a href="namespace_w_t_l.html#a9d9270441c3af66228d8a31df299c746">WTL::CDC</a></div><div class="ttdeci">CDCT&lt; true &gt; CDC</div><div class="ttdef"><b>Definition:</b> atlgdi.h:3358</div></div>
<div class="ttc" id="anamespace_w_t_l_html_aad91d7e7c16340eda106860c4c6e9cac"><div class="ttname"><a href="namespace_w_t_l.html#aad91d7e7c16340eda106860c4c6e9cac">WTL::__declspec</a></div><div class="ttdeci">__declspec(selectany) struct</div><div class="ttdef"><b>Definition:</b> atlctrlx.h:722</div></div>
<div class="ttc" id="anamespace_w_t_l_html_adb4da30642a00b14bd247de2a13b56d3"><div class="ttname"><a href="namespace_w_t_l.html#adb4da30642a00b14bd247de2a13b56d3">WTL::CMenuHandle</a></div><div class="ttdeci">CMenuT&lt; false &gt; CMenuHandle</div><div class="ttdef"><b>Definition:</b> atluser.h:149</div></div>
<div class="ttc" id="anamespacechecksum_html_a61569f2965b7a369eb10b6d75d410d11"><div class="ttname"><a href="namespacechecksum.html#a61569f2965b7a369eb10b6d75d410d11">checksum.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> checksum.py:134</div></div>
<div class="ttc" id="anamespacecolor_html"><div class="ttname"><a href="namespacecolor.html">color</a></div><div class="ttdef"><b>Definition:</b> color.py:1</div></div>
<div class="ttc" id="anamespaceimage_html"><div class="ttname"><a href="namespaceimage.html">image</a></div><div class="ttdef"><b>Definition:</b> image.py:1</div></div>
<div class="ttc" id="anamespacepyboost_1_1constants_html_a070dc5ed54c8bb6f599e426fe8657f0a"><div class="ttname"><a href="namespacepyboost_1_1constants.html#a070dc5ed54c8bb6f599e426fe8657f0a">pyboost.constants.HANDLE</a></div><div class="ttdeci">int HANDLE</div><div class="ttdef"><b>Definition:</b> constants.py:5</div></div>
<div class="ttc" id="anamespacescreen_html_a2fb1c5cf58867b5bbc9a1b145a86f3a0"><div class="ttname"><a href="namespacescreen.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">screen.y</a></div><div class="ttdeci">y</div><div class="ttdef"><b>Definition:</b> screen.py:22</div></div>
<div class="ttc" id="anamespacescreen_html_a9336ebf25087d91c818ee6e9ec29f8c1"><div class="ttname"><a href="namespacescreen.html#a9336ebf25087d91c818ee6e9ec29f8c1">screen.x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> screen.py:22</div></div>
<div class="ttc" id="anxtcolor_8c_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="nxtcolor_8c.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> nxtcolor.c:21</div></div>
<div class="ttc" id="anxtcolor_8c_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="nxtcolor_8c.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> nxtcolor.c:22</div></div>
<div class="ttc" id="arplidar__protocol_8h_html_ab665c54c3bf2394c2925757ac11338c5"><div class="ttname"><a href="rplidar__protocol_8h.html#ab665c54c3bf2394c2925757ac11338c5">size</a></div><div class="ttdeci">_u8 size</div><div class="ttdef"><b>Definition:</b> rplidar_protocol.h:2</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data_html"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html">WTL::CCommandBarCtrlBase::_MsgHookData</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:137</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data_html_aa7eabb53555d83572b0163dd358ea7d4"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#aa7eabb53555d83572b0163dd358ea7d4">WTL::CCommandBarCtrlBase::_MsgHookData::_MsgHookData</a></div><div class="ttdeci">_MsgHookData()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:141</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data_html_af534105edc5d607a405efc889dfa3ba8"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#af534105edc5d607a405efc889dfa3ba8">WTL::CCommandBarCtrlBase::_MsgHookData::hMsgHook</a></div><div class="ttdeci">HHOOK hMsgHook</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:138</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data_html_afdaa7687034998769c738c6da1cbc212"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_base_1_1___msg_hook_data.html#afdaa7687034998769c738c6da1cbc212">WTL::CCommandBarCtrlBase::_MsgHookData::dwUsage</a></div><div class="ttdeci">DWORD dwUsage</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:139</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html">WTL::CCommandBarCtrlImpl::_MenuItemData</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:208</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html_a067bd58dd35ee07dea81d0b4a4e144ca"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a067bd58dd35ee07dea81d0b4a4e144ca">WTL::CCommandBarCtrlImpl::_MenuItemData::fState</a></div><div class="ttdeci">UINT fState</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:212</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html_a2d0d0c282af263c2c57f82b5b163abc5"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a2d0d0c282af263c2c57f82b5b163abc5">WTL::CCommandBarCtrlImpl::_MenuItemData::IsCmdBarMenuItem</a></div><div class="ttdeci">bool IsCmdBarMenuItem()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:216</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html_a3ac7f9906d7e0effb5a4e99e78af70b8"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3ac7f9906d7e0effb5a4e99e78af70b8">WTL::CCommandBarCtrlImpl::_MenuItemData::lpstrText</a></div><div class="ttdeci">LPTSTR lpstrText</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:210</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html_a3f9ea4a7b91779e27ebb2a33a1484545"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a3f9ea4a7b91779e27ebb2a33a1484545">WTL::CCommandBarCtrlImpl::_MenuItemData::fType</a></div><div class="ttdeci">UINT fType</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:211</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html_a404947e533a0851957a74ca22666743f"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a404947e533a0851957a74ca22666743f">WTL::CCommandBarCtrlImpl::_MenuItemData::dwMagic</a></div><div class="ttdeci">DWORD dwMagic</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:209</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html_a922b217ecfd89fcd2a8bb43dfdc01d29"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#a922b217ecfd89fcd2a8bb43dfdc01d29">WTL::CCommandBarCtrlImpl::_MenuItemData::_MenuItemData</a></div><div class="ttdeci">_MenuItemData()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:215</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data_html_af89e777f3ec45bfe9b8dfadb60f5ca23"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___menu_item_data.html#af89e777f3ec45bfe9b8dfadb60f5ca23">WTL::CCommandBarCtrlImpl::_MenuItemData::iButton</a></div><div class="ttdeci">int iButton</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:213</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data_html"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html">WTL::CCommandBarCtrlImpl::_ToolBarData</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:220</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data_html_a943e513cc2107b5bd86de1dee77c4f1e"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a943e513cc2107b5bd86de1dee77c4f1e">WTL::CCommandBarCtrlImpl::_ToolBarData::wVersion</a></div><div class="ttdeci">WORD wVersion</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:221</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data_html_a97b4a909b19acb8104f14f8eaca3b9f6"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#a97b4a909b19acb8104f14f8eaca3b9f6">WTL::CCommandBarCtrlImpl::_ToolBarData::wWidth</a></div><div class="ttdeci">WORD wWidth</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:222</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data_html_ad950f08a0bae48d22e1cd1d20539dbdd"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ad950f08a0bae48d22e1cd1d20539dbdd">WTL::CCommandBarCtrlImpl::_ToolBarData::wHeight</a></div><div class="ttdeci">WORD wHeight</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:223</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data_html_ae3e443d24b087e2e3e73e7185ccf3fea"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#ae3e443d24b087e2e3e73e7185ccf3fea">WTL::CCommandBarCtrlImpl::_ToolBarData::items</a></div><div class="ttdeci">WORD * items()</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:227</div></div>
<div class="ttc" id="astruct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data_html_aea66e70a282226dc49c492c81fec2941"><div class="ttname"><a href="struct_w_t_l_1_1_c_command_bar_ctrl_impl_1_1___tool_bar_data.html#aea66e70a282226dc49c492c81fec2941">WTL::CCommandBarCtrlImpl::_ToolBarData::wItemCount</a></div><div class="ttdeci">WORD wItemCount</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:224</div></div>
<div class="ttc" id="astruct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u_html"><div class="ttname"><a href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html">WTL::tagCBRPOPUPMENU</a></div><div class="ttdef"><b>Definition:</b> atlctrlw.h:84</div></div>
<div class="ttc" id="astruct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u_html_a0a2f84ed7838f07779ae24c5a9086d33"><div class="ttname"><a href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a0a2f84ed7838f07779ae24c5a9086d33">WTL::tagCBRPOPUPMENU::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:89</div></div>
<div class="ttc" id="astruct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u_html_a309bf8d531939eba86ac4913eb0863d5"><div class="ttname"><a href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a309bf8d531939eba86ac4913eb0863d5">WTL::tagCBRPOPUPMENU::hMenu</a></div><div class="ttdeci">HMENU hMenu</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:86</div></div>
<div class="ttc" id="astruct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u_html_a6150e0515f7202e2fb518f7206ed97dc"><div class="ttname"><a href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a6150e0515f7202e2fb518f7206ed97dc">WTL::tagCBRPOPUPMENU::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:88</div></div>
<div class="ttc" id="astruct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u_html_a8890d0b8feaf1a70277a101527554974"><div class="ttname"><a href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#a8890d0b8feaf1a70277a101527554974">WTL::tagCBRPOPUPMENU::uFlags</a></div><div class="ttdeci">UINT uFlags</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:87</div></div>
<div class="ttc" id="astruct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u_html_aca985e741a1f45d7adae9557cfb839bf"><div class="ttname"><a href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#aca985e741a1f45d7adae9557cfb839bf">WTL::tagCBRPOPUPMENU::cbSize</a></div><div class="ttdeci">int cbSize</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:85</div></div>
<div class="ttc" id="astruct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u_html_adb9dba29c4be89f78a9be54f7f0d1185"><div class="ttname"><a href="struct_w_t_l_1_1tag_c_b_r_p_o_p_u_p_m_e_n_u.html#adb9dba29c4be89f78a9be54f7f0d1185">WTL::tagCBRPOPUPMENU::lptpm</a></div><div class="ttdeci">LPTPMPARAMS lptpm</div><div class="ttdef"><b>Definition:</b> atlctrlw.h:90</div></div>
<div class="ttc" id="astructpt_html"><div class="ttname"><a href="structpt.html">pt</a></div><div class="ttdef"><b>Definition:</b> pt.h:54</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
